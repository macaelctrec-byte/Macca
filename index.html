<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…ÙƒØ© Ù„Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ© Ø¨Ø§Ù„Ù…Ù‚Ø·Ù… | Macca Electric Tools</title>
    <meta name="description" content="Ù…ÙƒØ© Ù„Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ© Ø¨Ø§Ù„Ù…Ù‚Ø·Ù… â€“ ÙƒÙ„ Ù…Ø§ ØªØ­ØªØ§Ø¬Ù‡ Ù…Ù† Ù„Ù…Ø¨Ø§ØªØŒ ÙƒØ§Ø¨Ù„Ø§ØªØŒ Ù…ÙØ§ØªÙŠØ­ØŒ Ø¯Ù‡Ø§Ù†Ø§ØªØŒ ÙˆØ£Ø¯ÙˆØ§Øª ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ© Ù…Ù†Ø²Ù„ÙŠØ©. Ø´Ø­Ù† Ø³Ø±ÙŠØ¹ ÙˆØ®Ø¯Ù…Ø© ØªØ±ÙƒÙŠØ¨ Ø§Ø­ØªØ±Ø§ÙÙŠØ©.">
    <meta name="keywords" content="Ù…ÙƒØ© Ù„Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©, Ø£Ø¯ÙˆØ§Øª ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ© Ø§Ù„Ù…Ù‚Ø·Ù…, Ù…Ø­Ù„Ø§Øª ÙƒÙ‡Ø±Ø¨Ø§Ø¡ Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©, Ù…ØªØ¬Ø± ÙƒÙ‡Ø±Ø¨Ø§Ø¡ Ù…ÙƒØ©, ÙƒØ§Ø¨Ù„Ø§Øª ÙˆØ£Ø³Ù„Ø§Ùƒ, Ù…ÙØ§ØªÙŠØ­ ÙˆØ¨Ø±Ø§ÙŠØ², Ù„Ù…Ø¨Ø§Øª, Ø¯Ù‡Ø§Ù†Ø§Øª, Ù…Ø³ØªÙ„Ø²Ù…Ø§Øª ÙƒÙ‡Ø±Ø¨Ø§Ø¡, ØªÙˆØ±ÙŠØ¯ ÙˆØªØ±ÙƒÙŠØ¨ ÙƒÙ‡Ø±Ø¨Ø§Ø¡">
    <meta name="author" content="Ù…ÙƒØ© Ù„Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©">
    <meta name="theme-color" content="#ffcd00">
    <meta property="og:title" content="Ù…ØªØ¬Ø± Ù…ÙƒØ© | Ù„Ù„Ø¥Ø¶Ø§Ø¡Ø© Ø§Ù„Ø­Ø¯ÙŠØ«Ø© ÙˆØ§Ù„Ø¯Ù‡Ø§Ù†Ø§Øª">
    <meta property="og:description" content="Ø§ÙƒØªØ´Ù ØªØ´ÙƒÙŠÙ„ØªÙ†Ø§ Ø§Ù„ÙˆØ§×¡Ø¹Ø© Ù…Ù† Ø§Ù„Ø¥Ø¶Ø§Ø¡Ø© Ø§Ù„Ø­Ø¯ÙŠØ«Ø©ØŒ Ø§Ù„Ø¯Ù‡Ø§Ù†Ø§ØªØŒ ÙˆØ§Ù„ÙƒØ§Ø¨Ù„Ø§Øª. Ø®Ø¨Ø±Ø© 20 Ø¹Ø§Ù…Ù‹Ø§ ÙÙŠ Ø§Ù„Ù…Ù‚Ø·Ù….">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://macca3.shop/"> 
    <meta property="og:image" content="https://i.postimg.cc/NfqhM3Th/photo-2025-10-28-14-04-33.jpg"> 
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Ù…ØªØ¬Ø± Ù…ÙƒØ© | Ù„Ù„Ø¥Ø¶Ø§Ø¡Ø© Ø§Ù„Ø­Ø¯ÙŠØ«Ø© ÙˆØ§Ù„Ø¯Ù‡Ø§Ù†Ø§Øª">
    <meta name="twitter:description" content="Ø®Ø¨Ø±Ø© 20 Ø¹Ø§Ù…Ù‹Ø§ ÙÙŠ Ø§Ù„Ø¥Ø¶Ø§Ø¡Ø© Ø§Ù„Ø­Ø¯ÙŠØ«Ø© ÙˆØ§Ù„Ø¯Ù‡Ø§Ù†Ø§Øª Ø¨Ø§Ù„Ù…Ù‚Ø·Ù….">
    <meta name="twitter:image" content="https://i.postimg.cc/NfqhM3Th/photo-2025-10-28-14-04-33.jpg">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23ffcd00' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><path d='M13 3L7 12h4l-1 8 7-12h-4z'/></svg>" type="image/svg+xml">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23ffcd00' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><path d='M13 3L7 12h4l-1 8 7-12h-4z'/></svg>">
    <script>
        if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        } else {
            document.documentElement.classList.remove('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
            if (e.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });
    </script>
    <!-- Defer loading of non-critical scripts -->
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js" defer></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- Load fonts non-blockingly and use display=block to prevent CLS -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;500;600;700&display=block" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;500;600;700&display=block"></noscript>
    <style>
        body {
            font-family: 'Cairo', sans-serif; 
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        /* Removed the misplaced 'zoom: 0.9;' rule and extra brace */

        .dark body {
            background-image: linear-gradient(to bottom, #2f2921, #19171b);
            background-attachment: fixed; 
        }
        .dark .dark\:bg-\[\#192230\] {
            background-color: transparent !important;
        }
        .dark .dark\:bg-\[\#2c2f38\] {
            background-color: #2f2921 !important; 
        }

        .dark .dark\:bg-\[\#2c2f38\]\/90 {
            background-color: rgba(47, 41, 33, 0.9) !important; 
        }
        .dark .dark\:bg-\[\#3d474e\] {
            background-color: #374151 !important; 
        }
        .dark .dark\:bg-\[\#2d2d2d\] {
            background-color: #2d2d2d !important; 
        }
        /* --- NEW MODERN SALE BADGE --- */
        .sale-badge {
            position: absolute;
            top: 10px;
            left: 10px; /* ØªÙ… Ø§Ù„Ù†Ù‚Ù„ Ù„Ù„ÙŠØ³Ø§Ø± Ù„ØªØ¬Ù†Ø¨ Ø§Ù„ØªØ¯Ø§Ø®Ù„ Ù…Ø¹ Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø£Ø¯Ù…Ù† */
            right: auto;
            z-index: 20;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 6px 12px;
            background: linear-gradient(135deg, #ef4444, #b91c1c);
            color: white;
            font-size: 0.75rem;
            font-weight: 800;
            border-radius: 99px; /* Ø´ÙƒÙ„ ÙƒØ¨Ø³ÙˆÙ„Ø© */
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(4px);
            transform: translateZ(0);
        }
        /* --- REMOVED OLD SALE RIBBON STYLES --- */

        /* --- NEW CROWN BADGE STYLE --- */
        .special-crown-badge {
            @apply ml-2 inline-flex items-center justify-center gap-1 px-2 py-0.5 bg-gradient-to-r from-amber-100 to-yellow-100 dark:from-amber-900/30 dark:to-yellow-900/30 border border-amber-200 dark:border-amber-800 rounded-full text-xs font-bold text-amber-700 dark:text-amber-400;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }
        .special-crown-badge i {
            @apply w-3.5 h-3.5 text-amber-500 fill-current;
            filter: drop-shadow(0 1px 1px rgba(0,0,0,0.1));
        }
        /* ----------------------------- */

        .star-rating {
            @apply text-[#ffcd00];
        }
        .card-hover {
            @apply transition-all duration-300 ease-in-out;
        }
        .card-hover:hover {
            @apply transform -translate-y-1 scale-105 shadow-xl;
        }
        .page-section {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }
        .page-section.active {
            display: block;
        }
        
        /* --- NEW DROPDOWN STYLES --- */
        #user-dropdown-menu {
            transition: opacity 0.1s ease-out, transform 0.1s ease-out;
            transform-origin: top right; /* LTR */
        }
        [dir="rtl"] #user-dropdown-menu {
            transform-origin: top left; /* RTL */
        }
        #user-dropdown-menu[data-state="closed"] {
            opacity: 0;
            transform: translateY(10px) scale(0.95);
            pointer-events: none;
        }
        #user-dropdown-menu[data-state="open"] {
            opacity: 1;
            transform: translateY(0) scale(1);
            pointer-events: auto;
        }
        /* --- END NEW DROPDOWN STYLES --- */

        .nav-link {
            @apply relative px-3 py-2 text-sm font-medium text-gray-600 dark:text-gray-300 transition-all duration-200 rounded-lg;
        }
        
        .nav-link:hover, .nav-link.active {
            @apply text-[#ffcd00] bg-gray-100/50 dark:bg-[#ffcd00]/10;
        }

        .nav-link::after {
            display: none; /* Removing the old underline effect for a modern pill look */
        }

        .mobile-nav-link.active {
            @apply bg-[#ffcd00]/10 text-[#ffcd00];
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        :root {
            color-scheme: dark;
        }

        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            @apply bg-gray-100 dark:bg-gray-800;
        }
        ::-webkit-scrollbar-thumb {
            @apply bg-gray-300 dark:bg-gray-600 rounded-full;
        }
        ::-webkit-scrollbar-thumb:hover {
            @apply bg-gray-400 dark:bg-gray-500;
        }

        .prose {
            overflow-wrap: break-word;
            word-wrap: break-word;
        }

        .toast-notification {
            @apply fixed bottom-6 left-1/2 -translate-x-1/2 z-50 px-6 py-3 bg-gray-900 dark:bg-white text-white dark:text-gray-900 font-semibold rounded-lg shadow-lg;
            animation: fadeInOut 2s ease-in-out;
        }

        @keyframes fadeInOut {
            0%, 100% { opacity: 0; transform: translateY(20px) translateX(-50%); }
            25%, 75% { opacity: 1; transform: translateY(0) translateX(-50%); }
        }

        #chat-history {
            scroll-behavior: smooth;
        }
        .chat-message {
            @apply p-3 rounded-xl max-w-xs md:max-w-md break-words;
            animation: slideInUp 0.3s ease-out;
        }
        .user-message {
            @apply bg-gradient-to-r from-blue-500 to-blue-600 text-white self-end chat-message rounded-br-lg;
        }
        .model-message {
            @apply bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-gray-200 self-start chat-message rounded-bl-lg;
        }
        .loading-dots {
            @apply flex items-center space-x-1 p-3;
        }
        .loading-dot {
            @apply w-2 h-2 bg-gray-400 rounded-full animate-bounce;
        }
        .loading-dot:nth-child(2) {
            animation-delay: 0.1s;
        }
        .loading-dot:nth-child(3) {
            animation-delay: 0.2s;
        }
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-6px); }
        }
        @keyframes slideInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .chat-recommendation-container {
            @apply flex gap-3 overflow-x-auto p-2 -mr-2 -ml-2;
            
            -webkit-mask-image: linear-gradient(to left, white 90%, transparent 100%);
            mask-image: linear-gradient(to left, white 90%, transparent 100%);
        }

        .chat-product-card {
            @apply flex-shrink-0 w-40 bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden border border-gray-200 dark:border-gray-700 transition-transform duration-200 hover:scale-105;
        }
        .chat-product-card img {
            @apply w-full h-24 object-cover;
        }
        .chat-product-card-content {
            @apply p-2;
        }
        .chat-product-card-name {
            @apply text-sm font-semibold text-gray-800 dark:text-white truncate;
        }
        .chat-product-card-price {
            @apply text-xs text-gray-600 dark:text-gray-300;
        }
        .chat-product-card-btn {
            @apply block w-full text-center bg-[#ffcd00] text-gray-900 text-xs font-bold py-1 px-2 rounded-md mt-2 hover:bg-[#ffda33];
        }
        
        /* This container is no longer used */
        /*
        .suggestion-chip-container {
            @apply p-4 border-t border-white/20 dark:border-white/10 bg-white/50 dark:bg-transparent;
        }
        .suggestion-chip-scroll {
            @apply flex gap-2 flex-wrap justify-center;
            scrollbar-width: none; 
            -ms-overflow-style: none;  
        }
        .suggestion-chip-scroll::-webkit-scrollbar {
            display: none; 
        }
        */

        /* This new class styles the suggestions container INSIDE the chat */
        .chat-suggestions-container {
            @apply flex gap-2 flex-wrap justify-start self-start pt-2;
            animation: slideInUp 0.3s ease-out;
        }

        .suggestion-chip {
            /* Made the chips a bit smaller to fit better in the chat */
            @apply px-3 py-1.5 bg-gray-100/80 dark:bg-gray-900/50 text-gray-700 dark:text-gray-200 text-sm font-medium rounded-full cursor-pointer hover:bg-[#ffcd00] hover:text-gray-900 dark:hover:bg-[#ffcd00] dark:hover:text-gray-900 transition-all duration-200 shadow-sm border border-transparent hover:border-[#ffcd00]/50;
        }
        .ai-modal-backdrop[data-state="open"] #gemini-help-panel {
            opacity: 1; transform: translateY(0);
        }
        .ai-modal-backdrop[data-state="closed"] #gemini-help-panel {
            opacity: 0; transform: translateY(24px); /* 24px = translate-y-6 */
        }
        .ai-modal-backdrop[data-state="open"] {
            opacity: 1;
        }
        .ai-modal-backdrop[data-state="closed"] {
            opacity: 0;
        }
        .suggestion-card {
            @apply bg-white dark:bg-[#2c2f38] rounded-xl overflow-hidden shadow-md border border-[#ffcd00]/30 dark:border-[#ffcd00]/50 transition-all duration-300 hover:shadow-xl hover:-translate-y-1 hover:border-[#ffcd00]/80;
        }
        .suggestion-card img {
            @apply w-full h-32 object-cover;
        }
        .suggestion-card-content {
            @apply p-3;
        }
        .suggestion-card-name {
            @apply text-sm font-semibold text-gray-800 dark:text-white truncate mb-1;
        }
        .suggestion-card-price {
            @apply text-sm text-gray-700 dark:text-gray-200;
        }
        .suggestion-card-btn {
            @apply block w-full text-center bg-transparent border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 text-xs font-semibold py-2 px-3 rounded-md mt-3 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors;
        }
        .dark .whatsapp-fab {
            background-color: rgba(255, 255, 255, 0.1) !important; 
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
            color: #ffcd00 !important; 
        }

        .dark .whatsapp-fab:hover {
            background-color: rgba(255, 255, 255, 0.2) !important;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.5);
            color: #ffda33 !important;
        }

        /* --- NEW STYLES FOR COMPACT SUGGESTIONS --- */
        #ai-suggestions-grid .product-card-wrapper {
            @apply shadow-md border-gray-200 dark:border-gray-700;
        }
        #ai-suggestions-grid .product-card-wrapper:hover {
            @apply shadow-lg transform-none scale-100;
        }
        #ai-suggestions-grid img.object-cover {
            @apply h-32 sm:h-40; /* Smaller image */
        }
        #ai-suggestions-grid .p-4 {
            @apply p-3; /* Slightly less padding */
        }
        #ai-suggestions-grid .product-name {
            @apply text-sm; /* Smaller title */
        }
        #ai-suggestions-grid .star-rating {
            @apply mb-1 text-xs; /* Smaller stars, less margin */
        }
        #ai-suggestions-grid .text-lg {
            @apply text-base; /* Smaller price */
        }
        #ai-suggestions-grid .text-sm {
            @apply text-xs;
        }
        #ai-suggestions-grid .flex-1 {
            @apply text-xs px-3 py-1.5; /* Smaller details button */
        }
        #ai-suggestions-grid .add-to-cart-btn {
            @apply p-1.5; /* Smaller add-to-cart button */
        }
        #ai-suggestions-grid .add-to-cart-btn i {
            @apply w-4 h-4;
        }
        #ai-suggestions-grid .sale-ribbon {
            @apply w-16 h-16;
        }
        #ai-suggestions-grid .sale-ribbon span {
            @apply w-20 text-xs top-12 right-[-28px] py-0.5;
        }
        /* --- END NEW STYLES --- */
        
        /* --- NEW TESTIMONIALS SCROLL STYLES --- */
        .testimonials-scroll-container {
            overflow: hidden;
            white-space: nowrap;
            position: relative;
        }
        .testimonials-scroll-container::before,
        .testimonials-scroll-container::after {
            content: "";
            position: absolute;
            top: 0;
            width: 100px;
            height: 100%;
            z-index: 2;
        }
        .testimonials-scroll-container::before {
            left: 0;
            background: linear-gradient(to right, var(--bg-color), transparent);
        }
        .testimonials-scroll-container::after {
            right: 0;
            background: linear-gradient(to left, var(--bg-color), transparent);
        }
        :root {
            --bg-color: #f3f4f6; /* bg-gray-100 */
        }
        .dark {
            --bg-color: #192230; /* dark:bg-[#192230] */
        }

        .testimonials-scroll-track {
            display: inline-block;
            animation: scroll-rtl 120s linear infinite; /* Increased duration for more items */
        }
        .testimonials-scroll-track:hover {
            animation-play-state: paused;
        }

        @keyframes scroll-rtl {
            0% { transform: translateX(0); }
            100% { transform: translateX(50%); } /* Move half the width (original set) */
        }
        /* --- END TESTIMONIALS SCROLL STYLES --- */
    </style>
    
</head>
<body class="bg-gray-100 dark:bg-[#192230] text-gray-800 dark:text-gray-200 selection:bg-[#ffcd00] selection:text-gray-900">

    <div id="app" class="min-h-screen flex flex-col">
        
        <header class="sticky top-0 z-50 w-full bg-white/70 dark:bg-[#252222] backdrop-blur-xl shadow-lg border-b border-white/20 dark:border-gray-700/30 transition-all duration-300 supports-[backdrop-filter]:bg-white/60 dark:supports-[backdrop-filter]:bg-[#252222]">
            <nav class="px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto">
                <div class="flex justify-between items-center h-16">
                    
                    <div class="flex items-center gap-4">
                        <a href="#home" class="logo-link flex-shrink-0 flex items-center gap-2" data-page="home">
                            <div class="p-2 bg-[#ffcd00]/10 rounded-xl">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="#ffcd00" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6"><path d="M13 3L7 12h4l-1 8 7-12h-4z"/></svg>
                            </div>
                            <div class="flex flex-col">
                                <span class="text-xl font-extrabold text-gray-900 dark:text-white leading-none tracking-tight">Ù…ØªØ¬Ø± Ù…ÙƒØ©</span>
                                <span class="text-[0.65rem] font-medium text-[#ffcd00] tracking-wider mt-0.5">Ù„Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©</span>
                            </div>
                        </a>

                        <!-- Visitor Counter Moved Here -->
                        <div class="hidden sm:flex items-center gap-1.5 text-xs font-medium text-gray-500 dark:text-gray-400 bg-gray-100 dark:bg-white/5 px-2.5 py-1 rounded-full">
                            <i data-lucide="users" class="w-3.5 h-3.5"></i>
                            <span dir="ltr" id="visitor-count-number" class="font-bold text-[#ffcd00]">...</span>
                        </div>
                    </div>
                    
                    <div class="hidden md:flex items-center gap-x-4">
                        <a href="#home" class="nav-link" data-page="home">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
                        <!-- MODIFIED: Offers Link points to dedicated page -->
                        <a href="#offers" class="nav-link font-bold text-red-600 dark:text-red-500" data-page="offers">ğŸ”¥ Ø§Ù„Ø¹Ø±ÙˆØ¶</a>
                        <a href="#products" class="nav-link" data-page="products">Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</a>
                        <a href="#blog" class="nav-link" data-page="blog">Ø§Ù„Ù…Ø¯ÙˆÙ†Ø©</a>
                        <a href="#contact" class="nav-link" data-page="contact">Ø§ØªØµÙ„ Ø¨Ù†Ø§</a>
                    </div>

                    <div class="flex items-center gap-1.5">
                        <a href="#cart" class="nav-link !px-3 relative flex items-center justify-center hover:bg-gray-100 dark:hover:bg-gray-800 !rounded-full border border-transparent hover:border-gray-200 dark:hover:border-gray-700" data-page="cart" title="Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª">
                            <i data-lucide="shopping-bag" class="w-5 h-5"></i>
                            <span id="cart-count-badge" class="absolute -top-1 -right-1 flex h-5 w-5 items-center justify-center rounded-full bg-[#ffcd00] text-[10px] font-bold text-gray-900 ring-2 ring-white dark:ring-[#2c2f38] hidden">0</span>
                        </a>
                        
                        <div class="h-6 w-px bg-gray-200 dark:bg-gray-700 mx-1 hidden sm:block"></div>

                        <button id="google-login-btn" class="hidden sm:inline-flex items-center gap-2 px-4 py-2 rounded-full bg-gray-900 dark:bg-white text-white dark:text-gray-900 text-sm font-bold hover:opacity-90 transition-opacity" title="ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„">
                             <svg class="w-4 h-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 488 512"><path fill="currentColor" d="M488 261.8C488 403.3 391.1 504 248 504 110.8 504 0 393.2 0 256S110.8 8 248 8c66.8 0 123 24.5 166.3 64.9l-67.5 64.9C258.5 52.6 94.3 116.6 94.3 256c0 86.5 69.1 156.6 153.7 156.6 98.2 0 135-70.4 140.8-106.9H248v-85.3h236.1c2.3 12.7 3.9 24.9 3.9 41.4z"/></svg>
                             <span>Ø¯Ø®ÙˆÙ„</span>
                        </button>
                        
                        <div id="user-info" class="relative items-center hidden"> 
                            <button id="user-avatar-btn" type="button" class="p-0.5 rounded-full ring-2 ring-transparent hover:ring-[#ffcd00] transition-all">
                                <img id="user-avatar" class="w-9 h-9 rounded-full object-cover" src="https://placehold.co/32x32" alt="Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø±Ù…Ø²ÙŠØ©">
                            </button>
                            <!-- Dropdown remains same structure, just ensuring it's inside the relative container -->
                            <div id="user-dropdown-menu" data-state="closed" class="absolute left-0 mt-2 w-56 bg-white dark:bg-[#192230] rounded-xl shadow-2xl py-2 ring-1 ring-black/5 dark:ring-white/5 z-50 origin-top-left focus:outline-none"
                                 role="menu" aria-orientation="vertical" aria-labelledby="user-avatar-btn">
                                <a href="#admin" id="dropdown-admin-link" data-page="admin" class="flex items-center gap-3 px-4 py-3 text-sm font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-[#2c2f38] transition-colors" role="menuitem">
                                    <i data-lucide="layout-dashboard" class="w-4 h-4"></i>
                                    Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
                                </a>
                                <div class="h-px bg-gray-100 dark:bg-gray-700/50 my-2 mx-4"></div>
                                <button id="google-logout-btn-dropdown" class="w-full flex items-center gap-3 px-4 py-3 text-sm font-medium text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/10 transition-colors text-right" role="menuitem">
                                    <i data-lucide="log-out" class="w-4 h-4"></i>
                                    ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
                                </button>
                            </div>
                        </div>

                        <div class="flex items-center md:hidden">
                            <button id="mobile-menu-button" type="button" class="inline-flex items-center justify-center p-2 rounded-lg text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors focus:outline-none" aria-controls="mobile-menu" aria-expanded="false">
                                <span class="sr-only">ÙØªØ­ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</span>
                                <i id="mobile-menu-open-icon" data-lucide="menu" class="w-6 h-6 block"></i>
                                <i id="mobile-menu-close-icon" data-lucide="x" class="w-6 h-6 hidden"></i>
                            </button>
                        </div>
                    </div>
                    
                </div>
            </nav>
            <!-- Mobile Menu with glass effect -->
            <div class="md:hidden hidden border-t border-gray-200/50 dark:border-gray-700/50" id="mobile-menu">
                <div class="px-2 pt-2 pb-3 space-y-1">
                    <a href="#home" class="mobile-nav-link flex items-center gap-3 px-4 py-3 rounded-xl text-base font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-white/5 transition-colors" data-page="home">
                        <i data-lucide="home" class="w-5 h-5 opacity-70"></i>
                        Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
                    </a>
                    <!-- MODIFIED: Mobile Offers Link points to dedicated page -->
                    <a href="#offers" class="mobile-nav-link flex items-center gap-3 px-4 py-3 rounded-xl text-base font-bold text-red-600 dark:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/10 transition-colors" data-page="offers">
                        <i data-lucide="flame" class="w-5 h-5"></i>
                        Ø§Ù„Ø¹Ø±ÙˆØ¶
                    </a>
                    <a href="#products" class="mobile-nav-link flex items-center gap-3 px-4 py-3 rounded-xl text-base font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-white/5 transition-colors" data-page="products">
                        <i data-lucide="package" class="w-5 h-5 opacity-70"></i>
                        Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
                    </a>
                    <a href="#blog" class="mobile-nav-link flex items-center gap-3 px-4 py-3 rounded-xl text-base font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-white/5 transition-colors" data-page="blog">
                        <i data-lucide="book-open" class="w-5 h-5 opacity-70"></i>
                        Ø§Ù„Ù…Ø¯ÙˆÙ†Ø©
                    </a>
                    <a href="#contact" class="mobile-nav-link flex items-center gap-3 px-4 py-3 rounded-xl text-base font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-white/5 transition-colors" data-page="contact">
                        <i data-lucide="phone" class="w-5 h-5 opacity-70"></i>
                        Ø§ØªØµÙ„ Ø¨Ù†Ø§
                    </a>
                    
                    <div class="h-px bg-gray-200 dark:bg-gray-700/50 my-2 mx-4"></div>

                    <a href="#" id="google-login-btn-mobile" class="mobile-nav-link flex items-center gap-3 px-4 py-3 rounded-xl text-base font-bold text-white bg-gray-900 dark:bg-white dark:text-gray-900 mx-2 justify-center">
                        <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 488 512"><path fill="currentColor" d="M488 261.8C488 403.3 391.1 504 248 504 110.8 504 0 393.2 0 256S110.8 8 248 8c66.8 0 123 24.5 166.3 64.9l-67.5 64.9C258.5 52.6 94.3 116.6 94.3 256c0 86.5 69.1 156.6 153.7 156.6 98.2 0 135-70.4 140.8-106.9H248v-85.3h236.1c2.3 12.7 3.9 24.9 3.9 41.4z"/></svg>
                        ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø­Ø³Ø§Ø¨ Ø¬ÙˆØ¬Ù„
                    </a>
                    <div id="user-info-mobile" class="hidden flex-col px-4 py-3 space-y-3">
                        <div class="flex items-center gap-3 p-3 bg-gray-50 dark:bg-white/5 rounded-xl">
                            <img id="user-avatar-mobile" class="w-10 h-10 rounded-full" src="https://placehold.co/32x32" alt="Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø±Ù…Ø²ÙŠØ©">
                            <div class="flex flex-col">
                                <span class="text-xs text-gray-500 dark:text-gray-400">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ</span>
                                <span id="user-name-mobile" class="text-sm font-bold text-gray-900 dark:text-white"></span>
                            </div>
                        </div>
                        <a href="#" id="google-logout-btn-mobile" class="flex items-center justify-center gap-2 w-full px-4 py-2.5 rounded-xl text-sm font-medium text-red-600 bg-red-50 dark:bg-red-900/10 dark:text-red-400 hover:bg-red-100 transition-colors">
                            <i data-lucide="log-out" class="w-4 h-4"></i>
                            ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
                        </a>
                    </div>
                </div>
            </div>
        </header>
        <div id="special-offer-banner-light" class="w-full bg-[#294e3a] sticky top-[85px] z-40 h-[100px] transition-transform duration-300 ease-in-out hidden">
                     class="w-full h-full object-cover"
                     fetchpriority="high" 
                     onerror="this.style.display='none'; this.parentElement.parentElement.classList.add('hidden');">
            </a>
        </div>
        <div id="special-offer-banner-dark" class="w-full bg-[#1a2b20] sticky top-[64px] z-40 h-[100px] transition-transform duration-300 ease-in-out hidden">
            <a href="#products" class="block h-full" title="Ø¹Ø±Ø¶ Ø®Ø§Øµ (ÙˆØ¶Ø¹ Ø¯Ø§ÙƒÙ†)">
                <img src="" 
                     alt="" 
                     class="w-full h-full object-cover"
                     fetchpriority="high"
                     onerror="this.style.display='none'; this.parentElement.parentElement.classList.add('hidden');">
            </a>
        </div>

        <main class="px-4 sm:px-6 lg:px-8 pb-8 flex-1">
            
            <!-- NEW: Top "Current Offers" Section -->
            <section id="current-offers-section" class="page-section active pt-4 pb-8 hidden">
                <div class="flex items-center gap-2 mb-4">
                    <h2 class="text-2xl sm:text-3xl font-bold text-red-600 dark:text-red-400">ğŸ”¥ Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø­Ø§Ù„ÙŠØ©</h2>
                    <div class="h-px flex-grow bg-red-200 dark:bg-red-900/30 ml-4"></div>
                </div>
                <div id="top-offers-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-3 sm:gap-4">
                    <!-- Offer cards will be injected here -->
                </div>
            </section>

            <section id="page-home" class="page-section space-y-12 pt-8">
                 <div class="relative bg-[#2c2f38] rounded-xl overflow-hidden shadow-2xl" style="min-height: 350px; sm:min-height: 400px;">
                    <!-- Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø³ÙŠØµØ¨Ø­ Ù…Ø®ÙÙŠØ§Ù‹ Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹ -->
                    <video id="hero-video" autoplay loop muted playsinline class="absolute inset-0 w-full h-full object-cover opacity-30 hidden">
                        <source id="hero-video-source" src="https://assets.mixkit.co/videos/preview/mixkit-black-and-white-abstract-fragments-1345-small.mp4" type="video/mp4">
                        
                        Your browser does not support the video tag.
                    </video>
                    <!-- Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ØµØ± Ø§Ù„ØµÙˆØ±Ø© Ù‡Ù†Ø§ØŒ ÙˆØ³ÙŠÙƒÙˆÙ† Ù…Ø®ÙÙŠØ§Ù‹ Ø£ÙŠØ¶Ø§Ù‹ -->
                    <img id="hero-image" src="" alt="Hero Background" class="absolute inset-0 w-full h-full object-cover opacity-30 hidden">
                    
                    <div class="relative z-10 flex flex-col justify-end items-start h-full text-right p-6 sm:p-8 lg:p-12" style="min-height: 350px; sm:min-height: 400px;">
                        <h1 class="text-2xl sm:text-4xl font-extrabold text-white leading-tight max-w-3xl">
                            Ù…ØªØ¬Ø± Ù…ÙƒØ©
                        </h1>
                        <p class="mt-3 text-sm sm:text-base text-[#ffcd00] max-w-3xl">
                            ÙƒÙ„ Ù…Ø§ Ù‡Ùˆ Ø¬Ø¯ÙŠØ¯ ÙÙŠ Ø¹Ø§Ù„Ù… Ø§Ù„Ø¯ÙŠÙƒÙˆØ± Ø§Ù„Ø­Ø¯ÙŠØ« ÙˆØ§Ù„Ø¥Ø¶Ø§Ø¡Ø©
                        </p>
                        <p class="mt-3 text-base sm:text-lg text-gray-200">
                            Ø£ÙƒØ«Ø± Ù…Ù† 20 Ø¹Ø§Ù…Ù‹Ø§ Ù…Ù† Ø§Ù„Ø®Ø¨Ø±Ø© ÙÙŠ Ù‚Ù„Ø¨ Ø§Ù„Ù…Ù‚Ø·Ù…
                        </p>
                        
                        
                        <a href="#products" class="nav-link mt-8 inline-flex items-center gap-3 px-6 py-3 sm:px-8 bg-gradient-to-r from-[#ffcd00] to-[#ffb700] text-gray-900 font-bold text-base sm:text-lg rounded-lg shadow-xl hover:shadow-2xl hover:from-[#ffda33] hover:to-[#ffcd00] transform transition-all duration-300 hover:-translate-y-1" data-page="products">
                            <span>ØªØµÙØ­ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</span>
                            <i data-lucide="arrow-right" class="w-5 h-5"></i>
                        </a>
                    </div>
                </div>
            
                <div>
                    <h2 class="text-2xl sm:text-3xl font-bold text-right mb-6">Ø£Ù‚Ø³Ø§Ù…Ù†Ø§ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</h2>
                    <!-- ØªÙ… ØªØ¹Ø¯ÙŠÙ„ grid-cols-5 Ø¥Ù„Ù‰ grid-cols-6 Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø© -->
                    <div class="grid grid-cols-3 md:grid-cols-6 gap-3 sm:gap-4">
                        <a href="#products" 
                           class="nav-link card-hover group block bg-white dark:bg-[#2c2f38] p-4 rounded-2xl shadow-lg text-center transition-all duration-300" 
                           data-page="products" data-category-filter="Lighting">
                            
                            <!-- ØªÙ… ØªØµØºÙŠØ± Ø­Ø¬Ù… Ø§Ù„ØµÙˆØ± Ù‚Ù„ÙŠÙ„Ø§Ù‹ Ù„ØªÙ†Ø§Ø³Ø¨ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø¬Ø¯ÙŠØ¯ -->
                            <img src="https://i.postimg.cc/bYWdsZg0/pngtree-light-bulb-electrical-equipment-spiral-png-image-6469929.webp" 
                                 alt="Ù„Ù…Ø¨Ø§Øª ÙˆØ¥Ø¶Ø§Ø¡Ø©"
                                 class="w-16 h-16 sm:w-20 sm:h-20 mx-auto rounded-full object-cover border-4 border-transparent group-hover:border-[#ffcd00] transition-all duration-300 group-hover:scale-110 aspect-square">
                            
                            <h3 class="text-sm sm:text-base font-semibold mt-3 text-gray-800 dark:text-white transition-colors group-hover:text-[#ffcd00]">
                                Ù„Ù…Ø¨Ø§Øª ÙˆØ¥Ø¶Ø§Ø¡Ø©
                            </h3>
                        </a>
                        <a href="#products" 
                           class="nav-link card-hover group block bg-white dark:bg-[#2c2f38] p-4 rounded-2xl shadow-lg text-center transition-all duration-300" 
                           data-page="products" data-category-filter="Cables">
                            
                            <img src="https://i.postimg.cc/8k9sj746/pngegg-1.webp" 
                                 alt="ÙƒØ§Ø¨Ù„Ø§Øª ÙˆØ£Ø³Ù„Ø§Ùƒ"
                                 class="w-16 h-16 sm:w-20 sm:h-20 mx-auto rounded-full object-cover border-4 border-transparent group-hover:border-[#ffcd00] transition-all duration-300 group-hover:scale-110 aspect-square">
                            
                            <h3 class="text-sm sm:text-base font-semibold mt-3 text-gray-800 dark:text-white transition-colors group-hover:text-[#ffcd00]">
                                ÙƒØ§Ø¨Ù„Ø§Øª ÙˆØ£Ø³Ù„Ø§Ùƒ
                            </h3>
                        </a>
                        <a href="#products" 
                           class="nav-link card-hover group block bg-white dark:bg-[#2c2f38] p-4 rounded-2xl shadow-lg text-center transition-all duration-300" 
                           data-page="products" data-category-filter="Switches">
                            
                            <img src="https://i.postimg.cc/c126rvht/pngegg.webp" 
                                 alt="Ù…ÙØ§ØªÙŠØ­ ÙˆØ¨Ø±Ø§ÙŠØ²"
                                 class="w-16 h-16 sm:w-20 sm:h-20 mx-auto rounded-full object-cover border-4 border-transparent group-hover:border-[#ffcd00] transition-all duration-300 group-hover:scale-110 aspect-square">
                            
                            <h3 class="text-sm sm:text-base font-semibold mt-3 text-gray-800 dark:text-white transition-colors group-hover:text-[#ffcd00]">
                                Ù…ÙØ§ØªÙŠØ­ ÙˆØ¨Ø±Ø§ÙŠØ²
                            </h3>
                        </a>
                        <a href="#products" 
                           class="nav-link card-hover group block bg-white dark:bg-[#2c2f38] p-4 rounded-2xl shadow-lg text-center transition-all duration-300" 
                           data-page="products" data-category-filter="Parts">
                            
                            <img src="https://i.postimg.cc/RCyqNWdt/64f8ce87bfcba599968620.webp" 
                                 alt="Ù‚Ø·Ø¹ ØºÙŠØ§Ø± ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©"
                                 class="w-16 h-16 sm:w-20 sm:h-20 mx-auto rounded-full object-cover border-4 border-transparent group-hover:border-[#ffcd00] transition-all duration-300 group-hover:scale-110 aspect-square">
                            
                            <h3 class="text-sm sm:text-base font-semibold mt-3 text-gray-800 dark:text-white transition-colors group-hover:text-[#ffcd00]">
                                Ù‚Ø·Ø¹ ØºÙŠØ§Ø±
                            </h3>
                        </a>
                        <a href="#products" 
                           class="nav-link card-hover group block bg-white dark:bg-[#2c2f38] p-4 rounded-2xl shadow-lg text-center transition-all duration-300" 
                           data-page="products" data-category-filter="Paints">
                            
                            <img src="https://i.postimg.cc/1R24f8BN/0Rwy-P3z-WFNu1nm-Q31e-Uqv-KMh-M2ws-NBKv-QIw-FM9o1-1000x1000.webp" 
                                 alt="Ø¯Ù‡Ø§Ù†Ø§Øª"
                                 class="w-16 h-16 sm:w-20 sm:h-20 mx-auto rounded-full object-cover border-4 border-transparent group-hover:border-[#ffcd00] transition-all duration-300 group-hover:scale-110 aspect-square">
                            
                            <h3 class="text-sm sm:text-base font-semibold mt-3 text-gray-800 dark:text-white transition-colors group-hover:text-[#ffcd00]">
                                Ø¯Ù‡Ø§Ù†Ø§Øª
                            </h3>
                        </a>
                        <a href="#products" 
                           class="nav-link card-hover group block bg-white dark:bg-[#2c2f38] p-4 rounded-2xl shadow-lg text-center transition-all duration-300" 
                           data-page="products" data-category-filter="Ironmongery">
                            
                            <img src="https://i.postimg.cc/5t57Xgth/pngtree-bolts-and-nuts-texture-industrial-part-photo-image-15980034.jpg" 
                                 alt="Ø­Ø¯Ø§ÙŠØ¯"
                                 class="w-16 h-16 sm:w-20 sm:h-20 mx-auto rounded-full object-cover border-4 border-transparent group-hover:border-[#ffcd00] transition-all duration-300 group-hover:scale-110 aspect-square">
                            
                            <h3 class="text-sm sm:text-base font-semibold mt-3 text-gray-800 dark:text-white transition-colors group-hover:text-[#ffcd00]">
                                Ø­Ø¯Ø§ÙŠØ¯
                            </h3>
                        </a>
                    </div>
                </div>
            
                <div>
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl sm:text-3xl font-bold text-right">Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø­Ø§Ù„ÙŠØ©</h2>
                        <a href="#products" 
                           class="see-all-link text-sm font-medium text-[#ffcd00] hover:text-[#ffda33] flex items-center gap-1"
                           data-filter-type="sale">
                            <span>Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„</span>
                            <i data-lucide="arrow-right" class="w-4 h-4"></i>
                        </a>
                    </div>
                    
                    <div id="home-offers-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3 sm:gap-4">
                        
                    </div>
                </div>
                
                <div>
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl sm:text-3xl font-bold text-right">Ø§Ù„Ø£ÙƒØ«Ø± Ù…Ø¨ÙŠØ¹Ø§Ù‹</h2>
                        <a href="#products" 
                           class="see-all-link text-sm font-medium text-[#ffcd00] hover:text-[#ffda33] flex items-center gap-1"
                           data-filter-type="bestseller">
                            <span>Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„</span>
                            <i data-lucide="arrow-right" class="w-4 h-4"></i>
                        </a>
                    </div>
                    
                    <div id="home-bestsellers-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3 sm:gap-4">
                        
                    </div>
                </div>

                <!-- Modernized Supply & Installation Services Section -->
                <div class="relative bg-gradient-to-br from-gray-900 to-gray-800 dark:from-[#222] dark:to-[#1a1a1a] rounded-[2.5rem] shadow-2xl overflow-hidden mt-16 isolate">
                    <!-- Decorative glows -->
                    <div class="absolute top-0 right-0 -translate-y-1/4 translate-x-1/4 w-96 h-96 bg-[#ffcd00]/20 blur-3xl rounded-full -z-10 opacity-70"></div>
                    <div class="absolute bottom-0 left-0 translate-y-1/4 -translate-x-1/4 w-64 h-64 bg-[#ffcd00]/10 blur-3xl rounded-full -z-10"></div>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-0">
                        <!-- Text Content -->
                        <div class="p-8 sm:p-12 lg:py-16 lg:pr-16 lg:pl-8 flex flex-col justify-center order-2 lg:order-1">
                            <div class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-[#ffcd00]/10 border border-[#ffcd00]/20 text-[#ffcd00] text-sm font-bold w-fit mb-6 backdrop-blur-md">
                                <i data-lucide="shield-check" class="w-4 h-4"></i>
                                <span>Ù„Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ ÙˆØ§Ù„Ø´Ø±ÙƒØ§Øª</span>
                            </div>
                            <h2 class="text-3xl sm:text-4xl lg:text-5xl font-extrabold text-white leading-tight mb-6">
                                Ø´Ø±ÙŠÙƒÙƒ Ø§Ù„Ù…ÙˆØ«ÙˆÙ‚ ÙÙŠ
                                <br>
                                <span class="text-transparent bg-clip-text bg-gradient-to-r from-[#ffcd00] to-[#ffda33]">Ø§Ù„ØªÙˆØ±ÙŠØ¯ ÙˆØ§Ù„ØªØ±ÙƒÙŠØ¨</span>
                            </h2>
                            <p class="text-lg text-gray-300 leading-relaxed mb-8 max-w-xl">
                                Ù„Ø§ Ù†ÙƒØªÙÙŠ Ø¨Ø¨ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§ØªØŒ Ø¨Ù„ Ù†Ù‚Ø¯Ù… Ø­Ù„ÙˆÙ„Ø§Ù‹ ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ© Ù…ØªÙƒØ§Ù…Ù„Ø©. Ù…Ù† ØªÙˆØ±ÙŠØ¯ Ø£Ø¬ÙˆØ¯ Ø§Ù„Ø®Ø§Ù…Ø§Øª Ø¨Ø£Ø³Ø¹Ø§Ø± ØªÙ†Ø§ÙØ³ÙŠØ© Ø¥Ù„Ù‰ Ø§Ù„ØªØ±ÙƒÙŠØ¨ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ Ø§Ù„Ø¢Ù…Ù†ØŒ Ù†Ø¶Ù…Ù† Ù†Ø¬Ø§Ø­ Ù…Ø´Ø±ÙˆØ¹Ùƒ Ø¨ÙƒÙØ§Ø¡Ø© Ø¹Ø§Ù„ÙŠØ©.
                            </p>

                            <!-- Feature List -->
                            <ul class="space-y-5 mb-10">
                                <li class="flex items-center gap-4">
                                    <div class="flex-shrink-0 w-10 h-10 rounded-xl bg-[#ffcd00] flex items-center justify-center shadow-lg shadow-[#ffcd00]/20">
                                        <i data-lucide="hard-hat" class="w-5 h-5 text-gray-900"></i>
                                    </div>
                                    <span class="text-gray-100 font-medium text-lg">ÙØ±ÙŠÙ‚ ÙÙ†ÙŠ Ù…ØªØ®ØµØµ ÙˆÙ…Ø¹ØªÙ…Ø¯</span>
                                </li>
                                <li class="flex items-center gap-4">
                                     <div class="flex-shrink-0 w-10 h-10 rounded-xl bg-[#ffcd00] flex items-center justify-center shadow-lg shadow-[#ffcd00]/20">
                                        <i data-lucide="badge-check" class="w-5 h-5 text-gray-900"></i>
                                    </div>
                                    <span class="text-gray-100 font-medium text-lg">Ø¶Ù…Ø§Ù† Ø´Ø§Ù…Ù„ Ø¹Ù„Ù‰ Ø¬ÙˆØ¯Ø© Ø§Ù„ØªØ±ÙƒÙŠØ¨</span>
                                </li>
                                <li class="flex items-center gap-4">
                                     <div class="flex-shrink-0 w-10 h-10 rounded-xl bg-[#ffcd00] flex items-center justify-center shadow-lg shadow-[#ffcd00]/20">
                                        <i data-lucide="coins" class="w-5 h-5 text-gray-900"></i>
                                    </div>
                                    <span class="text-gray-100 font-medium text-lg">Ø£Ø³Ø¹Ø§Ø± Ø®Ø§ØµØ© Ù„ØªÙˆØ±ÙŠØ¯Ø§Øª Ø§Ù„Ø¬Ù…Ù„Ø© ÙˆØ§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹</span>
                                </li>
                            </ul>

                            <div class="flex flex-wrap gap-4">
                                 <a href="https://wa.me/201146641942" target="_blank" class="flex-1 sm:flex-none justify-center inline-flex items-center gap-3 px-8 py-4 bg-white/5 text-white font-bold text-lg rounded-2xl hover:bg-white/10 transition-all border border-white/10 backdrop-blur-sm">
                                    <i data-lucide="message-circle" class="w-5 h-5"></i>
                                    <span>Ø§Ø³ØªØ´Ø§Ø±Ø© ÙÙ†ÙŠØ©</span>
                                </a>
                            </div>
                        </div>

                        <!-- Image Side -->
                        <div class="relative min-h-[300px] lg:min-h-full order-1 lg:order-2">
                            <div class="absolute inset-0 lg:ml-8 rounded-[2.5rem] overflow-hidden">
                                <img src="https://images.unsplash.com/photo-1621905251189-08b45d6a269e?q=80&w=2069&auto=format&fit=crop"
                                     alt="ÙÙ†ÙŠ ÙƒÙ‡Ø±Ø¨Ø§Ø¡ Ù…Ø­ØªØ±Ù Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¹Ù…Ù„"
                                     class="w-full h-full object-cover transform transition-transform duration-700 hover:scale-105"
                                     loading="lazy"
                                     onerror="this.src='https://placehold.co/800x1000/2c2f38/ffcd00?text=Ø®Ø¯Ù…Ø§Øª+Ø§Ø­ØªØ±Ø§ÙÙŠØ©'">
                                <!-- Gradient overlay for better text integration on small screens if needed -->
                                <div class="absolute inset-0 bg-gradient-to-t from-gray-900 via-transparent to-transparent lg:bg-gradient-to-r lg:from-gray-900 lg:via-transparent lg:to-transparent opacity-80 lg:opacity-100"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Ù‚Ø³Ù… Ø¢Ø±Ø§Ø¡ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ø¬Ø¯ÙŠØ¯ -->
                <div class="mt-16">
                    <h2 class="text-2xl sm:text-3xl font-bold text-center mb-8 text-gray-900 dark:text-white">
                        Ù…Ø§Ø°Ø§ ÙŠÙ‚ÙˆÙ„ Ø¹Ù…Ù„Ø§Ø¤Ù†Ø§ Ø¹Ù†Ø§
                    </h2>
                    
                    <div class="testimonials-scroll-container py-4">
                        <div class="testimonials-scroll-track space-x-4 space-x-reverse" id="testimonials-track">
                            <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… Ø¨ÙˆØ§Ø³Ø·Ø© JavaScript -->
                        </div>
                    </div>
                </div>
            
            </section>
            
            
            <!-- NEW: Dedicated Offers Page -->
            <section id="page-offers" class="page-section pt-8">
                <div class="flex items-center gap-3 mb-8">
                    <h1 class="text-3xl sm:text-4xl font-bold text-red-600 dark:text-red-500">ğŸ”¥ Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø­Ø§Ù„ÙŠØ©</h1>
                    <div class="h-px flex-grow bg-red-200 dark:bg-red-900/30"></div>
                </div>

                <!-- NEW: Average Offer Timer Section -->
                <div id="average-offer-timer" class="hidden mb-8 p-6 bg-gradient-to-r from-red-600 to-orange-600 rounded-2xl text-white shadow-xl text-center transform transition-all hover:scale-[1.02]">
                    <h3 class="text-lg sm:text-xl font-bold mb-3 flex items-center justify-center gap-2">
                        <i data-lucide="hourglass" class="w-6 h-6 animate-pulse"></i>
                        Ù…ØªÙˆØ³Ø· Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø¹Ø±ÙˆØ¶
                    </h3>
                    <div dir="ltr" id="average-timer-display" class="text-3xl sm:text-5xl font-extrabold font-mono tracking-wider">
                        <!-- Timer will be injected here -->
                    </div>
                    <p class="text-sm sm:text-base opacity-90 mt-3 font-medium">Ø³Ø§Ø±Ø¹ Ø¨Ø§ØºØªÙ†Ø§Ù… Ø§Ù„ÙØ±ØµØ© Ù‚Ø¨Ù„ ÙÙˆØ§Øª Ø§Ù„Ø£ÙˆØ§Ù†!</p>
                </div>
                
                <div id="offers-page-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-3 sm:gap-4">
                    <!-- Offers will be loaded here -->
                </div>
                <div id="no-offers-message" class="hidden text-center py-12">
                    <i data-lucide="tag" class="w-16 h-16 mx-auto text-gray-400"></i>
                    <h2 class="text-2xl font-semibold mt-4">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ø±ÙˆØ¶ Ø­Ø§Ù„ÙŠØ§Ù‹</h2>
                    <p class="text-gray-500 dark:text-gray-400 mt-2">ØªØ§Ø¨Ø¹Ù†Ø§ Ù„Ù…Ø¹Ø±ÙØ© Ø£Ø­Ø¯Ø« Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª Ù‚Ø±ÙŠØ¨Ø§Ù‹!</p>
                </div>
            </section>

            <section id="page-products" class="page-section pt-8">
                <h1 class="text-3xl sm:text-4xl font-bold mb-8">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h1>
                
                <div class="flex flex-col sm:flex-row gap-4 mb-8 items-center p-1.5 bg-white/50 dark:bg-[#2c2f38]/50 backdrop-blur-xl rounded-2xl border border-white/20 dark:border-gray-700/30 shadow-sm">
                    
                    <div class="flex-grow w-full flex items-center">
                        <div class="relative h-full flex items-center pl-4 flex-shrink-0">
                            <i data-lucide="chevron-down" class="w-4 h-4 absolute top-1/2 left-3 -translate-y-1/2 text-gray-400 z-10 pointer-events-none"></i>
                            <select id="product-category-filter" class="h-10 pl-8 pr-4 rounded-xl bg-transparent border-none focus:ring-0 text-sm font-medium text-gray-700 dark:text-gray-200 appearance-none cursor-pointer hover:bg-black/5 dark:hover:bg-white/5 transition-colors [&>option]:bg-gray-100 [&>option]:text-gray-900 dark:[&>option]:bg-[#1f1f1f] dark:[&>option]:text-gray-100">
                                <option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</option>
                                <option value="Lighting">Ø¥Ø¶Ø§Ø¡Ø©</option>
                                <option value="Cables">ÙƒØ§Ø¨Ù„Ø§Øª</option>
                                <option value="Switches">Ù…ÙØ§ØªÙŠØ­</option>
                                <option value="Parts">Ù‚Ø·Ø¹ ØºÙŠØ§Ø±</option>
                                <option value="Paints">Ø¯Ù‡Ø§Ù†Ø§Øª</option>
                                <option value="Ironmongery">Ø­Ø¯Ø§ÙŠØ¯</option>
                            </select>
                        </div>

                        <!-- NEW: Brand Filter -->
                        <div class="h-6 w-px bg-gray-200 dark:bg-gray-700 mx-2"></div>
                        <div class="relative h-full flex items-center pl-4 flex-shrink-0">
                            <i data-lucide="chevron-down" class="w-4 h-4 absolute top-1/2 left-3 -translate-y-1/2 text-gray-400 z-10 pointer-events-none"></i>
                            <select id="product-brand-filter" class="h-10 pl-8 pr-4 rounded-xl bg-transparent border-none focus:ring-0 text-sm font-medium text-gray-700 dark:text-gray-200 appearance-none cursor-pointer hover:bg-black/5 dark:hover:bg-white/5 transition-colors [&>option]:bg-gray-100 [&>option]:text-gray-900 dark:[&>option]:bg-[#1f1f1f] dark:[&>option]:text-gray-100">
                                <option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø§Ø±ÙƒØ§Øª</option>
                                <!-- Brands will be populated by JS -->
                            </select>
                        </div>
                        <!-- END NEW -->

                        <div class="h-6 w-px bg-gray-200 dark:bg-gray-700 mx-2"></div>

                        <div class="relative flex-grow">
                            <input type="text" id="product-search-input" placeholder="Ø§Ø¨Ø­Ø« ÙÙŠ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…..." class="w-full h-10 pr-10 pl-4 bg-transparent border-none focus:ring-0 text-gray-900 dark:text-white placeholder:text-gray-400/80">
                            <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400">
                                <i data-lucide="search" class="w-5 h-5 opacity-70"></i>
                            </span>
                        </div>
                    </div>

                    <div class="flex items-center gap-2 w-full sm:w-auto pl-1.5 flex-shrink-0">
                        <div class="relative w-full sm:w-auto">
                             <i data-lucide="chevron-down" class="w-4 h-4 absolute top-1/2 left-3 -translate-y-1/2 text-gray-400 z-10 pointer-events-none"></i>
                            <select id="product-sort-filter" class="w-full sm:w-auto h-10 pl-8 pr-4 rounded-xl bg-gray-100/50 dark:bg-gray-800/50 border-none focus:ring-0 text-sm font-medium text-gray-700 dark:text-gray-200 appearance-none cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors [&>option]:bg-gray-100 [&>option]:text-gray-900 dark:[&>option]:bg-[#1f1f1f] dark:[&>option]:text-gray-100">
                                <option value="default">Ø§Ù„ØªØ±ØªÙŠØ¨ Ø­Ø³Ø¨</option>
                                <option value="price-asc">Ø§Ù„Ø³Ø¹Ø±: Ù…Ù† Ø§Ù„Ø£Ù‚Ù„ Ù„Ù„Ø£Ø¹Ù„Ù‰</option>
                                <option value="price-desc">Ø§Ù„Ø³Ø¹Ø±: Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰ Ù„Ù„Ø£Ù‚Ù„</option>
                            </select>
                        </div>
                        
                        <button id="show-add-product-modal-btn" type="button" class="hidden items-center justify-center gap-2 h-10 px-4 bg-[#ffcd00] text-gray-900 font-bold text-sm rounded-xl hover:bg-[#ffda33] transition-colors flex-shrink-0">
                            <i data-lucide="plus-circle" class="w-4 h-4"></i>
                            <span class="hidden sm:inline">Ø¥Ø¶Ø§ÙØ©</span>
                        </button>
                    </div>
                </div>
                
                
                <div id="products-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-3 sm:gap-4">
                    
                </div>
                <div id="no-products-message" class="hidden text-center py-12">
                    <i data-lucide="search-x" class="w-16 h-16 mx-auto text-gray-400"></i>
                    <h2 class="text-2xl font-semibold mt-4">Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ù†ØªØ¬Ø§Øª</h2>
                    <p class="text-gray-500 dark:text-gray-400 mt-2">Ø­Ø§ÙˆÙ„ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¨Ø­Ø« Ø£Ùˆ Ø§Ù„ÙÙ„ØªØ±Ø©.</p>
                </div>
            </section>
            

            <section id="page-details" class="page-section">
                
                <div class="mb-6">
                    <a href="#products" class="nav-link inline-flex items-center gap-2 px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 font-medium rounded-lg shadow-sm hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors" data-page="products">
                        <i data-lucide="arrow-right" class="w-5 h-5"></i>
                        <span>Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ù†ØªØ¬Ø§Øª</span>
                    </a>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-5 gap-8 lg:gap-12 mx-auto max-w-7xl">

                    <div class="md:col-span-3">
                        <div class="bg-white dark:bg-[#2c2f38] rounded-2xl shadow-xl overflow-hidden p-6 sm:p-8">
                            
                          
                            <div class="flex flex-col-reverse md:flex-row-reverse gap-4">

                               
                                <div class="relative group flex-1">
                                    <img id="main-product-image" 
                                         src="https://placehold.co/600x600/ffffff/999999?text=Main+Product+Image" 
                                         onerror="this.src='https://placehold.co/600x600/ffffff/999999?text=ØµÙˆØ±Ø©+Ø§Ù„Ù…Ù†ØªØ¬+Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©'"
                                         alt="ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©" 
                                         class="w-full h-auto object-cover rounded-lg shadow-md aspect-square">

                                    <button id="gallery-prev-btn" class="absolute top-1/2 right-2 left-auto -translate-y-1/2 z-10 p-2 bg-black/30 text-white rounded-full hover:bg-black/50 opacity-70 hover:opacity-100 transition-opacity">
                                        <i data-lucide="chevron-left" class="w-6 h-6"></i>
                                    </button>

                                    <button id="gallery-next-btn" class="absolute top-1/2 left-2 right-auto -translate-y-1/2 z-10 p-2 bg-black/30 text-white rounded-full hover:bg-black/50 opacity-70 hover:opacity-100 transition-opacity">
                                        <i data-lucide="chevron-right" class="w-6 h-6"></i>
                                    </button>
                                </div>
                                
                            
                                <div class="flex md:flex-col gap-2 overflow-x-auto md:overflow-y-auto md:max-h-[600px] flex-shrink-0 w-full md:w-20" id="details-thumbnail-container">
                              
                                </div>
                            
                            </div>

                            
                            <div class="mt-12 hidden md:block">
                                <h3 class="text-2xl font-bold mb-6 text-gray-900 dark:text-white">Ù‚Ø¯ ÙŠØ¹Ø¬Ø¨Ùƒ Ø£ÙŠØ¶Ø§Ù‹</h3>
                                
                                <div id="ai-suggestions-loading-desktop" class="hidden loading-dots justify-center py-8">
                                    <div class="loading-dot"></div>
                                    <div class="loading-dot"></div>
                                    <div class="loading-dot"></div>
                                </div>
                                
                              
                                <div id="ai-suggestions-grid-desktop" class="grid grid-cols-2 sm:grid-cols-3 gap-3 sm:gap-4">
                                    
                                </div>
                            </div>
                          

                        </div>
                    </div>
                    <div class="md:col-span-2 flex flex-col gap-6">
                        <div class="bg-white dark:bg-[#2c2f38] rounded-2xl shadow-xl p-6 sm:p-8">
                            <!-- NEW: Category and Company container -->
                            <div class="flex flex-wrap items-center gap-2 mb-3">
                                <span id="details-product-category" class="px-3 py-1 text-xs font-bold text-[#997a00] dark:text-[#ffcd00] bg-[#ffcd00]/10 border border-[#ffcd00]/20 rounded-full hidden"></span>
                                <span id="details-product-company" class="text-sm font-medium text-gray-500 dark:text-gray-400 hidden"></span>
                            </div>
                            
                            <h1 id="details-product-name" class="text-3xl lg:text-4xl font-extrabold mb-4 text-gray-900 dark:text-white">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</h1>
                            
                            <div id="details-star-rating" class="star-rating mb-4 text-xl">
                            
                            </div>
                            
                            <div id="details-product-price" class="mb-6">
                               
                            </div>
            
                            <!-- New Color Options Container -->
                            <div id="details-color-options" class="mb-8 hidden">
                                <h3 class="text-base font-semibold mb-3 text-gray-900 dark:text-white">Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù…ØªØ§Ø­Ø©</h3>
                                <div id="color-swatches-container" class="flex flex-wrap gap-3"></div>
                            </div>

                            <p id="details-product-description" class="text-gray-600 dark:text-gray-300 leading-relaxed mb-8 break-words">
                                Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙˆØµÙ...
                            </p>
            
                            <div id="details-add-to-cart-wrapper" class="space-y-4 product-card-wrapper"
                                 data-product-id=""
                                 data-product-name=""
                                 data-product-price=""
                                 data-product-image="">
                                
                                <div class="flex items-end gap-3">
                                    <div>
                                        <label for="details-quantity-input" class="block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300">Ø§Ù„ÙƒÙ…ÙŠØ©</label>
                                        <input type="number" id="details-quantity-input" value="1" min="1" 
                                               class="w-24 px-4 py-3 rounded-lg bg-gray-100 dark:bg-[#3d474e] border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00] text-lg font-bold text-center">
                                    </div>
                                    
                                    <button class="add-to-cart-btn flex-1 flex items-center justify-center gap-3 px-6 py-3 bg-[#ffcd00] text-gray-900 font-bold text-lg rounded-lg shadow-lg hover:bg-[#ffda33] transform transition-all duration-300 hover:-translate-y-0.5">
                                        <i data-lucide="shopping-cart" class="w-6 h-6"></i>
                                        <span>Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©</span>
                                    </button>
                                </div>
                                <a id="details-whatsapp-link" href="https://wa.me/201146641942" target="_blank" class="w-full flex items-center justify-center gap-3 px-6 py-3 bg-transparent border border-green-500 text-green-500 font-bold text-lg rounded-lg shadow-lg hover:bg-green-500 hover:text-white transform transition-all duration-300">
                                    <i data-lucide="message-circle" class="w-6 h-6"></i>
                                    <span>ØªÙˆØ§ØµÙ„ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</span>
                                </a>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-[#2c2f38] rounded-2xl shadow-xl overflow-hidden">
                            <div class="flex border-b border-gray-200 dark:border-gray-700">
                                <button class="tab-btn active-tab px-6 py-4 text-lg font-semibold text-[#ffcd00] border-b-2 border-[#ffcd00]" data-tab="specs">
                                    Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª
                                </button>
                                <button class="tab-btn px-6 py-4 text-lg font-semibold text-gray-500 hover:text-gray-900 dark:hover:text-white" data-tab="reviews">
                                    Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø§Øª (3)
                                </button>
                            </div>
                            
                            
                            <div class="p-6 sm:p-8">
                                
                                <div id="tab-content-specs" class="tab-content space-y-3">
                                    <h3 class="text-xl font-semibold mb-4 text-gray-900 dark:text-white">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬</h3>
                                    <ul id="specs-list-container" class="space-y-3 text-base text-gray-600 dark:text-gray-300 max-w-md">
                                      
                                    </ul>
                                </div>
                            
                            
                            <div id="tab-content-reviews" class="tab-content hidden space-y-6">
                                <h3 class="text-xl font-semibold mb-4 text-gray-900 dark:text-white">Ù…Ø±Ø§Ø¬Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</h3>
                                <div class="space-y-6">
                                    <div class="border-b border-gray-200 dark:border-gray-700 pb-6">
                                        <div class="flex items-center mb-2">
                                            <span class="font-semibold text-lg text-gray-900 dark:text-white">Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…ÙˆØ¯</span>
                                            <span class="text-sm text-gray-500 mr-3">Ù…Ù†Ø° Ø£Ø³Ø¨ÙˆØ¹</span>
                                        </div>
                                        <div class="text-[#ffcd00] text-xl mb-2">â˜…â˜…â˜…â˜…â˜†</div>
                                        <p class="text-base text-gray-600 dark:text-gray-300 mt-1">Ù…Ù†ØªØ¬ Ù…Ù…ØªØ§Ø² ÙˆØ¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ©ØŒ Ù„ÙƒÙ† Ø§Ù„ØªÙˆØµÙŠÙ„ ØªØ£Ø®Ø± Ù‚Ù„ÙŠÙ„Ø§Ù‹.</p>
                                    </div>
                                    <div class="border-b border-gray-200 dark:border-gray-700 pb-6">
                                        <div class="flex items-center mb-2">
                                            <span class="font-semibold text-lg text-gray-900 dark:text-white">ÙØ§Ø·Ù…Ø© Ø¹Ù„ÙŠ</span>
                                            <span class="text-sm text-gray-500 mr-3">Ù…Ù†Ø° Ø´Ù‡Ø±</span>
                                        </div>
                                        <div class="text-[#ffcd00] text-xl mb-2">â˜…â˜…â˜…â˜…â˜…</div>
                                        <p class="text-base text-gray-600 dark:text-gray-300 mt-1">Ø±Ø§Ø¦Ø¹! Ø£Ù†ØµØ­ Ø¨Ù‡ Ø¨Ø´Ø¯Ø©.</p>
                                     </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
              
                <!-- Mobile Suggestions moved INSIDE page-details section -->
                <div class="mt-12 md:hidden">
                    <div class="bg-white dark:bg-[#2c2f38] rounded-2xl shadow-xl overflow-hidden p-6 sm:p-8">
                        <h3 class="text-2xl font-bold mb-6 text-gray-900 dark:text-white">Ù‚Ø¯ ÙŠØ¹Ø¬Ø¨Ùƒ Ø£ÙŠØ¶Ø§Ù‹</h3>
                        
                        <div id="ai-suggestions-loading-mobile" class="hidden loading-dots justify-center py-8">
                            <div class="loading-dot"></div>
                            <div class="loading-dot"></div>
                            <div class="loading-dot"></div>
                        </div>
                        
                        <div id="ai-suggestions-grid-mobile" class="grid grid-cols-2 sm:grid-cols-3 gap-3 sm:gap-4">
                            
                        </div>
                    </div>
                </div>

            </section>
            
            <section id="page-about" class="page-section space-y-12 pt-8">
                <div class="relative bg-white dark:bg-[#2c2f38] rounded-xl shadow-lg overflow-hidden p-8 md:p-12 text-center">
                    <h1 class="text-4xl font-bold mb-4 text-[#ffcd00]">Ø¹Ù† Ù…ØªØ¬Ø± Ù…ÙƒØ©</h1>
                    <p class="text-xl text-gray-600 dark:text-gray-300 max-w-3xl mx-auto">
                        Ø®Ø¨Ø±Ø© ØªÙ…ØªØ¯ Ù„Ø£ÙƒØ«Ø± Ù…Ù† 20 Ø¹Ø§Ù…Ù‹Ø§ ÙÙŠ Ù‚Ù„Ø¨ Ø§Ù„Ù…Ù‚Ø·Ù…ØŒ Ù†Ù‚Ø¯Ù… ÙƒÙ„ Ù…Ø§ Ù‡Ùˆ Ø¬Ø¯ÙŠØ¯ ÙÙŠ Ø¹Ø§Ù„Ù… Ø§Ù„Ø¯ÙŠÙƒÙˆØ± Ø§Ù„Ø­Ø¯ÙŠØ« ÙˆØ§Ù„Ø¥Ø¶Ø§Ø¡Ø©.
                    </p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="bg-white dark:bg-[#2c2f38] p-6 rounded-xl shadow-lg flex items-center gap-4">
                        <i data-lucide="award" class="w-10 h-10 text-[#ffcd00] flex-shrink-0"></i>
                        <div>
                            <h3 class="text-lg font-semibold">Ø®Ø¨Ø±Ø© Ù…ÙˆØ«ÙˆÙ‚Ø©</h3>
                            <p class="text-gray-500 dark:text-gray-400 text-sm">Ø£ÙƒØ«Ø± Ù…Ù† 20 Ø¹Ø§Ù…Ù‹Ø§ ÙÙŠ Ø§Ù„Ø³ÙˆÙ‚.</p>
                        </div>
                    </div>
                    <div class="bg-white dark:bg-[#2c2f38] p-6 rounded-xl shadow-lg flex items-center gap-4">
                        <i data-lucide="shield-check" class="w-10 h-10 text-[#ffcd00] flex-shrink-0"></i>
                        <div>
                            <h3 class="text-lg font-semibold">Ø¬ÙˆØ¯Ø© Ù…Ø¶Ù…ÙˆÙ†Ø©</h3>
                            <p class="text-gray-500 dark:text-gray-400 text-sm">Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ø§Ø±ÙƒØ§Øª Ø§Ù„Ù…Ø¶Ù…ÙˆÙ†Ø©.</p>
                        </div>
                    </div>
                    <div class="bg-white dark:bg-[#2c2f38] p-6 rounded-xl shadow-lg flex items-center gap-4">
                        <i data-lucide="truck" class="w-10 h-10 text-[#ffcd00] flex-shrink-0"></i>
                        <div>
                            <h3 class="text-lg font-semibold">ØªÙˆØ±ÙŠØ¯ ÙˆØªØ±ÙƒÙŠØ¨</h3>
                            <p class="text-gray-500 dark:text-gray-400 text-sm">Ø®Ø¯Ù…Ø§Øª Ø§Ø­ØªØ±Ø§ÙÙŠØ© Ù„Ù„Ù…Ø´Ø§Ø±ÙŠØ¹.</p>
                        </div>
                    </div>
                </div>
                <div class="bg-white dark:bg-[#2c2f38] p-6 sm:p-8 rounded-xl shadow-lg">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 items-center">
                        <div class="space-y-4">
                            <h2 class="text-3xl font-bold mb-4">Ù‚ØµØªÙ†Ø§</h2>
                            <p class="text-base sm:text-lg text-gray-600 dark:text-gray-300 leading-relaxed">
                                "Ù…ØªØ¬Ø± Ù…ÙƒØ© Ù„Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ© Ù‡Ùˆ ÙˆØ¬Ù‡ØªÙƒ Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù„ÙƒÙ„ Ø§Ø­ØªÙŠØ§Ø¬Ø§ØªÙƒ Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©ØŒ Ù†Ù‚Ø¯Ù… Ù„Ùƒ Ù…Ù†ØªØ¬Ø§Øª Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¬ÙˆØ¯Ø© Ø¨Ø£Ø³Ø¹Ø§Ø± Ù…Ù†Ø§ÙØ³Ø©. Ø¨Ø®Ø¨Ø±ØªÙ†Ø§ Ø§Ù„Ù…Ù…ØªØ¯Ø© Ù„Ø³Ù†ÙˆØ§Øª ÙÙŠ Ø§Ù„Ù…Ø¬Ø§Ù„ØŒ Ù†ÙˆÙØ± Ù„Ùƒ Ø£ÙØ¶Ù„ Ø§Ù„Ø£Ø¯ÙˆØ§Øª ÙˆØ§Ù„Ù…Ø§Ø±ÙƒØ§Øª Ø§Ù„Ù…Ø¶Ù…ÙˆÙ†Ø©ØŒ Ù„Ø£Ù† Ø§Ù„Ø«Ù‚Ø© Ø¨Ø§Ù„Ù†Ø³Ø¨Ø© Ù„Ù†Ø§ Ù„ÙŠØ³Øª Ø®ÙŠØ§Ø±Ù‹Ø§ØŒ Ø¨Ù„ Ù‡ÙŠ Ø£Ø³Ø§Ø³ Ø¹Ù…Ù„Ù†Ø§."
                            </p>
                            <p class="text-base sm:text-lg text-gray-600 dark:text-gray-300 leading-relaxed">
                                Ù†Ø­Ù† Ù„Ø§ Ù†Ø¨ÙŠØ¹ Ù…Ù†ØªØ¬Ø§Øª ÙØ­Ø³Ø¨ØŒ Ø¨Ù„ Ù†Ù‚Ø¯Ù… Ø­Ù„ÙˆÙ„Ø§Ù‹ Ù…ØªÙƒØ§Ù…Ù„Ø© ØªØ´Ù…Ù„ Ø§Ù„ØªÙˆØ±ÙŠØ¯ ÙˆØ§Ù„ØªØ±ÙƒÙŠØ¨ Ù„Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„Ø³ÙƒÙ†ÙŠØ© ÙˆØ§Ù„ØªØ¬Ø§Ø±ÙŠØ©ØŒ Ø¨ÙØ±ÙŠÙ‚ ÙÙ†ÙŠ Ù…ØªØ®ØµØµ ÙŠØ¶Ù…Ù† Ù„Ùƒ Ø§Ù„Ø£Ù…Ø§Ù† ÙˆØ§Ù„Ø¬ÙˆØ¯Ø©.
                            </p>
                        </div>
                        <div>
                            <h2 class="text-3xl font-bold mb-4 lg:hidden">ØµÙˆØ± Ù…Ù† Ø§Ù„Ù…ØªØ¬Ø±</h2> <!-- Show title on mobile -->
                            <div class="grid grid-cols-2 gap-4">
                                <img src="https://i.postimg.cc/NfqhM3Th/photo-2025-10-28-14-04-33.jpg" onerror="this.src='https://placehold.co/600x400/555555/ffffff?text=Ø§Ù„Ù…ØªØ¬Ø±+Ù…Ù†+Ø§Ù„Ø¯Ø§Ø®Ù„+1'" alt="Ø§Ù„Ù…ØªØ¬Ø± Ù…Ù† Ø§Ù„Ø¯Ø§Ø®Ù„ 1" class="w-full h-48 object-cover rounded-lg shadow-md">
                                <img src="https://i.postimg.cc/bNjM8Qck/photo-2025-10-28-14-05-51.jpg" onerror="this.src='https://placehold.co/600x400/555555/ffffff?text=Ø§Ù„Ù…ØªØ¬Ø±+Ù…Ù†+Ø§Ù„Ø¯Ø§Ø®Ù„+2'" alt="Ø§Ù„Ù…ØªØ¬Ø± Ù…Ù† Ø§Ù„Ø¯Ø§Ø®Ù„ 2" class="w-full h-48 object-cover rounded-lg shadow-md">
                                <img src="https://wl-img-prd.s3-accelerate.amazonaws.com/940aa6b6-b49b-492b-8b88-a6680cb25b6c-h.jpeg" onerror="this.src='https://placehold.co/600x400/555555/ffffff?text=ÙØ±ÙŠÙ‚+Ø§Ù„Ø¹Ù…Ù„'" alt="ÙØ±ÙŠÙ‚ Ø§Ù„Ø¹Ù…Ù„" class="w-full h-48 object-cover rounded-lg shadow-md col-span-2">
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="page-blog" class="page-section pt-8">
                
                <div class="flex justify-between items-center mb-8">
                    <h1 class="text-3xl sm:text-4xl font-bold text-center sm:text-right">Ù…Ø¯ÙˆÙ†Ø© ÙˆÙ†ØµØ§Ø¦Ø­ ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©</h1>
                    <button id="show-add-article-modal-btn" type="button" class="hidden items-center justify-center sm:justify-start gap-2 px-4 py-3 bg-[#ffcd00] text-gray-900 font-bold text-sm rounded-lg shadow-lg hover:bg-[#ffda33] flex-shrink-0">
                        <i data-lucide="plus-circle" class="w-4 h-4"></i>
                        <span>Ø¥Ø¶Ø§ÙØ© Ù…Ù‚Ø§Ù„Ø©</span>
                    </button>
                </div>

                <div id="blog-grid" class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="card-hover bg-white dark:bg-[#2c2f38] rounded-xl shadow-lg overflow-hidden">
                        <div class="p-4 animate-pulse">
                            <div class="w-full h-40 bg-gray-200 dark:bg-gray-700 rounded-md"></div>
                            <div class="w-3/4 h-5 bg-gray-200 dark:bg-gray-700 rounded-md mt-3"></div>
                            <div class="w-full h-4 bg-gray-200 dark:bg-gray-700 rounded-md mt-4"></div>
                            <div class="w-1/4 h-4 bg-gray-200 dark:bg-gray-700 rounded-md mt-4"></div>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="page-contact" class="page-section space-y-12 pt-8">
                
                <h1 class="text-3xl sm:text-4xl font-bold text-center mb-4">ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</h1>
                <p class="text-xl text-gray-600 dark:text-gray-300 text-center max-w-2xl mx-auto">
                    Ù†Ø­Ù† Ù‡Ù†Ø§ Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ. Ø³ÙˆØ§Ø¡ ÙƒØ§Ù† Ù„Ø¯ÙŠÙƒ Ø³Ø¤Ø§Ù„ Ø¹Ù† Ù…Ù†ØªØ¬ØŒ Ø£Ùˆ ØªØ­ØªØ§Ø¬ Ø®Ø¯Ù…Ø© ØªØ±ÙƒÙŠØ¨ØŒ ÙØ±ÙŠÙ‚Ù†Ø§ Ø¬Ø§Ù‡Ø² Ù„Ù„Ø±Ø¯.
                </p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="bg-white dark:bg-[#2c2f38] p-6 rounded-xl shadow-lg text-center transform transition-all duration-300 hover:-translate-y-1">
                        <i data-lucide="map-pin" class="w-12 h-12 text-[#ffcd00] mx-auto mb-4"></i>
                        <h3 class="text-xl font-semibold mb-2">Ø¹Ù†ÙˆØ§Ù†Ù†Ø§</h3>
                        <p class="text-gray-600 dark:text-gray-300">
                            Ø§Ù„Ù…Ù‚Ø·Ù…ØŒ Ø´Ø§Ø±Ø¹ Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ù†ÙˆØ±Ø©ØŒ Ù…ØªÙØ±Ø¹ Ù…Ù† Ø´Ø§Ø±Ø¹ 9ØŒ Ø£Ù…Ø§Ù… Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ø±Ø§Ø¹ÙŠ Ø§Ù„ØµØ§Ù„Ø­ØŒ Ù‚Ø·Ø¹Ø© 7987.
                        </p>
                    </div>
                    <div class="bg-white dark:bg-[#2c2f38] p-6 rounded-xl shadow-lg text-center transform transition-all duration-300 hover:-translate-y-1">
                        <i data-lucide="phone" class="w-12 h-12 text-[#ffcd00] mx-auto mb-4"></i>
                        <h3 class="text-xl font-semibold mb-2">Ø§ØªØµÙ„ Ø¨Ù†Ø§</h3>
                        <div class="text-gray-600 dark:text-gray-300" dir="ltr">
                            <a href="tel:0225071272" class="block hover:text-[#ffda33] transition-colors">0225071272 (Ù‡Ø§ØªÙ Ø§Ù„Ù…ØªØ¬Ø±)</a>
                            <a href="https://wa.me/201146641942" class="block hover:text-[#ffda33] transition-colors">01146641942 (ÙˆØ§ØªØ³Ø§Ø¨)</a>
                        </div>
                    </div>
                    <div class="bg-white dark:bg-[#2c2f38] p-6 rounded-xl shadow-lg text-center transform transition-all duration-300 hover:-translate-y-1">
                        <i data-lucide="clock" class="w-12 h-12 text-[#ffcd00] mx-auto mb-4"></i>
                        <h3 class="text-xl font-semibold mb-2">Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„</h3>
                        <p class="text-gray-600 dark:text-gray-300">
                            Ø§Ù„Ø³Ø¨Øª - Ø§Ù„Ø®Ù…ÙŠØ³
                            <br>
                            9:00 ØµØ¨Ø§Ø­Ø§Ù‹ - 11:00 Ù…Ø³Ø§Ø¡Ù‹
                        </p>
                    </div>
                </div>
                

                <div class="bg-white dark:bg-[#2c2f38] p-6 sm:p-8 rounded-xl shadow-lg max-w-6xl mx-auto">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
                        <form id="contact-form" class="space-y-6">
                            <h3 class="text-2xl font-semibold mb-3">Ø£Ø±Ø³Ù„ Ù„Ù†Ø§ Ø±Ø³Ø§Ù„Ø©</h3>
                            <div>
                                <label for="name" class="block text-sm font-medium mb-1">Ø§Ù„Ø§Ø³Ù…</label>
                                <input type="text" id="name" name="name" required class="w-full px-4 py-3 rounded-lg bg-gray-100 dark:bg-[#3d474e] border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00]" placeholder="Ø§Ø³Ù…Ùƒ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„">
                            </div>
                            <div>
                                <label for="phone" class="block text-sm font-medium mb-1">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
                                <input type="tel" id="phone" name="phone" required class="w-full px-4 py-3 rounded-lg bg-gray-100 dark:bg-[#3d474e] border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00]" placeholder="01xxxxxxxxx">
                            </div>
                            <div>
                                <label for="message" class="block text-sm font-medium mb-1">Ø§Ù„Ø±Ø³Ø§Ù„Ø©</label>
                                <textarea id="message" name="message" rows="5" required class="w-full px-4 py-3 rounded-lg bg-gray-100 dark:bg-[#3d474e] border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00]" placeholder="ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†Ø§ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒØŸ"></textarea>
                            </div>
                            <button type="submit" class="w-full px-6 py-3 bg-[#ffcd00] text-gray-900 font-bold rounded-lg shadow-md hover:bg-[#ffda33] transition-colors">
                                Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©
                            </button>
                            <div id="form-success-message" class="hidden text-green-500 font-medium text-center">
                                ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„ØªÙƒ Ø¨Ù†Ø¬Ø§Ø­!
                            </div>
                        </form>
                        
                        <div class="space-y-6">
                             <h3 class="text-2xl font-semibold mb-3">Ù…ÙˆÙ‚Ø¹Ù†Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø©</h3>
                            <div class="aspect-w-16 aspect-h-9 rounded-lg overflow-hidden shadow-md h-full min-h-[400px]">
                                <iframe 
                                    src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d55276.0159441113!2d31.27210741164801!3d30.00350917260086!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x1458380b09995129%3A0x6a05d34f0c476f0!2sMokattam%2C%2C%20Cairo%20Governorate%2C%20Egypt!5e0!3m2!1sen!2sus!4v1678886500000!5m2!1sen!2sus" 
                                    width="100%" 
                                    height="100%" 
                                    style="border:0;" 
                                    allowfullscreen="" 
                                    loading="lazy" 
                                    referrerpolicy="no-referrer-when-downgrade">
                                </iframe>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="page-blog-post" class="page-section pt-8">
                
                <div class="bg-white dark:bg-[#2c2f38] p-6 sm:p-10 rounded-xl shadow-lg max-w-4xl mx-auto">
                    <a href="#blog" class="nav-link font-medium text-[#ffcd00] hover:text-[#ffda33] mb-6 inline-block" data-page="blog">&larr; Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ø¯ÙˆÙ†Ø©</a>
                    <h1 id="blog-post-title" class="text-3xl sm:text-4xl font-bold mb-6">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</h1>
                    <img class="w-full h-64 object-cover rounded-lg shadow-md mb-8" 
                         id="blog-post-image"
                         src="https://placehold.co/800x400/eeeeee/777777?text=Ø¬Ø§Ø±ÙŠ+ØªØ­Ù…ÙŠÙ„+Ø§Ù„ØµÙˆØ±Ø©" 
                         onerror="this.src='https://placehold.co/800x400/eeeeee/777777?text=Image+Not+Found'" 
                         alt="ØµÙˆØ±Ø© Ø§Ù„Ù…Ù‚Ø§Ù„Ø©">
                    <div id="blog-post-content-wrapper" class="prose prose-lg dark:prose-invert max-w-none text-gray-700 dark:text-gray-300 leading-relaxed space-y-4">
                        <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰...</p>
                    </div>
                </div>
            </section>
            
            <section id="page-blog-2" class="page-section hidden">
            </section>
            
            <section id="page-blog-3" class="page-section hidden">
            </section>
            
            <section id="page-blog-4" class="page-section hidden">
            </section>

            
            <section id="page-cart" class="page-section pt-8">
                
                <div class="flex items-center gap-3 mb-8">
                    <i data-lucide="shopping-cart" class="w-8 h-8 sm:w-10 sm:h-10 text-[#ffcd00]"></i>
                    <h1 class="text-3xl sm:text-4xl font-bold">Ø³Ù„Ø© Ù…Ø´ØªØ±ÙŠØ§ØªÙƒ</h1>
                </div>
                
                <div class="bg-white dark:bg-[#2c2f38] p-6 sm:p-8 rounded-xl shadow-lg">
                    <div id="cart-items-container" class="space-y-6">
                        
                    </div>

                    <div id="cart-empty-message" class="text-center py-12 hidden">
                        <i data-lucide="shopping-cart" class="w-16 h-16 mx-auto text-gray-400"></i>
                        <h2 class="text-2xl font-semibold mt-4">Ø³Ù„Ù‘ØªÙƒ ÙØ§Ø±ØºØ©</h2>
                        <p class="text-gray-500 dark:text-gray-400 mt-2">ÙŠØ¨Ø¯Ùˆ Ø£Ù†Ùƒ Ù„Ù… ØªÙ‚Ù… Ø¨Ø¥Ø¶Ø§ÙØ© Ø£ÙŠ Ù…Ù†ØªØ¬Ø§Øª Ù„Ø³Ù„ØªÙƒ Ø¨Ø¹Ø¯.</p>
                        <a href="#products" class="nav-link mt-6 inline-flex items-center gap-2 px-6 py-3 bg-[#ffcd00] text-gray-900 font-bold rounded-lg shadow-lg hover:bg-[#ffda33]" data-page="products">
                            <i data-lucide="arrow-left" class="w-5 h-5"></i>
                            <span>Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ³ÙˆÙ‚</span>
                        </a>
                    </div>

                    <div id="cart-summary" class="mt-8 border-t border-gray-200 dark:border-gray-700 pt-6 hidden">
                        <div class="flex justify-end">
                            <div class="w-full md:w-1/3">
                                <div class="flex justify-between text-lg font-medium">
                                    <span>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ:</span>
                                    <span id="cart-subtotal">0.00 EGP</span>
                                </div>
                                <div class="flex justify-between text-sm text-gray-500 dark:text-gray-400 mt-2">
                                    <span>Ø§Ù„Ø´Ø­Ù†:</span>
                                    <span>ÙŠÙØ­Ø³Ø¨ Ø¹Ù†Ø¯ Ø§Ù„Ø¯ÙØ¹</span>
                                </div>
                                <div class="flex justify-between text-2xl font-bold mt-4">
                                    <span>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:</span>
                                    <span id="cart-total">0.00 EGP</span>
                                </div>
                                <button id="whatsapp-checkout-btn" class="flex items-center justify-center gap-2 w-full px-6 py-3 bg-green-500 text-white font-bold rounded-lg shadow-md hover:bg-green-400 transition-colors mt-6">
                                    <i data-lucide="check-circle" class="w-5 h-5"></i>
                                    <span>Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨ (Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨)</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

          
            <section id="page-admin" class="page-section pt-8">
                <h1 class="text-3xl sm:text-4xl font-bold mb-8">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h1>
                
                <div class="bg-white dark:bg-[#2c2f38] p-6 sm:p-8 rounded-xl shadow-lg max-w-2xl mx-auto">
                    <form id="admin-settings-form" class="space-y-6">
                        <h2 class="text-2xl font-semibold mb-4">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¨Ø§Ù†Ø± Ø§Ù„Ø¹Ù„ÙˆÙŠ</h2>
                        
                        <div>
                            <label for="admin-light-banner-url" class="block text-sm font-medium mb-1">Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ø§Ù„Ø¨Ø§Ù†Ø± (Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„ÙØ§ØªØ­)</label>
                            <input type="url" id="admin-light-banner-url" class="w-full px-4 py-3 rounded-lg bg-gray-100 dark:bg-[#3d474e] border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00]" placeholder="https://example.com/light-banner.jpg">
                        </div>
                        
                        <div>
                            <label for="admin-dark-banner-url" class="block text-sm font-medium mb-1">Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ø§Ù„Ø¨Ø§Ù†Ø± (Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¯Ø§ÙƒÙ†)</label>
                            <input type="url" id="admin-dark-banner-url" class="w-full px-4 py-3 rounded-lg bg-gray-100 dark:bg-[#3d474e] border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00]" placeholder="https://example.com/dark-banner.jpg">
                        </div>

                        <hr class="border-gray-200 dark:border-gray-700">
        
                        <h2 class="text-2xl font-semibold mb-4">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</h2>
                        
                        <!-- Ø¥Ø¶Ø§ÙØ© Ù‚Ø§Ø¦Ù…Ø© Ù…Ù†Ø³Ø¯Ù„Ø© Ù„Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù†ÙˆØ¹ -->
                        <div>
                            <label for="admin-hero-type" class="block text-sm font-medium mb-1">Ù†ÙˆØ¹ Ø®Ù„ÙÙŠØ© Ø§Ù„Ù‡ÙŠØ±Ùˆ</label>
                            <select id="admin-hero-type" class="w-full px-4 py-3 rounded-lg bg-gray-100 dark:bg-[#3d474e] border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00]">
                                <option value="video">ÙÙŠØ¯ÙŠÙˆ</option>
                                <option value="image">ØµÙˆØ±Ø©</option>
                            </select>
                        </div>

                        <!-- Ø­Ø§ÙˆÙŠØ© Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ -->
                        <div id="admin-video-url-container">
                            <label for="admin-video-url" class="block text-sm font-medium mb-1">Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ (mp4)</label>
                            <input type="url" id="admin-video-url" class="w-full px-4 py-3 rounded-lg bg-gray-100 dark:bg-[#3d474e] border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00]" placeholder="https://example.com/video.mp4">
                        </div>
                        
                        <!-- Ø­Ø§ÙˆÙŠØ© Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© (Ù…Ø®ÙÙŠØ© Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹) -->
                        <div id="admin-image-url-container" class="hidden">
                            <label for="admin-image-url" class="block text-sm font-medium mb-1">Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© (jpg/png/webp)</label>
                            <input type="url" id="admin-image-url" class="w-full px-4 py-3 rounded-lg bg-gray-100 dark:bg-[#3d474e] border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00]" placeholder="https://example.com/image.jpg">
                        </div>
                        
                        <button type="submit" id="save-admin-settings-btn" class="w-full px-6 py-3 bg-[#ffcd00] text-gray-900 font-bold rounded-lg shadow-md hover:bg-[#ffda33] transition-colors">
                            Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
                        </button>
                    </form>
                </div>
            </section>
           
            
            <!-- NEW: Terms of Use Page Section -->
            <section id="page-terms" class="page-section pt-8">
                <!-- Modern Header -->
                <div class="flex items-center gap-3 mb-8">
                    <i data-lucide="shield" class="w-8 h-8 sm:w-10 sm:h-10 text-[#ffcd00]"></i>
                    <h1 class="text-3xl sm:text-4xl font-bold">Ø´Ø±ÙˆØ· Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙˆØ³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©</h1>
                </div>

                <!-- Content Body -->
                <div class="text-gray-700 dark:text-gray-300 leading-relaxed space-y-6">
                    <!-- Constrain the text width for readability -->
                    <div class="prose prose-lg dark:prose-invert max-w-4xl text-right text-gray-700 dark:text-gray-300 leading-relaxed space-y-6">
                        <h2>Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù…ØªØ¬Ø± Ù…ÙƒØ©</h2>
                        <p>Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù…Ùƒ Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆÙ‚Ø¹ØŒ ÙØ¥Ù†Ùƒ ØªÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ø£Ø­ÙƒØ§Ù… Ø§Ù„ØªØ§Ù„ÙŠØ©. ÙŠØ±Ø¬Ù‰ Ù‚Ø±Ø§Ø¡ØªÙ‡Ø§ Ø¨Ø¹Ù†Ø§ÙŠØ©.</p>
                        
                        <h3>1. Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹</h3>
                        <p>ÙŠØ¬Ø¨ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù„Ø£ØºØ±Ø§Ø¶ Ù…Ø´Ø±ÙˆØ¹Ø© ÙÙ‚Ø·. ÙŠÙÙ…Ù†Ø¹ Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ ÙÙŠ Ø£ÙŠ Ù†Ø´Ø§Ø· Ù‚Ø¯ ÙŠØ´ÙƒÙ„ Ø§Ù†ØªÙ‡Ø§ÙƒÙ‹Ø§ Ù„Ù„Ù‚ÙˆØ§Ù†ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠØ© Ø£Ùˆ Ø§Ù„Ø¯ÙˆÙ„ÙŠØ©.</p>
                        
                        <h3>2. Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆØ§Ù„Ø£Ø³Ø¹Ø§Ø±</h3>
                        <p>Ù†Ø­Ù† Ù†Ø³Ø¹Ù‰ Ø¬Ø§Ù‡Ø¯ÙŠÙ† Ù„Ø¶Ù…Ø§Ù† Ø¯Ù‚Ø© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆØ§Ù„Ø£Ø³Ø¹Ø§Ø±ØŒ ÙˆÙ„ÙƒÙ† Ù‚Ø¯ ØªØ­Ø¯Ø« Ø£Ø®Ø·Ø§Ø¡. Ù†Ø­ØªÙØ¸ Ø¨Ø§Ù„Ø­Ù‚ ÙÙŠ ØªØµØ­ÙŠØ­ Ø£ÙŠ Ø£Ø®Ø·Ø§Ø¡ ÙˆØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ÙÙŠ Ø£ÙŠ ÙˆÙ‚Øª Ø¯ÙˆÙ† Ø¥Ø´Ø¹Ø§Ø± Ù…Ø³Ø¨Ù‚. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ø¨Ø§Ù„Ø¬Ù†ÙŠÙ‡ Ø§Ù„Ù…ØµØ±ÙŠ.</p>
                        
                        <h3>3. Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h3>
                        <p>ØªØ¹ØªÙ…Ø¯ Ø¹Ù…Ù„ÙŠØ© Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨ Ø¹Ù„Ù‰ ØªÙˆÙØ± Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª. Ø­Ø§Ù„ÙŠÙ‹Ø§ØŒ ÙŠØªÙ… Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙˆØªØ£ÙƒÙŠØ¯Ù‡Ø§ Ø¹Ø¨Ø± Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± (Ù…Ø«Ù„ ÙˆØ§ØªØ³Ø§Ø¨) Ø¨Ø¹Ø¯ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ù…Ø¨Ø¯Ø¦ÙŠØ© Ù…Ù† Ø§Ù„Ù…ÙˆÙ‚Ø¹.</p>

                        <h3>4. Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©</h3>
                        <p>Ù†Ø­Ù† Ù†Ø­ØªØ±Ù… Ø®ØµÙˆØµÙŠØªÙƒ. Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙŠ Ù†Ø¬Ù…Ø¹Ù‡Ø§ (Ù…Ø«Ù„ Ø¹Ù†Ø¯ Ø§Ø³ØªØ®Ø¯Ø§Ù… "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø­Ø³Ø§Ø¨ Ø¬ÙˆØ¬Ù„") ØªÙØ³ØªØ®Ø¯Ù… ÙÙ‚Ø· Ù„Ø¥Ø¯Ø§Ø±Ø© Ø­Ø³Ø§Ø¨Ùƒ ÙˆØªØ³Ù‡ÙŠÙ„ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø·Ù„Ø¨. Ù†Ø­Ù† Ù„Ø§ Ù†Ø´Ø§Ø±Ùƒ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø§Ù„Ø´Ø®ØµÙŠØ© Ù…Ø¹ Ø£Ø·Ø±Ø§Ù Ø«Ø§Ù„Ø«Ø© Ø¯ÙˆÙ† Ù…ÙˆØ§ÙÙ‚ØªÙƒ.</p>

                        <h3>5. Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ (AI)</h3>
                        <p>Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ Ù…ØªÙˆÙØ± Ù„ØªÙ‚Ø¯ÙŠÙ… Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ù† Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆÙ†ØµØ§Ø¦Ø­ Ø¹Ø§Ù…Ø©. Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ù‚Ø¯Ù…Ø© Ù…Ù† Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ Ù‡ÙŠ Ù„Ø£ØºØ±Ø§Ø¶ Ø¥Ø±Ø´Ø§Ø¯ÙŠØ© ÙˆÙ‚Ø¯ Ù„Ø§ ØªÙƒÙˆÙ† Ø¯Ù‚ÙŠÙ‚Ø© Ø¨Ù†Ø³Ø¨Ø© 100%. Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªØ£ÙƒÙŠØ¯ Ù†Ù‡Ø§Ø¦ÙŠ Ø¨Ø®ØµÙˆØµ Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª Ø£Ùˆ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ ÙØ±ÙŠÙ‚Ù†Ø§ Ù…Ø¨Ø§Ø´Ø±Ø©.</p>
                        
                        <h3>6. Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù…Ù„ÙƒÙŠØ© Ø§Ù„ÙÙƒØ±ÙŠØ©</h3>
                        <p>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆÙ‚Ø¹ØŒ Ø¨Ù…Ø§ ÙÙŠ Ø°Ù„Ùƒ Ø§Ù„Ù†ØµÙˆØµØŒ Ø§Ù„Ø±Ø³ÙˆÙ…Ø§ØªØŒ Ø§Ù„Ø´Ø¹Ø§Ø±Ø§ØªØŒ ÙˆØ§Ù„ØµÙˆØ±ØŒ Ù‡ÙŠ Ù…Ù„Ùƒ Ù„Ù€ "Ù…ØªØ¬Ø± Ù…ÙƒØ©" ÙˆÙ…Ø­Ù…ÙŠØ© Ø¨Ù…ÙˆØ¬Ø¨ Ù‚ÙˆØ§Ù†ÙŠÙ† Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù†Ø´Ø±.</p>

                        <h3>7. Ø·Ø±Ù‚ Ø§Ù„Ø¯ÙØ¹</h3>
                        <p>Ù†Ø­Ù† Ù†Ù‚Ø¨Ù„ Ø­Ø§Ù„ÙŠÙ‹Ø§ Ø·Ø±Ù‚ Ø§Ù„Ø¯ÙØ¹ Ø§Ù„ØªØ§Ù„ÙŠØ©:</p>
                        
                        <!-- NEW: Modern Payment Methods Section -->
                        <div class="not-prose my-8 grid grid-cols-2 md:grid-cols-4 gap-3 sm:gap-4">
                            <!-- Cash -->
                            <div class="bg-gray-50 dark:bg-gray-800/50 p-4 rounded-xl flex flex-col items-center justify-center text-center border border-gray-200 dark:border-gray-700 min-h-[120px]">
                                <i data-lucide="wallet" class="w-10 h-10 text-green-600 dark:text-green-400 mb-2"></i>
                                <span class="text-sm font-semibold text-gray-800 dark:text-white">Ù†Ù‚Ø¯ÙŠ</span>
                                <span class="text-xs text-gray-500 dark:text-gray-400">Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…</span>
                            </div>
                            <!-- Vodafone Cash -->
                            <div class="bg-gray-50 dark:bg-gray-800/50 p-4 rounded-xl flex flex-col items-center justify-center text-center border border-gray-200 dark:border-gray-700 min-h-[120px]">
                                <img src="https://upload.wikimedia.org/wikipedia/commons/a/a6/Vodafone_Cash_logo.svg" alt="Vodafone Cash" class="w-auto h-10 mb-2" onerror="this.style.display='none'">
                                <span class="text-sm font-semibold text-gray-800 dark:text-white">ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´</span>
                                <span class="text-xs text-gray-500 dark:text-gray-400">Vodafone Cash</span>
                            </div>
                            <!-- InstaPay -->
                            <div class="bg-gray-50 dark:bg-gray-800/50 p-4 rounded-xl flex flex-col items-center justify-center text-center border border-gray-200 dark:border-gray-700 min-h-[120px]">
                                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f4/InstaPay_logo.svg/512px-InstaPay_logo.svg.png" alt="InstaPay" class="w-9 h-9 mb-2 rounded" onerror="this.style.display='none'">
                                <span class="text-sm font-semibold text-gray-800 dark:text-white">Ø§Ù†Ø³ØªØ§ Ø¨Ø§ÙŠ</span>
                                <span class="text-xs text-gray-500 dark:text-gray-400">InstaPay</span>
                            </div>
                            <!-- Visa (Disabled) -->
                            <div class="bg-gray-50 dark:bg-gray-800/50 p-4 rounded-xl flex flex-col items-center justify-center text-center border border-gray-200 dark:border-gray-700 min-h-[120px] opacity-60">
                                <img src="https://upload.wikimedia.org/wikipedia/commons/5/5e/Visa_Inc._logo.svg" alt="Visa" class="w-auto h-7 mb-2" onerror="this.style.display='none'">
                                <span class="text-sm font-semibold text-gray-800 dark:text-white">ÙÙŠØ²Ø§</span>
                                <span class="text-xs text-gray-500 dark:text-gray-400">Ù…ØªÙˆÙ‚ÙØ© Ù…Ø¤Ù‚ØªØ§Ù‹</span>
                            </div>
                        </div>
                        <!-- END: Modern Payment Methods Section -->


                        <h3>8. Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø¥Ø³ØªØ±Ø¬Ø§Ø¹ ÙˆØ­Ù…Ø§ÙŠØ© Ø§Ù„Ù…Ø³ØªÙ‡Ù„Ùƒ</h3>
                        <p>Ù†Ø­Ù† Ù†Ù„ØªØ²Ù… Ø¨Ù‚Ø§Ù†ÙˆÙ† Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù…Ø³ØªÙ‡Ù„Ùƒ Ø§Ù„Ù…ØµØ±ÙŠ. ÙŠØ­Ù‚ Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø®Ù„Ø§Ù„ 14 ÙŠÙˆÙ…Ù‹Ø§ Ù…Ù† ØªØ§Ø±ÙŠØ® Ø§Ù„Ø´Ø±Ø§Ø¡ØŒ Ø¨Ø´Ø±Ø· Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ø­Ø§Ù„ØªÙ‡ Ø§Ù„Ø£ØµÙ„ÙŠØ© ÙˆÙ„Ù… ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡.</p>
                        <p>ÙÙŠ Ø­Ø§Ù„Ø© ÙˆØ¬ÙˆØ¯ Ø£ÙŠ Ø´ÙƒÙˆÙ‰ Ø£Ùˆ Ù„Ù„Ø§Ø³ØªÙØ³Ø§Ø± Ø¹Ù† Ø­Ù‚ÙˆÙ‚Ùƒ ÙƒÙ…Ø³ØªÙ‡Ù„ÙƒØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¨Ø§Ø´Ø±Ø© Ù…Ø¹ Ø¬Ù‡Ø§Ø² Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù…Ø³ØªÙ‡Ù„Ùƒ:</p>
                        <ul>
                            <li><strong>Ø§Ù„Ø®Ø· Ø§Ù„Ø³Ø§Ø®Ù†:</strong> 19588</li>
                            <li><strong>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:</strong> info@cpa.gov.eg</li>
                            <li><strong>ÙˆØ§ØªØ³Ø§Ø¨:</strong> 01577779999 - 01000000329</li>
                            <li><strong>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</strong> Ø´ Ø§Ù„ØªØ³Ø¹ÙŠÙ† - Ø§Ù„ØªØ¬Ù…Ø¹ Ø§Ù„Ø®Ø§Ù…Ø³ - Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©</li>
                            <li><strong>Ø£Ø±Ù‚Ø§Ù… Ø§Ù„ØªÙ„ÙŠÙÙˆÙ†:</strong> 33055796 - 33055795 - 33055768 - 33055797 - 33055762 - 33055765</li>
                            <li><strong>ÙØ§ÙƒØ³:</strong> 33055753</li>
                        </ul>
                    </div>
                </div>
            </section>
            
        </main>

        <footer class="bg-white dark:bg-[#2c2f38] border-t border-gray-200 dark:border-gray-700 mt-12">
            
            <div class="px-4 sm:px-6 lg:px-8 py-8">
                <div class="flex flex-col lg:flex-row justify-between gap-10">
                    <div class="lg:w-2/5 text-center lg:text-right">
                        <a href="#home" class="nav-link inline-block" data-page="home">
                            <span class="text-2xl sm:text-3xl font-bold text-[#ffcd00]">Ù…ØªØ¬Ø± Ù…ÙƒØ©</span>
                        </a>
                        <p class="mt-4 text-sm text-gray-600 dark:text-gray-300 max-w-sm mx-auto lg:mx-0">
                            Ù…ØªØ¬Ø± Ù…ÙƒØ©: ÙƒÙ„ Ù…Ø§ Ù‡Ùˆ Ø¬Ø¯ÙŠØ¯ ÙÙŠ Ø¹Ø§Ù„Ù… Ø§Ù„Ø¯ÙŠÙƒÙˆØ± Ø§Ù„Ø­Ø¯ÙŠØ« ÙˆØ§Ù„Ø¥Ø¶Ø§Ø¡Ø©. Ø£ÙƒØ«Ø± Ù…Ù† 20 Ø¹Ø§Ù…Ù‹Ø§ Ù…Ù† Ø§Ù„Ø®Ø¨Ø±Ø©.
                        </p>
                    </div>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-8 lg:w-3/5">
                        <div class="text-center sm:text-right">
                            <h3 class="text-base sm:text-lg font-semibold text-gray-900 dark:text-white mb-4">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</h3>
                            <ul class="space-y-3 text-sm">
                                <li>
                                    <a href="#terms" data-page="terms" class="nav-link inline-flex items-center gap-2 text-gray-600 dark:text-gray-300 hover:text-[#ffcd00]">
                                        <i data-lucide="shield" class="w-4 h-4 text-[#ffcd00] flex-shrink-0"></i>
                                        <span>Ø´Ø±ÙˆØ· Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</span>
                                    </a>
                                </li>
                                <li>
                                    <a href="#" id="open-help-modal-btn" class="inline-flex items-center gap-2 text-gray-600 dark:text-gray-300 hover:text-[#ffcd00]">
                                        <i data-lucide="help-circle" class="w-4 h-4 text-[#ffcd00] flex-shrink-0"></i>
                                        <span>Ù…Ø³Ø§Ø¹Ø¯Ø©</span>
                                    </a>
                                </li>
                            </ul>
                        </div>
                        <div class="text-center sm:text-right">
                            <h3 class="text-base sm:text-lg font-semibold text-gray-900 dark:text-white mb-4">Ø§ØªØµÙ„ Ø¨Ù†Ø§</h3>
                            <ul class="space-y-3 text-sm text-gray-600 dark:text-gray-300">
                                <li class="flex items-start gap-3 justify-center sm:justify-start">
                                    <i data-lucide="phone" class="w-4 h-4 text-[#ffcd00] flex-shrink-0 mt-1"></i>
                                    <a href="tel:0225071272" class="hover:text-[#ffda33]" dir="ltr">0225071272 (Ø§Ù„Ù…ØªØ¬Ø±)</a>
                                </li>
                                <li class="flex items-start gap-3 justify-center sm:justify-start">
                                    <i data-lucide="smartphone" class="w-4 h-4 text-[#ffcd00] flex-shrink-0 mt-1"></i>
                                    <a href="https://wa.me/201146641942" class="hover:text-[#ffda33]" dir="ltr">01146641942 (ÙˆØ§ØªØ³Ø§Ø¨)</a>
                                </li>
                                <li class="flex items-start gap-3 justify-center sm:justify-start">
                                    <i data-lucide="mail" class="w-4 h-4 text-[#ffcd00] flex-shrink-0 mt-1"></i>
                                    <a href="mailto:macaelctrec@gmail.com" class="hover:text-[#ffda33]">macaelctrec@gmail.com</a>
                                </li>
                            </ul>
                        </div>
                    
                    </div>
                </div>
                
                
                <div class="border-t border-gray-200 dark:border-gray-700 mt-8 pt-6">
                    <div class="flex flex-col sm:flex-row justify-between items-center gap-4">
                        
                        <p class="text-sm text-gray-500 dark:text-gray-400 text-center sm:text-right">
                            &copy; 2025 Ù…ØªØ¬Ø± Ù…ÙƒØ© Ù„Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.
                        </p>

                        <!-- Visitor Counter Removed from Footer -->

                        <div dir="ltr" class="text-center sm:text-left">
                            <div>
                                <span class="block text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Developed By</span>
                                <span class="block text-sm font-semibold text-gray-900 dark:text-white">Badr Ibrahim &amp; Mostafa Mahmoud</span>
                            </div>
                            <div class="flex items-center justify-center sm:justify-start gap-2 mt-2">
                                <a href="tel:01069913150" 
                                   class="group p-2 bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400 rounded-full transition-all duration-300 hover:bg-[#ffcd00] hover:text-gray-900 hover:scale-110 hover:shadow-md"
                                   title="Call 01069913150">
                                    <i data-lucide="phone" class="w-4 h-4 transition-transform group-hover:rotate-12"></i>
                                    <span class="sr-only">Call</span> 
                                </a>
                                <a href="https://badre.site/" target="_blank" rel="noopener noreferrer" 
                                   class="group p-2 bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400 rounded-full transition-all duration-300 hover:bg-[#ffcd00] hover:text-gray-900 hover:scale-110 hover:shadow-md"
                                   title="Visit Website">
                                    <i data-lucide="globe" class="w-4 h-4 transition-transform group-hover:rotate-12"></i>
                                    <span class="sr-only">Website</span> 
                                </a>
                                <a href="https://www.behance.net/bdremohameed" target="_blank" rel="noopener noreferrer" 
                                   class="group p-2 bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400 rounded-full transition-all duration-300 hover:bg-[#1769ff] hover:text-white hover:scale-110 hover:shadow-md"
                                   title="Behance">
                                    <!-- Updated to a simple "B" icon -->
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-4 h-4 transition-transform group-hover:rotate-12">
                                        <path d="M3.5,20V4H10C10,4 10.56,4.1 11.33,4.4C12.1,4.7 12.76,5.16 13.33,5.79C13.89,6.42 14.17,7.17 14.17,8.04C14.17,8.81 13.92,9.53 13.42,10.19C12.92,10.85 12.15,11.38 11.13,11.77C12.36,12.09 13.33,12.69 14.04,13.56C14.75,14.43 15.1,15.44 15.1,16.58C15.1,17.67 14.78,18.58 14.15,19.31C13.5,20.04 12.7,20.56 11.73,20.88C10.76,21.19 9.89,21.33 9.13,21.33H3.5M8.35,11.21H9.65C10.41,11.21 11,11.03 11.42,10.67C11.83,10.3 12.04,9.8 12.04,9.17C12.04,8.61 11.88,8.15 11.54,7.81C11.2,7.47 10.73,7.31 10.13,7.31H8.35V11.21M8.35,18.33H10C10.68,18.33 11.24,18.15 11.65,17.77C12.06,17.39 12.27,16.88 12.27,16.21C12.27,15.5 12,14.96 11.56,14.56C11.1,14.17 10.5,13.96 9.71,13.96H8.35V18.33Z" />
                                    </svg>
                                    <span class="sr-only">Behance</span>
                                </a>
                                <a href="https://www.linkedin.com/in/bdremohameed/" target="_blank" rel="noopener noreferrer" 
                                   class="group p-2 bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400 rounded-full transition-all duration-300 hover:bg-[#0a66c2] hover:text-white hover:scale-110 hover:shadow-md"
                                   title="LinkedIn">
                                    <i data-lucide="linkedin" class="w-4 h-4 transition-transform group-hover:rotate-12"></i>
                                    <span class="sr-only">LinkedIn</span> 
                                </a>
                                <a href="https://github.com/bdremohameed" target="_blank" rel="noopener noreferrer" 
                                   class="group p-2 bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400 rounded-full transition-all duration-300 hover:bg-[#333] hover:text-white hover:scale-110 hover:shadow-md"
                                   title="GitHub">
                                    <i data-lucide="github" class="w-4 h-4 transition-transform group-hover:rotate-12"></i>
                                    <span class="sr-only">GitHub</span> 
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </footer>
        
        <!-- Scroll to top button -->
        <button id="scroll-to-top-btn" class="fixed bottom-24 right-6 z-40 bg-[#ffcd00] text-gray-900 p-3 sm:p-4 rounded-full shadow-lg transform transition-all duration-300 opacity-0 translate-y-10 pointer-events-none hover:scale-110" aria-label="Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø£Ø¹Ù„Ù‰">
            <i data-lucide="arrow-up" class="w-6 h-6 sm:w-8 sm:h-8"></i>
        </button>

        <a href="https://wa.me/201146641942" target="_blank" rel="noopener noreferrer" 
           class="whatsapp-fab fixed bottom-6 right-6 z-40 bg-green-500 text-white p-3 sm:p-4 rounded-full shadow-lg transform transition-transform hover:scale-110">
            <span class="sr-only">ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</span>
            <svg class="w-6 h-6 sm:w-8 sm:h-8" fill="currentColor" viewBox="0 0 24 24"><path d="M12.04 2C6.58 2 2.13 6.45 2.13 11.91C2.13 13.66 2.59 15.36 3.45 16.86L2.06 21.94L7.31 20.58C8.75 21.38 10.36 21.82 12.04 21.82C17.5 21.82 21.95 17.37 21.95 11.91C21.95 6.45 17.5 2 12.04 2M12.04 20.13C10.59 20.13 9.17 19.74 7.96 19L7.6 18.78L4.47 19.65L5.37 16.62L5.13 16.26C4.33 14.98 3.86 13.48 3.86 11.91C3.86 7.39 7.54 3.71 12.04 3.71C16.54 3.71 20.22 7.39 20.22 11.91C20.22 16.43 16.54 20.13 12.04 20.13M17.47 14.3C17.18 14.16 15.91 13.54 15.65 13.45C15.4 13.35 15.21 13.3 15.03 13.59C14.84 13.88 14.31 14.5 14.17 14.64C14.02 14.79 13.88 14.84 13.59 14.7C13.3 14.55 12.42 14.26 11.39 13.3C10.59 12.55 10.05 11.64 9.85 11.35C9.66 11.06 9.76 10.95 9.88 10.83C9.99 10.71 10.13 10.53 10.27 10.38C10.42 10.24 10.47 10.12 10.61 9.88C10.76 9.63 10.66 9.42 10.57 9.22C10.47 9.03 9.93 7.76 9.73 7.27C9.54 6.78 9.34 6.83 9.19 6.82C9.05 6.81 8.86 6.81 8.67 6.81C8.49 6.81 8.19 6.91 7.94 7.15C7.69 7.4 7.11 7.93 7.11 9.1C7.11 10.27 7.97 11.39 8.11 11.53C8.26 11.68 9.93 14.19 12.39 15.2C13.01 15.48 13.51 15.62 13.9 15.74C14.51 15.9 15.03 15.86 15.43 15.81C15.89 15.75 16.96 15.14 17.21 14.85C17.46 14.56 17.46 14.36 17.41 14.3Z"></path></svg>
        </a>
        
    </div>

    
    <!-- Modal Ù„Ø¥Ø¶Ø§ÙØ©/ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬ -->
    <div id="add-product-modal" class="modal hidden fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-75 backdrop-blur-sm p-4" style="animation: fadeIn 0.3s ease-out;">
        <div class="w-full max-w-3xl bg-white dark:bg-[#2c2f38] rounded-xl shadow-2xl overflow-hidden m-4 max-h-[90vh] flex flex-col">
            <div class="flex justify-between items-center p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0">
                <h2 id="modal-title" class="text-2xl font-bold">Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯</h2>
                <button id="close-add-product-modal-btn" class="p-2 text-gray-600 dark:text-gray-300 hover:text-red-500 rounded-full">
                    <i data-lucide="x" class="w-6 h-6"></i>
                </button>
            </div>
            
            <form id="add-product-form" class="p-6 sm:p-8 space-y-6 overflow-y-auto">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label for="productName" class="block text-sm font-medium mb-1">Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬</label>
                        <input type="text" id="productName" required class="w-full px-4 py-3 rounded-lg bg-gray-100 dark:bg-[#3d474e] border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00]">
                    </div>
                    <div>
                        <label for="productCategory" class="block text-sm font-medium mb-1">Ø§Ù„Ù‚Ø³Ù…</label>
                        <select id="productCategory" required class="w-full px-4 py-3 rounded-lg bg-gray-100 dark:bg-[#3d474e] border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00]">
                            <option value="Lighting">Ø¥Ø¶Ø§Ø¡Ø©</option>
                            <option value="Cables">ÙƒØ§Ø¨Ù„Ø§Øª</option>
                            <option value="Switches">Ù…ÙØ§ØªÙŠØ­</option>
                            <option value="Parts">Ù‚Ø·Ø¹ ØºÙŠØ§Ø±</option>
                            <option value="Paints">Ø¯Ù‡Ø§Ù†Ø§Øª</option>
                            <option value="Ironmongery">Ø­Ø¯Ø§ÙŠØ¯</option>
                            <option value="Other">Ø£Ø®Ø±Ù‰</option>
                        </select>
                    </div>
                </div>

                <div>
                    <label for="productImageUrls" class="block text-sm font-medium mb-1">Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ØµÙˆØ± (Ù…ÙØµÙˆÙ„Ø© Ø¨ÙØ§ØµÙ„Ø©)</label>
                    <textarea id="productImageUrls" rows="3" class="w-full px-4 py-3 rounded-lg bg-gray-100 dark:bg-[#3d474e] border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00]" placeholder="https://...image1.jpg, https://...image2.png"></textarea>
                    <p class="text-xs text-gray-500 mt-1">Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ø³ØªÙƒÙˆÙ† Ù‡ÙŠ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©.</p>
                </div>
                
                <div>
                    <label for="productDescription" class="block text-sm font-medium mb-1">Ø§Ù„ÙˆØµÙ</label>
                    <textarea id="productDescription" rows="4" class="w-full px-4 py-3 rounded-lg bg-gray-100 dark:bg-[#3d474e] border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00]"></textarea>
                </div>

                <!-- FIXED: Restored missing productPrice input and reorganized layout -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label for="productPrice" class="block text-sm font-medium mb-1">Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ (EGP)</label>
                        <input type="number" id="productPrice" step="0.01" required class="w-full px-4 py-3 rounded-lg bg-gray-100 dark:bg-[#3d474e] border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00]">
                    </div>
                    <div class="flex items-center pt-8">
                        <input type="checkbox" id="isOnSale" class="h-5 w-5 text-[#ffcd00] focus:ring-[#ffcd00] border-gray-300 rounded">
                        <label for="isOnSale" class="mr-3 text-base font-medium">ØªÙØ¹ÙŠÙ„ Ø¹Ø±Ø¶ Ø®ØµÙ…ØŸ</label>
                    </div>
                </div>

                <!-- Sale details container -->
                <div id="original-price-container" class="hidden grid grid-cols-1 md:grid-cols-2 gap-6 p-4 bg-red-50 dark:bg-red-900/10 rounded-xl border border-red-100 dark:border-red-900/30">
                    <div>
                        <label for="originalPrice" class="block text-sm font-medium mb-1">Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø£ØµÙ„ÙŠ (Ù‚Ø¨Ù„ Ø§Ù„Ø®ØµÙ…)</label>
                        <input type="number" id="originalPrice" step="0.01" class="w-full px-4 py-3 rounded-lg bg-white dark:bg-[#3d474e] border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00]">
                    </div>
                    <div>
                        <label for="saleEndDate" class="block text-sm font-medium mb-1">ØªØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø¹Ø±Ø¶ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                        <input type="datetime-local" id="saleEndDate" class="w-full px-4 py-3 rounded-lg bg-white dark:bg-[#3d474e] border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00]">
                        <p class="text-xs text-gray-500 mt-1">Ø§ØªØ±ÙƒÙ‡ ÙØ§Ø±ØºØ§Ù‹ Ù„ÙŠÙƒÙˆÙ† Ø§Ù„Ø¹Ø±Ø¶ Ø¯Ø§Ø¦Ù…Ø§Ù‹.</p>
                    </div>
                </div>
                
                <div class="flex flex-wrap items-center gap-6 p-4 bg-gray-50 dark:bg-white/5 rounded-xl">
                    <div class="flex items-center">
                        <input type="checkbox" id="isBestSeller" class="h-5 w-5 text-[#ffcd00] focus:ring-[#ffcd00] border-gray-300 rounded">
                        <label for="isBestSeller" class="mr-3 text-sm font-medium">Ù…Ù†ØªØ¬ Ø§Ù„Ø£ÙƒØ«Ø± Ù…Ø¨ÙŠØ¹Ø§Ù‹ (Ù…Ù…ÙŠØ²)</label>
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="isAvailable" checked class="h-5 w-5 text-[#ffcd00] focus:ring-[#ffcd00] border-gray-300 rounded">
                        <label for="isAvailable" class="mr-3 text-sm font-medium">Ù…ØªÙˆÙØ± Ø¨Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</label>
                    </div>
                </div>

                <hr class="border-gray-200 dark:border-gray-700">
                <h3 class="text-lg font-semibold">Ù…ÙˆØ§ØµÙØ§Øª Ø¥Ø¶Ø§ÙÙŠØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</h3>
                <div class="grid grid-cols-2 md:grid-cols-3 gap-6">
                    <div>
                        <label for="productCompany" class="block text-sm font-medium mb-1">Ø§Ù„Ø´Ø±ÙƒØ©</label>
                        <input type="text" id="productCompany" class="w-full px-4 py-3 rounded-lg bg-gray-100 dark:bg-[#3d474e] border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00]">
                    </div>
                    <div>
                        <label for="productVolts" class="block text-sm font-medium mb-1">Ø§Ù„Ø¬Ù‡Ø¯ (Volts)</label>
                        <input type="text" id="productVolts" class="w-full px-4 py-3 rounded-lg bg-gray-100 dark:bg-[#3d474e] border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00]">
                    </div>
                    <div>
                        <label for="productLength" class="block text-sm font-medium mb-1">Ø§Ù„Ø·ÙˆÙ„ (Meters)</label>
                        <input type="text" id="productLength" class="w-full px-4 py-3 rounded-lg bg-gray-100 dark:bg-[#3d474e] border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00]">
                    </div>
                    <div>
                        <label for="productWarranty" class="block text-sm font-medium mb-1">Ø§Ù„Ø¶Ù…Ø§Ù†</label>
                        <input type="text" id="productWarranty" class="w-full px-4 py-3 rounded-lg bg-gray-100 dark:bg-[#3d474e] border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00]">
                    </div>
                    <div>
                        <label for="productMadeIn" class="block text-sm font-medium mb-1">ØµÙ†Ø¹ ÙÙŠ</label>
                        <input type="text" id="productMadeIn" class="w-full px-4 py-3 rounded-lg bg-gray-100 dark:bg-[#3d474e] border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00]">
                    </div>
                    <div>
                        <label for="productModel" class="block text-sm font-medium mb-1">Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„</label>
                        <input type="text" id="productModel" class="w-full px-4 py-3 rounded-lg bg-gray-100 dark:bg-[#3d474e] border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00]">
                    </div>
                    <div>
                        <label for="productLumens" class="block text-sm font-medium mb-1">Ø§Ù„Ù„ÙˆÙ…Ù† (Lumens)</label>
                        <input type="text" id="productLumens" class="w-full px-4 py-3 rounded-lg bg-gray-100 dark:bg-[#3d474e] border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00]">
                    </div>
                    <div>
                        <label for="productLifespan" class="block text-sm font-medium mb-1">Ø§Ù„Ø¹Ù…Ø± Ø§Ù„Ø¥ÙØªØ±Ø§Ø¶ÙŠ</label>
                        <input type="text" id="productLifespan" class="w-full px-4 py-3 rounded-lg bg-gray-100 dark:bg-[#3d474e] border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00]">
                    </div>
                    <div>
                        <label for="productCurrent" class="block text-sm font-medium mb-1">Ø´Ø¯Ø© Ø§Ù„Ø³Ø­Ø¨ (Ampere)</label>
                        <input type="text" id="productCurrent" class="w-full px-4 py-3 rounded-lg bg-gray-100 dark:bg-[#3d474e] border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00]">
                    </div>
                    <div>
                        <label for="productWatt" class="block text-sm font-medium mb-1">Ø§Ù„ÙˆØ§Ø· (Watt)</label>
                        <input type="text" id="productWatt" class="w-full px-4 py-3 rounded-lg bg-gray-100 dark:bg-[#3d474e] border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00]">
                    </div>
                    <div>
                        <label for="productSizes" class="block text-sm font-medium mb-1">Ø§Ù„Ù…Ù‚Ø§Ø³Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©</label>
                        <input type="text" id="productSizes" class="w-full px-4 py-3 rounded-lg bg-gray-100 dark:bg-[#3d474e] border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00]" placeholder="Ù…Ø«Ø§Ù„: S, M, L Ø£Ùˆ 100Ø³Ù…, 200Ø³Ù…">
                    </div>
                    <!-- NEW FIELDS START HERE -->
                    <div>
                        <label for="productWeight" class="block text-sm font-medium mb-1">Ø§Ù„ÙˆØ²Ù† (kg/g)</label>
                        <input type="text" id="productWeight" class="w-full px-4 py-3 rounded-lg bg-gray-100 dark:bg-[#3d474e] border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00]">
                    </div>
                    <div>
                        <label for="productSize" class="block text-sm font-medium mb-1">Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ (cm)</label>
                        <input type="text" id="productSize" class="w-full px-4 py-3 rounded-lg bg-gray-100 dark:bg-[#3d474e] border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00]" placeholder="Ù…Ø«Ø§Ù„: 10x20x5">
                    </div>
                    <!-- NEW FIELDS END HERE -->
                </div>

                <!-- REPLACED: Old simple Colors input with new Dynamic Color Variants section -->
                <div class="mt-6">
                    <div class="flex justify-between items-center mb-2">
                        <label class="block text-sm font-medium">Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø£Ù„ÙˆØ§Ù† (ØªØ®ØµÙŠØµ)</label>
                        <button type="button" id="add-color-variant-btn" class="text-xs flex items-center gap-1 px-2 py-1 bg-[#ffcd00]/20 text-[#ffcd00] hover:bg-[#ffcd00]/30 rounded-md transition-colors">
                            <i data-lucide="plus" class="w-3 h-3"></i> Ø¥Ø¶Ø§ÙØ© Ù„ÙˆÙ†
                        </button>
                    </div>
                    <div id="color-variants-container" class="space-y-3">
                        <!-- Color rows will be added here by JS -->
                    </div>
                     <p class="text-xs text-gray-500 mt-2">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ù„ÙˆÙ† Ù„Ø§Ø®ØªÙŠØ§Ø±Ù‡ØŒ ÙˆÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© ØªØ¸Ù‡Ø± Ø¹Ù†Ø¯ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¹Ù…ÙŠÙ„ Ù„Ù‡Ø°Ø§ Ø§Ù„Ù„ÙˆÙ†.</p>
                </div>

            </form>
            <div class="flex justify-end items-center gap-4 p-6 border-t border-gray-200 dark:border-gray-700 flex-shrink-0">
                <button type="button" id="cancel-add-product-btn" class="px-6 py-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 font-medium rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600">
                    Ø¥Ù„ØºØ§Ø¡
                </button>
                <button type="submit" id="modal-submit-btn" form="add-product-form" class="px-6 py-2 bg-[#ffcd00] text-gray-900 font-bold rounded-lg shadow-md hover:bg-[#ffda33]">
                    Ø­ÙØ¸ Ø§Ù„Ù…Ù†ØªØ¬
                </button>
            </div>
        </div>
    </div>


    <!-- Terms Modal (REMOVED) -->


    <!-- New Order Details Modal -->
    <div id="order-details-modal" class="modal hidden fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-75 backdrop-blur-sm p-4" style="animation: fadeIn 0.3s ease-out;">
        <div class="w-full max-w-md bg-white dark:bg-[#2c2f38] rounded-xl shadow-2xl overflow-hidden m-4 flex flex-col">
            <div class="flex justify-between items-center p-5 border-b border-gray-200 dark:border-gray-700">
                <h2 class="text-xl font-bold flex items-center gap-2">
                    <i data-lucide="truck" class="w-5 h-5 text-[#ffcd00]"></i>
                    Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙˆØµÙŠÙ„
                </h2>
                <button id="close-order-modal-btn" class="p-2 text-gray-600 dark:text-gray-300 hover:text-red-500 rounded-full transition-colors">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            
            <form id="order-details-form" class="p-5 space-y-4 overflow-y-auto max-h-[70vh]">
                <div>
                    <label for="order-customer-name" class="block text-sm font-medium mb-1.5 text-gray-700 dark:text-gray-300">
                        Ø§Ù„Ø§Ø³Ù… Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ <span class="text-red-500">*</span>
                    </label>
                    <div class="relative">
                        <input type="text" id="order-customer-name" required 
                               class="w-full pl-4 pr-10 py-3 rounded-lg bg-gray-50 dark:bg-[#3d474e] border border-gray-200 dark:border-gray-600 focus:border-[#ffcd00] focus:ring-2 focus:ring-[#ffcd00]/20 transition-all"
                               placeholder="">
                        <i data-lucide="user" class="w-5 h-5 absolute right-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
                    </div>
                </div>

                <div>
                    <label for="order-customer-phone" class="block text-sm font-medium mb-1.5 text-gray-700 dark:text-gray-300">
                        Ø±Ù‚Ù… Ù‡Ø§ØªÙ Ù„Ù„ØªÙˆØ§ØµÙ„ <span class="text-red-500">*</span>
                    </label>
                    <div class="relative">
                        <input type="tel" id="order-customer-phone" required
                               class="w-full pl-4 pr-10 py-3 rounded-lg bg-gray-50 dark:bg-[#3d474e] border border-gray-200 dark:border-gray-600 focus:border-[#ffcd00] focus:ring-2 focus:ring-[#ffcd00]/20 transition-all"
                               placeholder="" dir="ltr" style="text-align: right;">
                         <i data-lucide="phone" class="w-5 h-5 absolute right-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
                    </div>
                </div>

                <div>
                    <label for="order-customer-address" class="block text-sm font-medium mb-1.5 text-gray-700 dark:text-gray-300">
                        Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø¨Ø§Ù„ØªÙØµÙŠÙ„ <span class="text-red-500">*</span>
                    </label>
                    <div class="relative">
                        <textarea id="order-customer-address" required rows="3" 
                                  class="w-full pl-4 pr-10 py-3 rounded-lg bg-gray-50 dark:bg-[#3d474e] border border-gray-200 dark:border-gray-600 focus:border-[#ffcd00] focus:ring-2 focus:ring-[#ffcd00]/20 transition-all resize-none"
                                  placeholder=""></textarea>
                        <i data-lucide="map-pin" class="w-5 h-5 absolute right-3 top-3 text-gray-400"></i>
                    </div>
                </div>
                
                 <div>
                    <label for="order-notes" class="block text-sm font-medium mb-1.5 text-gray-700 dark:text-gray-300">
                        Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
                    </label>
                    <div class="relative">
                        <textarea id="order-notes" rows="2" 
                                  class="w-full pl-4 pr-10 py-3 rounded-lg bg-gray-50 dark:bg-[#3d474e] border border-gray-200 dark:border-gray-600 focus:border-[#ffcd00] focus:ring-2 focus:ring-[#ffcd00]/20 transition-all resize-none"
                                  placeholder=""></textarea>
                        <i data-lucide="file-text" class="w-5 h-5 absolute right-3 top-3 text-gray-400"></i>
                    </div>
                </div>

                <div class="pt-4 flex gap-3">
                    <button type="button" id="cancel-order-btn" class="flex-1 py-3.5 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200 font-bold rounded-xl hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors">
                        Ø¥Ù„ØºØ§Ø¡
                    </button>
                    <button type="submit" class="flex-[2] py-3.5 bg-[#25D366] hover:bg-[#128C7E] text-white font-bold rounded-xl shadow-lg hover:shadow-xl transition-all flex items-center justify-center gap-2">
                        <span>ØªØ£ÙƒÙŠØ¯ ÙˆØ¥Ø±Ø³Ø§Ù„ Ù„Ù„ÙˆØ§ØªØ³Ø§Ø¨</span>
                        <i data-lucide="send-horizontal" class="w-5 h-5 transform -scale-x-100"></i>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="gemini-help-modal" class="ai-modal-backdrop modal hidden fixed inset-0 z-50 flex items-end justify-end p-0 sm:p-4 bg-black/50 transition-opacity duration-300" data-state="closed">
        
        <div id="gemini-help-panel" class="w-full max-w-full sm:max-w-md max-h-[90vh] sm:max-h-[700px] flex flex-col transition-all duration-300 ease-out opacity-0 translate-y-6 rounded-t-2xl sm:rounded-2xl shadow-2xl overflow-hidden border bg-white/95 dark:bg-[#202124]/95 backdrop-blur-xl border-gray-200 dark:border-gray-700">
            
            <div class="flex-shrink-0 flex justify-between items-center p-4 border-b border-gray-200 dark:border-gray-700">
                <div class="flex items-center gap-3">
                    <span class="relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full items-center justify-center bg-gradient-to-br from-[#ffcd00] to-[#ffb700]">
                        <i data-lucide="sparkles" class="w-6 h-6 text-gray-900"></i>
                    </span>
                    <div>
                        <h2 class="text-base font-semibold">Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ</h2>
                        <p class="text-xs text-gray-500 dark:text-gray-400">Ø§Ø³Ø£Ù„Ù†ÙŠ Ø¹Ù† Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø£Ùˆ Ø§Ø·Ù„Ø¨ Ù†ØµÙŠØ­Ø©</p>
                    </div>
                </div>
                <div class="flex gap-1">
                    <button id="clear-chat-btn" class="p-2 text-gray-500 dark:text-gray-400 hover:text-blue-500 dark:hover:text-blue-400 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors" title="Ø¨Ø¯Ø¡ Ù…Ø­Ø§Ø¯Ø«Ø© Ø¬Ø¯ÙŠØ¯Ø©">
                        <i data-lucide="refresh-ccw" class="w-5 h-5"></i>
                    </button>
                    <button id="close-help-modal-btn" class="p-2 text-gray-500 dark:text-gray-400 hover:text-red-500 dark:hover:text-red-400 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors" title="Ø¥ØºÙ„Ø§Ù‚">
                        <i data-lucide="x" class="w-5 h-5"></i>
                    </button>
                </div>
            </div>
            
            <div id="chat-history" class="flex-1 p-4 space-y-4 overflow-y-auto flex flex-col bg-white dark:bg-[#202124]">
                <div class="model-message self-start">
                    Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù…ØªØ¬Ø± Ù…ÙƒØ©! ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ Ø§Ù„ÙŠÙˆÙ…ØŸ
                </div>
                
                <div id="loading-indicator" class="hidden loading-dots self-start">
                    <div class="loading-dot"></div>
                    <div class="loading-dot"></div>
                    <div class="loading-dot"></div>
                </div>
            </div>
            
         

            <form id="help-form" class="flex-shrink-0 p-4 border-t border-gray-200 dark:border-gray-700 bg-white/70 dark:bg-[#202124]/70">
                <div class="relative flex items-center">
                    <input type="text" id="help-input" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬ Ø£Ùˆ Ø§Ø·Ù„Ø¨ Ù†ØµÙŠØ­Ø©..." class="w-full px-4 py-3 pr-12 rounded-full bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 focus:border-[#ffcd00] focus:ring-[#ffcd00] transition-colors" style="padding-left: 52px;">
                    <button type="submit" class="absolute left-2 right-auto p-2.5 bg-[#ffcd00] text-gray-900 rounded-full hover:bg-[#ffda33] transition-colors shadow-sm disabled:opacity-50" style="left: 8px;">
                        <i data-lucide="send" class="w-5 h-5"></i>
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <script type="module">
        
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { 
            getAuth, 
            GoogleAuthProvider, 
            signInWithPopup, 
            onAuthStateChanged, 
            signOut,
            setPersistence,
            browserSessionPersistence 
        } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        
        import { 
            getFirestore, 
            collection, 
            addDoc, 
            onSnapshot, 
            query,
            Timestamp,
            deleteDoc, 
            doc,        
            updateDoc,
            setDoc,
            getDoc,
            increment  // Added increment here
        } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        
        const firebaseConfig = {
          apiKey: "AIzaSyBfslkMwWAmFXLPJ_aJZgSA7-59AhoOdUY",
          authDomain: "macaelctrec-f7795.firebaseapp.com",
          projectId: "macaelctrec-f7795",
          storageBucket: "macaelctrec-f7795.firebasestorage.app",
          messagingSenderId: "915102271751",
          appId: "1:915102271751:web:38cf552556f3cc5be15da2",
          measurementId: "G-231CS0RBZD"
        };

        
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app); 
        const provider = new GoogleAuthProvider();
 
        setPersistence(auth, browserSessionPersistence);

        
        let allProducts = [];
        let allArticles = []; 
        let modalListenerAttached = false; 
        let articleModalListenerAttached = false; 
        let currentIsAdmin = false; 
        let preFilterType = 'all'; 
        let defaultProductsCheckDone = false; 

        let aiChatHistory = [];
        const defaultSuggestions = [
            "Ù…Ø§ Ù‡ÙŠ Ø£ÙØ¶Ù„ Ø§Ù„Ø¹Ø±ÙˆØ¶ØŸ",
            "Ø£Ø¨Ø­Ø« Ø¹Ù† Ø¥Ø¶Ø§Ø¡Ø© Ù„ÙŠØ¯",
            "Ù…Ø§ Ù‡ÙŠ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø£ÙƒØ«Ø± Ù…Ø¨ÙŠØ¹Ø§Ù‹ØŸ",
            "Ø£Ø­ØªØ§Ø¬ Ù…Ø³Ø§Ø¹Ø¯Ø© ÙÙŠ Ø§Ø®ØªÙŠØ§Ø± ÙƒØ§Ø¨Ù„"
        ];
        
        let currentGalleryImages = [];
        let currentGalleryIndex = 0;
        // --- NEW: Track selected color on details page ---
        let currentSelectedColor = null;
        // -------------------------------------------------

        // --- NEW: Helper to check if offer is active ---
        function isOfferActive(product) {
            if (!product.isOnSale) return false;
            if (!product.saleEndDate) return true; // No end date = always active if on sale
            
            const now = new Date();
            // Handle both Firestore Timestamp and regular Date objects (just in case)
            const endDate = product.saleEndDate.toDate ? product.saleEndDate.toDate() : new Date(product.saleEndDate);
            return now < endDate;
        }

        function getRemainingTime(product) {
            if (!product.saleEndDate) return null;
            const now = new Date();
            const endDate = product.saleEndDate.toDate ? product.saleEndDate.toDate() : new Date(product.saleEndDate);
            const diff = endDate - now;

            if (diff <= 0) return null;

            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            
            if (days > 0) {
                return `${days} ÙŠÙˆÙ…`;
            } else {
                return `${hours} Ø³Ø§Ø¹Ø©`;
            }
        }
        // -----------------------------------------------

        // --- NEW: Function to add a color variant row in the modal ---
        function addColorVariantRow(color = '#000000', name = '', imageUrl = '') {
            const container = document.getElementById('color-variants-container');
            if (!container) return;

            const row = document.createElement('div');
            row.className = 'color-variant-row flex flex-col sm:flex-row gap-2 items-start sm:items-center bg-gray-50 dark:bg-white/5 p-3 rounded-lg relative';
            
            row.innerHTML = `
                <div class="flex items-center gap-2 flex-shrink-0">
                    <input type="color" class="color-input h-10 w-10 p-1 rounded cursor-pointer bg-transparent" value="${color}">
                    <input type="text" class="color-name-input w-24 px-3 py-2 text-sm rounded-lg bg-white dark:bg-[#3d474e] border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00]" placeholder="Ø§Ø³Ù… Ø§Ù„Ù„ÙˆÙ†" value="${name}">
                </div>
                <input type="url" class="color-image-input flex-grow w-full sm:w-auto px-3 py-2 text-sm rounded-lg bg-white dark:bg-[#3d474e] border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00]" placeholder="Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„Ù„ÙˆÙ† (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" value="${imageUrl}">
                <button type="button" class="remove-color-btn p-2 text-red-500 hover:bg-red-100 dark:hover:bg-red-900/20 rounded-full flex-shrink-0">
                    <i data-lucide="trash-2" class="w-4 h-4"></i>
                </button>
            `;

            row.querySelector('.remove-color-btn').addEventListener('click', () => {
                row.remove();
            });

            container.appendChild(row);
            lucide.createIcons();
        }
        // ------------------------------------------------------------

        // Ø¨ÙŠØ§Ù†Ø§Øª Ø¢Ø±Ø§Ø¡ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ (33 Ø¹Ù…ÙŠÙ„) - ØªÙ… ØªØ­Ø¯ÙŠØ«Ù‡Ø§ Ù„ØªØ´Ù…Ù„ ØªÙ†ÙˆØ¹ Ø§Ù„Ø®Ø¯Ù…Ø§Øª
        const testimonialsData = [
            { name: "Ù…Ø­Ù…Ø¯ Ø£Ø­Ù…Ø¯", rating: 5, text: "Ø§Ø´ØªØ±ÙŠØª Ù…Ù† Ø¹Ù†Ø¯Ù‡Ù… Ø¯Ù‡Ø§Ù†Ø§Øª Ø¬ÙˆØªÙ†ØŒ Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø·Ù„Ø¹Øª Ø²ÙŠ Ø§Ù„ÙƒØªØ§Ù„ÙˆØ¬ Ø¨Ø§Ù„Ø¸Ø¨Ø·ØŒ ÙˆÙØ±ÙŠÙ‚Ù‡Ù… Ø³Ø§Ø¹Ø¯Ù†ÙŠ Ø§Ø®ØªØ§Ø± Ø§Ù„Ø¯Ø±Ø¬Ø§Øª Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©." },
            { name: "Ø³Ø§Ø±Ø© Ø¹Ù„ÙŠ", rating: 5, text: "Ø®Ø¯Ù…Ø© ØªØ±ÙƒÙŠØ¨ Ø§Ù„Ø¯Ø´ Ø¹Ù†Ø¯Ù‡Ù… Ù…Ù…ØªØ§Ø²Ø©ØŒ Ø§Ù„ÙÙ†ÙŠ Ø¬Ù‡ ÙÙŠ Ù…ÙŠØ¹Ø§Ø¯Ù‡ ÙˆØ¸Ø¨Ø· Ø§Ù„Ø¥Ø´Ø§Ø±Ø© Ø¨Ø³Ø±Ø¹Ø© ÙˆØ§Ø­ØªØ±Ø§ÙÙŠØ©." },
            { name: "Ø®Ø§Ù„Ø¯ Ø­Ø³Ù†", rating: 5, text: "Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ© (Ø´Ù†ÙŠÙˆØ± ÙˆØµØ§Ø±ÙˆØ®) Ø¹Ù†Ø¯Ù‡Ù… Ø£Ù‚Ù„ Ù…Ù† Ø§Ù„Ø³ÙˆÙ‚ØŒ ÙˆØ§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø£ØµÙ„ÙŠØ© Ø¨Ø¶Ù…Ø§Ù†." },
            { name: "Ù…Ù†Ù‰ Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ…", rating: 5, text: "Ø¬Ø¨Øª ÙƒÙ„ Ù…ÙØ§ØªÙŠØ­ Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡ ÙˆØ§Ù„Ø¨Ø±Ø§ÙŠØ² Ù„Ø´Ù‚ØªÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ù…Ù† Ø¹Ù†Ø¯Ù‡Ù…ØŒ ØªØ´ÙƒÙŠÙ„Ø© ÙƒØ¨ÙŠØ±Ø© ÙˆÙ…ÙˆØ¯ÙŠÙ„Ø§Øª Ø´ÙŠÙƒ Ø¬Ø¯Ø§Ù‹." },
            { name: "ÙŠÙˆØ³Ù Ù…Ø­Ù…ÙˆØ¯", rating: 5, text: "Ø§Ø­ØªØ¬Øª Ø­Ø¯Ø§ÙŠØ¯ ÙˆÙ…Ø³Ø§Ù…ÙŠØ± Ù„Ø´ØºÙ„ ÙÙŠ Ø§Ù„Ø¨ÙŠØªØŒ Ù„Ù‚ÙŠØª ÙƒÙ„ Ø§Ù„Ù…Ù‚Ø§Ø³Ø§Øª Ø§Ù„Ù„ÙŠ Ø¹Ø§ÙŠØ²Ù‡Ø§ ÙˆØ¨Ø£Ø³Ø¹Ø§Ø± ÙƒÙˆÙŠØ³Ø©." },
            { name: "Ø±Ø§Ù†ÙŠØ§ ÙƒÙ…Ø§Ù„", rating: 5, text: "Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø³Ù‡Ù„ Ø¬Ø¯Ø§Ù‹ ÙÙŠ Ø§Ù„Ø·Ù„Ø¨ØŒ Ø·Ù„Ø¨Øª Ù„Ù…Ø¨Ø§Øª Ù„ÙŠØ¯ ÙˆÙˆØµÙ„ØªÙ†ÙŠ ØªØ§Ù†ÙŠ ÙŠÙˆÙ…ØŒ ØªØºÙ„ÙŠÙ Ù…Ù…ØªØ§Ø²." },
            { name: "Ø¹Ù…Ø± ÙØ§Ø±ÙˆÙ‚", rating: 5, text: "ÙØ±ÙŠÙ‚ Ø§Ù„ØªØ±ÙƒÙŠØ¨Ø§Øª Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ© Ø¹Ù†Ø¯Ù‡Ù… ÙØ§Ù‡Ù… Ø´ØºÙ„Ù‡ ÙƒÙˆÙŠØ³ØŒ Ø£Ø³Ø³ÙˆØ§ Ù„ÙŠ ÙƒÙ‡Ø±Ø¨Ø§Ø¡ Ø§Ù„Ù…Ø­Ù„ Ø¨Ø¶Ù…ÙŠØ±." },
            { name: "Ù„ÙŠÙ„Ù‰ Ø¹Ø¨Ø¯ Ø§Ù„Ø±Ø­Ù…Ù†", rating: 5, text: "Ù…ØªØ¬Ø± Ù…ØªÙƒØ§Ù…Ù„ ÙØ¹Ù„Ø§Ù‹ØŒ Ø¬Ø¨Øª Ø§Ù„Ø¯Ù‡Ø§Ù†Ø§Øª ÙˆØ£Ø¯ÙˆØ§Øª Ø§Ù„Ù†Ù‚Ø§Ø´Ø© ÙˆØ§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡ Ù…Ù† Ù…ÙƒØ§Ù† ÙˆØ§Ø­Ø¯ ÙˆÙˆÙØ±Øª ÙˆÙ‚Øª ÙˆÙ…Ø¬Ù‡ÙˆØ¯." },
            { name: "Ø£Ø­Ù…Ø¯ Ù…ØµØ·ÙÙ‰", rating: 5, text: "Ø§Ø´ØªØ±ÙŠØª Ø·Ø¨Ù‚ Ø¯Ø´ 100 Ø³Ù… ÙˆØ¹Ø¯Ø³Ø©ØŒ Ø¬ÙˆØ¯ØªÙ‡Ù… Ø¹Ø§Ù„ÙŠØ© ÙˆØ§Ù„Ø¥Ø´Ø§Ø±Ø© Ù‚ÙˆÙŠØ© Ø¬Ø¯Ø§Ù‹." },
            { name: "Ù‡Ø¨Ø© Ø³Ø¹ÙŠØ¯", rating: 5, text: "Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ù…Ø­ØªØ±Ù…Ø© Ø¬Ø¯Ø§Ù‹ØŒ Ø±Ø¯ÙˆØ§ Ø¹Ù„Ù‰ ÙƒÙ„ Ø§Ø³ØªÙØ³Ø§Ø±Ø§ØªÙŠ Ø¨Ø®ØµÙˆØµ Ø£Ù†ÙˆØ§Ø¹ Ø³Ù„Ùƒ Ø§Ù„Ø³ÙˆÙŠØ¯ÙŠ Ø§Ù„Ø£ØµÙ„ÙŠ." },
            { name: "ÙƒØ±ÙŠÙ… Ø¹Ø§Ø¯Ù„", rating: 5, text: "Ø£Ø³Ø¹Ø§Ø± Ø¬Ù…Ù„Ø© ÙØ¹Ù„Ø§Ù‹ Ù…Ø´ ÙƒÙ„Ø§Ù…ØŒ Ø§Ø´ØªØ±ÙŠØª ÙƒÙ…ÙŠØ© Ù„Ù…Ø´Ø±ÙˆØ¹ ØµØºÙŠØ± ÙˆØ§Ù„ÙØ±Ù‚ ÙƒØ§Ù† ÙˆØ§Ø¶Ø­." },
            { name: "Ù†ÙˆØ±Ù‡Ø§Ù† Ø¬Ù…Ø§Ù„", rating: 5, text: "ÙƒÙ†Øª Ù…Ø­ØªØ§Ø¬Ø© Ø£ØºÙŠØ± Ù„ÙˆÙ† Ø£ÙˆØ¶Ø© Ø§Ù„Ø£Ø·ÙØ§Ù„ØŒ Ù†ØµØ­ÙˆÙ†ÙŠ Ø¨Ù†ÙˆØ¹ Ø¯Ù‡Ø§Ù† Ù‚Ø§Ø¨Ù„ Ù„Ù„ØºØ³ÙŠÙ„ ÙˆØ·Ù„Ø¹ ØªØ­ÙØ©." },
            { name: "Ø­Ø³Ø§Ù… Ø§Ù„Ø¯ÙŠÙ†", rating: 5, text: "Ø§Ø´ØªØ±ÙŠØª Ø´Ù†ÙŠÙˆØ± Ø¨ÙˆØ´ Ø£ØµÙ„ÙŠ Ù…Ù† Ø¹Ù†Ø¯Ù‡Ù…ØŒ Ø´ØºØ§Ù„ Ù…Ø¹Ø§ÙŠØ§ Ø²ÙŠ Ø§Ù„ÙÙ„ Ø¨Ù‚Ø§Ù„Ù‡ Ø³Ù†Ø©." },
            { name: "Ù…Ø±ÙŠÙ… ÙŠÙˆØ³Ù", rating: 5, text: "Ø±ÙƒØ¨ÙˆØ§ Ù„ÙŠ ÙƒØ§Ù…ÙŠØ±Ø§Øª Ù…Ø±Ø§Ù‚Ø¨Ø© ÙÙŠ Ø§Ù„Ø¹Ù…Ø§Ø±Ø©ØŒ Ø´ØºÙ„ Ù†Ø¸ÙŠÙ ÙˆØ³Ø±ÙŠØ¹ ÙˆØ³Ø¹Ø±Ù‡Ù… Ù…Ø¹Ù‚ÙˆÙ„ Ø¬Ø¯Ø§Ù‹." },
            { name: "ØªØ§Ù…Ø± Ù†Ø¨ÙŠÙ„", rating: 5, text: "ÙƒÙ„ Ù„ÙˆØ§Ø²Ù… Ø§Ù„Ø­Ø¯Ø§ÙŠØ¯ Ø§Ù„Ù„ÙŠ Ø¯ÙˆØ±Øª Ø¹Ù„ÙŠÙ‡Ø§ Ø¨Ø±Ù‡ ÙˆÙ…Ù„Ù‚ØªÙ‡Ø§Ø´ØŒ Ù„Ù‚ÙŠØªÙ‡Ø§ Ø¹Ù†Ø¯Ù‡Ù… Ø¨Ø³Ù‡ÙˆÙ„Ø©." },
            { name: "Ø¯Ø¹Ø§Ø¡ Ø­Ø³Ù†", rating: 5, text: "Ø§Ù„Ù„Ù…Ø¨Ø§Øª Ø§Ù„Ù„ÙŠØ¯ Ø§Ù„Ù„ÙŠ Ø§Ø´ØªØ±ÙŠØªÙ‡Ø§ Ù…Ù† Ø¹Ù†Ø¯Ù‡Ù… Ù…ÙˆÙØ±Ø© Ø¬Ø¯Ø§Ù‹ ÙÙŠ Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡ ÙˆØ¥Ø¶Ø§Ø¡ØªÙ‡Ø§ Ù‚ÙˆÙŠØ©." },
            { name: "ÙˆØ§Ø¦Ù„ Ø³Ù…ÙŠØ±", rating: 5, text: "ØªØ¹Ø§Ù…Ù„ Ø±Ø§Ù‚ÙŠ ÙˆÙ…ØµØ¯Ø§Ù‚ÙŠØ© ÙÙŠ Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ØŒ Ø·Ù„Ø¨Øª ÙÙ†ÙŠ Ù„ØªØ±ÙƒÙŠØ¨ Ù†Ø¬Ù ÙˆØ¬Ù‡ ÙÙŠ Ø§Ù„Ù…ÙŠØ¹Ø§Ø¯ Ø¨Ø§Ù„Ø¸Ø¨Ø·." },
            { name: "Ø´Ø±ÙˆÙ‚ Ù…Ø­Ù…Ø¯", rating: 5, text: "Ø¬Ø¨Øª Ù…Ù† Ø¹Ù†Ø¯Ù‡Ù… Ù…Ø´ØªØ±Ùƒ ÙƒÙ‡Ø±Ø¨Ø§Ø¡ Ø£ØµÙ„ÙŠ ÙŠØ³ØªØ­Ù…Ù„ Ø§Ù„Ø£Ø­Ù…Ø§Ù„ Ø§Ù„Ø¹Ø§Ù„ÙŠØ©ØŒ Ù…Ù…ØªØ§Ø² ÙˆØ£Ù†ØµØ­ Ø¨ÙŠÙ‡." },
            { name: "Ø£Ø³Ø§Ù…Ø© ÙØªØ­ÙŠ", rating: 5, text: "Ù„Ùˆ Ø¨ØªØ¯ÙˆØ± Ø¹Ù„Ù‰ Ø¹Ø¯Ø© ÙŠØ¯ÙˆÙŠØ© ØªØ¹ÙŠØ´ Ù…Ø¹Ø§ÙƒØŒ Ø¯Ù‡ Ø£Ù†Ø³Ø¨ Ù…ÙƒØ§Ù†ØŒ Ø®Ø§Ù…Ø§Øª Ù…Ø­ØªØ±Ù…Ø© Ø¬Ø¯Ø§Ù‹." },
            { name: "ÙŠØ§Ø±Ø§ Ø§Ù„Ø³ÙŠØ¯", rating: 5, text: "Ø³Ø§Ø¹Ø¯ÙˆÙ†ÙŠ ÙÙŠ Ø§Ø®ØªÙŠØ§Ø± Ø£Ø·Ø¨Ø§Ù‚ Ø§Ù„Ø¯Ø´ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ù„Ø´Ø¨ÙƒØ© Ø§Ù„Ù…Ø±ÙƒØ²ÙŠØ© ÙÙŠ Ø§Ù„Ø¹Ù…Ø§Ø±Ø©." },
            { name: "Ù…Ø­Ù…ÙˆØ¯ Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ù‡", rating: 5, text: "Ø¯Ù‡Ø§Ù†Ø§Øª Ø³ÙƒÙŠØ¨ Ø§Ù„Ù„ÙŠ Ø¹Ù†Ø¯Ù‡Ù… Ø£ØµÙ„ÙŠØ© ÙˆØªØ§Ø±ÙŠØ® Ø¥Ù†ØªØ§Ø¬Ù‡Ø§ Ø¬Ø¯ÙŠØ¯ØŒ ÙˆØ§Ù„Ù†ØªÙŠØ¬Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø­ÙŠØ·Ø© Ø±ÙˆØ¹Ø©." },
            { name: "Ø¥ÙŠÙ…Ø§Ù† ÙÙˆØ²ÙŠ", rating: 5, text: "Ø§Ù„Ù…ÙƒØ§Ù† Ø§Ù„ÙˆØ­ÙŠØ¯ ÙÙŠ Ø§Ù„Ù…Ù‚Ø·Ù… Ø§Ù„Ù„ÙŠ Ø£Ø«Ù‚ Ø£Ø´ØªØ±ÙŠ Ù…Ù†Ù‡ ÙƒØ§Ø¨Ù„Ø§Øª ÙˆØ£Ù†Ø§ Ù…Ø·Ù…Ù†Ø© Ø¥Ù†Ù‡Ø§ Ù…Ø´ Ù…Ø¶Ø±ÙˆØ¨Ø©." },
            { name: "Ø²ÙŠØ§Ø¯ Ø·Ø§Ø±Ù‚", rating: 5, text: "Ø®Ø¯Ù…Ø© Ù…Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ø¨ÙŠØ¹ Ù…Ù…ØªØ§Ø²Ø©ØŒ ÙƒØ§Ù† ÙÙŠ Ù…Ø´ÙƒÙ„Ø© Ø¨Ø³ÙŠØ·Ø© ÙÙŠ Ø¬Ù‡Ø§Ø² ÙˆØ±Ø¬Ø¹ØªÙ‡ ÙˆØ¨Ø¯Ù„ÙˆÙ‡ ÙÙˆØ±Ø§Ù‹." },
            { name: "Ù†Ø§Ø¯ÙŠØ© ÙƒÙ…Ø§Ù„", rating: 5, text: "ØªØ´ÙƒÙŠÙ„Ø© Ø§Ù„Ø£ÙˆÙƒØ± ÙˆØ§Ù„Ù…Ù‚Ø§Ø¨Ø¶ (Ø§Ù„Ø­Ø¯Ø§ÙŠØ¯) Ø¹Ù†Ø¯Ù‡Ù… Ø´ÙŠÙƒ Ø¬Ø¯Ø§Ù‹ ÙˆØªÙ†Ø§Ø³Ø¨ ÙƒÙ„ Ø§Ù„Ø£Ø°ÙˆØ§Ù‚." },
            { name: "Ù‡Ø´Ø§Ù… Ø·Ù„Ø¹Øª", rating: 5, text: "ÙÙ†ÙŠ Ø§Ù„Ø¯Ø´ Ø§Ù„Ù„ÙŠ Ø¨Ø¹ØªÙˆÙ‡ Ù…Ø­ØªØ±Ù Ø¬Ø¯Ø§Ù‹ØŒ Ø¸Ø¨Ø· Ù‚Ù†ÙˆØ§Øª Ø§Ù„Ù†Ø§ÙŠÙ„ Ø³Ø§Øª ÙˆØ§Ù„Ø¹Ø±Ø¨ Ø³Ø§Øª ÙÙŠ ÙˆÙ‚Øª Ù‚ÙŠØ§Ø³ÙŠ." },
            { name: "Ø£Ù…ÙŠØ±Ø© Ø³Ø¹ÙŠØ¯", rating: 5, text: "Ø§Ø´ØªØ±ÙŠØª ØµØ§Ø±ÙˆØ® ÙˆÙ…Ø¬Ù…ÙˆØ¹Ø© Ø£Ø³Ø·ÙˆØ§Ù†Ø§Øª Ù‚Ø·Ø¹ØŒ Ø£Ø³Ø¹Ø§Ø±Ù‡Ù… Ù…Ù…ØªØ§Ø²Ø© Ù…Ù‚Ø§Ø±Ù†Ø© Ø¨Ø§Ù„Ù…Ø­Ù„Ø§Øª Ø§Ù„ØªØ§Ù†ÙŠØ©." },
            { name: "Ø±Ø§Ù…ÙŠ ÙˆØ¬Ø¯ÙŠ", rating: 5, text: "Ø·Ù„Ø¨Øª Ø·Ù„Ø¨ÙŠØ© Ø¯Ù‡Ø§Ù†Ø§Øª ÙƒØ¨ÙŠØ±Ø© Ù„Ù„Ù…ÙˆÙ‚Ø¹ ÙˆÙˆØµÙ„Øª ÙÙŠ Ù…ÙŠØ¹Ø§Ø¯Ù‡Ø§ Ø¨Ø¯ÙˆÙ† Ø£ÙŠ ØªØ£Ø®ÙŠØ±." },
            { name: "Ø³Ù„ÙˆÙ‰ Ù…Ø­Ù…ÙˆØ¯", rating: 5, text: "Ø¥Ø¶Ø§Ø¡Ø§Øª Ø§Ù„Ù„ÙŠØ¯ Ø¨Ø±ÙˆÙØ§ÙŠÙ„ Ø§Ù„Ù„ÙŠ Ø±ÙƒØ¨ÙˆÙ‡Ø§ ÙÙŠ Ø§Ù„Ø±ÙŠØ³Ø¨Ø´Ù† ØºÙŠØ±Øª Ø´ÙƒÙ„ Ø§Ù„Ù…ÙƒØ§Ù† ØªÙ…Ø§Ù…Ø§Ù‹." },
            { name: "Ø£Ø´Ø±Ù Ø²ÙƒÙŠ", rating: 5, text: "Ù…Ø¤Ø³Ø³Ø© Ù…Ø­ØªØ±Ù…Ø©ØŒ Ø¹Ù†Ø¯Ù‡Ù… Ø¶Ù…ÙŠØ± ÙÙŠ Ø´ØºÙ„ Ø§Ù„ØªØ±ÙƒÙŠØ¨Ø§Øª ÙˆØ¨ÙŠØ³ØªØ®Ø¯Ù…ÙˆØ§ Ø®Ø§Ù…Ø§Øª Ø£ØµÙ„ÙŠØ©." },
            { name: "ØºØ§Ø¯Ø© Ø¹Ø§Ø¯Ù„", rating: 5, text: "ÙƒÙ„ Ø¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª Ø§Ù„Ø¯Ø´ Ù…Ù† Ø³Ù„Ùƒ ÙˆÙˆØµÙ„Ø§Øª lnb Ù…ÙˆØ¬ÙˆØ¯Ø© Ø¹Ù†Ø¯Ù‡Ù… Ø¨Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ©." },
            { name: "Ù…Ø§Ø¬Ø¯ Ø³Ø§Ù…ÙŠ", rating: 5, text: "Ø§Ø´ØªØ±ÙŠØª Ø·Ù‚Ù… Ù…ÙÙƒØ§Øª ÙˆØ¨Ù†Ø³ØŒ Ø®Ø§Ù…ØªÙ‡Ù… Ù…Ù…ØªØ§Ø²Ø© ÙˆØ¨ÙŠØ³ØªØ­Ù…Ù„ÙˆØ§ Ø§Ù„Ø´ØºÙ„ Ø§Ù„ØªÙ‚ÙŠÙ„." },
            { name: "Ù†Ù‡Ù‰ ÙƒØ±ÙŠÙ…", rating: 5, text: "Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù„ÙŠ Ø®Ù„Ø·ÙˆÙ‡Ø§ Ù„ÙŠ Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ± Ø·Ù„Ø¹Øª Ø¨Ø§Ù„Ø¸Ø¨Ø· Ø²ÙŠ Ù…Ø§ ÙƒÙ†Øª Ø¹Ø§ÙŠØ²Ø§Ù‡Ø§." },
            { name: "Ø¹Ù…Ø§Ø¯ Ø§Ù„Ø¯ÙŠÙ†", rating: 5, text: "Ù…ÙƒØ§Ù† ÙˆØ§Ø­Ø¯ Ø¨ÙŠÙˆÙØ± Ø¹Ù„ÙŠÙƒ Ù„Ù ÙƒØªÙŠØ±ØŒ ÙƒÙ‡Ø±Ø¨Ø§Ø¡ØŒ Ø¯Ù‡Ø§Ù†Ø§ØªØŒ Ø­Ø¯Ø§ÙŠØ¯ØŒ ÙˆØ¯Ø´.. Ø´ÙƒØ±Ø§Ù‹ Ù„ÙŠÙƒÙ…." }
        ];

        function renderTestimonials() {
            const track = document.getElementById('testimonials-track');
            if (!track) return;

            let testimonialsHTML = '';
            testimonialsData.forEach(t => {
                testimonialsHTML += `
                    <div class="inline-block w-80 p-6 mx-2 bg-white dark:bg-[#2c2f38] rounded-xl shadow-md border border-gray-200 dark:border-gray-700 whitespace-normal align-top">
                        <div class="flex items-center mb-4">
                            <div class="w-10 h-10 rounded-full bg-gray-200 dark:bg-gray-600 flex items-center justify-center text-lg font-bold text-gray-600 dark:text-gray-300 ml-3">
                                ${t.name.charAt(0)}
                            </div>
                            <div>
                                <h4 class="font-semibold text-gray-900 dark:text-white">${t.name}</h4>
                                <div class="text-[#ffcd00] text-sm">â˜…â˜…â˜…â˜…â˜…</div>
                            </div>
                        </div>
                        <p class="text-gray-600 dark:text-gray-300 text-sm leading-relaxed">
                            "${t.text}"
                        </p>
                    </div>
                `;
            });

            // ØªÙƒØ±Ø§Ø± Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù„Ø¶Ù…Ø§Ù† Ø­Ø±ÙƒØ© Ø³Ù„Ø³Ø© ÙˆÙ…Ø³ØªÙ…Ø±Ø© (Infinite Loop)
            track.innerHTML = testimonialsHTML + testimonialsHTML; 
        }

        
        function generateShortId(length = 5) {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
            let result = '';
            for (let i = 0; i < length; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }

        
        function showToast(message) {
            const existingToast = document.querySelector('.toast-notification');
            if (existingToast) {
                existingToast.remove();
            }

            const toast = document.createElement('div');
            toast.className = 'toast-notification';
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }


        function updateGalleryView(index) {
            const mainImgEl = document.getElementById('main-product-image');
            const thumbnailContainer = document.getElementById('details-thumbnail-container');

            if (!mainImgEl || !thumbnailContainer || currentGalleryImages.length === 0) return;


            currentGalleryIndex = (index + currentGalleryImages.length) % currentGalleryImages.length;

            const newImageUrl = currentGalleryImages[currentGalleryIndex];
            

            mainImgEl.src = newImageUrl;

            const thumbnails = thumbnailContainer.querySelectorAll('img');
            thumbnails.forEach((img, i) => {
                img.classList.toggle('border-[#ffcd00]', i === currentGalleryIndex);
                img.classList.toggle('border-transparent', i !== currentGalleryIndex);
            });
        }

        
        const loginBtn = document.getElementById('google-login-btn');
        const logoutBtn = document.getElementById('google-logout-btn');
        const userInfo = document.getElementById('user-info');
        const userAvatar = document.getElementById('user-avatar');
        const loginBtnMobile = document.getElementById('google-login-btn-mobile');
        const logoutBtnMobile = document.getElementById('google-logout-btn-mobile');
        const userInfoMobile = document.getElementById('user-info-mobile');
        const userAvatarMobile = document.getElementById('user-avatar-mobile');
        const userNameMobile = document.getElementById('user-name-mobile');
        
        
        
        const signInWithGoogle = (e) => {
            e.preventDefault();
            signInWithPopup(auth, provider)
                .then((result) => {
                    const user = result.user;
                    const email = user.email;

                    if (email === "macaelctrec@gmail.com") {
                        console.log('User signed in:', user.displayName);
                        showToast(`!Ø£Ù‡Ù„Ø§Ù‹ Ø¨ÙƒØŒ ${user.displayName}`);
                    } else {
                        console.warn(`Unauthorized email attempt: ${email}`);
                        signOut(auth);
                        showToast('Ø¹Ø°Ø±Ø§Ù‹ØŒ Ù‡Ø°Ø§ Ø§Ù„Ø­Ø³Ø§Ø¨ ØºÙŠØ± Ù…ØµØ±Ø­ Ù„Ù‡ Ø¨ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„.');
                    }

                }).catch((error) => {
                    console.error('Google Sign-In Error:', error.message);
                    showToast('ÙØ´Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                });
        };
 
        
        const signOutGoogle = (e) => {
            e.preventDefault(); 
            signOut(auth).then(() => {
                console.log('User signed out.');
                showToast('You have been logged out.');
            }).catch((error) => {
                console.error('Sign Out Error:', error);
            });
        };
 
        
        if(loginBtn) loginBtn.addEventListener('click', signInWithGoogle);
        if(logoutBtnMobile) logoutBtnMobile.addEventListener('click', signOutGoogle);
        if(loginBtnMobile) loginBtnMobile.addEventListener('click', signInWithGoogle);
        if(logoutBtnMobile) logoutBtnMobile.addEventListener('click', signOutGoogle);
 

        const userAvatarBtn = document.getElementById('user-avatar-btn');
        const userDropdownMenu = document.getElementById('user-dropdown-menu');

        if (userAvatarBtn && userDropdownMenu) {
            userAvatarBtn.addEventListener('click', (e) => {
                e.stopPropagation(); 
                const state = userDropdownMenu.dataset.state === 'open' ? 'closed' : 'open';
                userDropdownMenu.dataset.state = state;
            });


            window.addEventListener('click', (e) => {
                if (userDropdownMenu.dataset.state === 'open') {
                    if (!userAvatarBtn.contains(e.target) && !userDropdownMenu.contains(e.target)) {
                        userDropdownMenu.dataset.state = 'closed';
                    }
                }
            });
        }

 
        
        onAuthStateChanged(auth, (user) => {
            const isAdmin = user && user.email === "macaelctrec@gmail.com";
            currentIsAdmin = isAdmin; 
            

            const dropdownAdminLink = document.getElementById('dropdown-admin-link'); // +++ ADJUSTED THIS +++
 
            if (user) { 
                const photo = user.photoURL || 'https://placehold.co/32x32/eeeeee/777777?text=User';
                
                
                if(userInfo) userInfo.classList.remove('hidden');
                if(userInfo) userInfo.classList.add('flex');
                if(userAvatar) userAvatar.src = photo;
                
               
                if(loginBtn) loginBtn.classList.remove('sm:inline-flex'); 
        

             
                if(userInfoMobile) userInfoMobile.classList.remove('hidden');
                if(userInfoMobile) userInfoMobile.classList.add('flex');
                if(userAvatarMobile) userAvatarMobile.src = photo;
                if(userNameMobile) userNameMobile.textContent = user.displayName;
                if(loginBtnMobile) loginBtnMobile.style.display = 'none';
 
               
                const dropdownLogout = document.getElementById('google-logout-btn-dropdown');
                if (dropdownLogout) {
                    if (!dropdownLogout.dataset.listenerAttached) {
                        dropdownLogout.addEventListener('click', signOutGoogle);
                        dropdownLogout.dataset.listenerAttached = 'true';
                    }
                }
                
                const dropdownAdmin = document.getElementById('dropdown-admin-link');
                if (dropdownAdmin) {
                    if (!dropdownAdmin.dataset.listenerAttached) {
                        dropdownAdmin.addEventListener('click', (e) => {
                            
                            userDropdownMenu.dataset.state = 'closed'; 
                        });
                        dropdownAdmin.dataset.listenerAttached = 'true';
                    }
                }
 
            } else { 
                
                if(userInfo) userInfo.classList.add('hidden');
                if(userInfo) userInfo.classList.remove('flex');
                if(userAvatar) userAvatar.src = '';


                if(loginBtn) loginBtn.classList.add('sm:inline-flex'); 



                if(userInfoMobile) userInfoMobile.classList.add('hidden');
                if(userInfoMobile) userInfoMobile.classList.remove('flex');
                if(userAvatarMobile) userAvatarMobile.src = '';
                if(userNameMobile) userNameMobile.textContent = '';
                if(loginBtnMobile) loginBtnMobile.style.display = 'block';
            }

            
            const addProductBtn = document.getElementById('show-add-product-modal-btn');
            const addArticleBtn = document.getElementById('show-add-article-modal-btn'); // +++++ NEW +++++
            
            // --- NEW: Setup Color Variant Button Listener ---
            const addColorBtn = document.getElementById('add-color-variant-btn');
            if (addColorBtn && !addColorBtn.dataset.listenerAttached) {
                addColorBtn.addEventListener('click', () => addColorVariantRow());
                addColorBtn.dataset.listenerAttached = 'true';
            }
            // ------------------------------------------------

            if (isAdmin) {
                if(addProductBtn) {
                    addProductBtn.classList.remove('hidden');
                    addProductBtn.classList.add('inline-flex'); 

                    // FIX: Completely reset the button to ensure clean event listener attachment
                    const newAddBtn = addProductBtn.cloneNode(true);
                    addProductBtn.parentNode.replaceChild(newAddBtn, addProductBtn);
                    
                    newAddBtn.addEventListener('click', (e) => {
                        e.preventDefault();
                        console.log("ğŸ”¥ Add Product Button CLICKED ğŸ”¥");
                        
                        const modalEl = document.getElementById('add-product-modal');
                        if (modalEl) {
                            console.log("Modal element found, attempting to open...");
                            resetModalToAddMode(); 
                            // Force show using both class and inline style to override any conflicts
                            modalEl.classList.remove('hidden');
                            modalEl.style.display = 'flex';
                        } else {
                            console.error("CRITICAL: Modal element NOT found!");
                            alert("Ø®Ø·Ø£ Ø¯Ø§Ø®Ù„ÙŠ: Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¥Ø¶Ø§ÙØ© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ø§Ù„ØµÙØ­Ø©.");
                        }
                    });
                }


                if(addArticleBtn) {
                    addArticleBtn.classList.remove('hidden');
                    addArticleBtn.classList.add('inline-flex');

                    if (!articleModalListenerAttached) {
                        const articleModal = document.getElementById('add-article-modal');
                        if (articleModal) {
                            addArticleBtn.addEventListener('click', () => {
                                resetArticleModalToAddMode(); 
                                articleModal.classList.remove('hidden');
                            });
                            articleModalListenerAttached = true;
                        }
                    }
                }

  
                if(dropdownAdminLink) dropdownAdminLink.classList.remove('hidden'); // +++ ADJUSTED THIS +++
 
 
            } else {
                if(addProductBtn) {
                    addProductBtn.classList.add('hidden');
                    addProductBtn.classList.remove('inline-flex');
                }
                modalListenerAttached = false; 


                if(addArticleBtn) {
                    addArticleBtn.classList.add('hidden');
                    addArticleBtn.classList.remove('inline-flex');
                }
                articleModalListenerAttached = false;

               
                if(dropdownAdminLink) dropdownAdminLink.classList.add('hidden'); // +++ ADJUSTED THIS +++
 
            }
            
            renderAllProductViews(); 
            renderArticles(); 
            
            
            
            
            loadProducts(); 
            loadArticles(); 
            loadSiteConfig(); 
            renderTestimonials(); // Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ø¢Ø±Ø§Ø¡ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡
        });

            let cart = []; 
            const cartCountBadge = document.getElementById('cart-count-badge');
            const mobileCartCountBadge = document.getElementById('mobile-cart-count-badge');
            const cartItemsContainer = document.getElementById('cart-items-container');
            const cartEmptyMessage = document.getElementById('cart-empty-message');
            const cartSummary = document.getElementById('cart-summary');
            const cartSubtotalEl = document.getElementById('cart-subtotal');
            const cartTotalEl = document.getElementById('cart-total');

            function addToCart(product, quantity = 1) {
                if (!product.id || !product.name || !product.price || !product.image) {
                    console.error('Invalid product data:', product);
                    return;
                }

                // --- MODIFIED: Create Unique Cart Item ID (handling color variants) ---
                product.cartItemId = product.selectedColor 
                    ? `${product.id}-${product.selectedColor.hex.replace('#', '')}` 
                    : product.id;

                const existingProduct = cart.find(item => item.cartItemId === product.cartItemId);
                if (existingProduct) {
                    existingProduct.quantity += quantity;
                } else {
                    cart.push({ ...product, quantity: quantity });
                }
                // ---------------------------------------------------------------------

                updateCartView();
                
                const toastMessage = quantity > 1 
                    ? `ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© ${quantity} x "${product.name}" Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©!`
                    : `ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© "${product.name}" Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©!`;
                showToast(toastMessage);
            }

            function updateCartView() {
                const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);

                if (totalItems > 0) {
                    if (cartCountBadge) {
                        cartCountBadge.textContent = totalItems;
                        cartCountBadge.classList.remove('hidden');
                    }
                    if (mobileCartCountBadge) {
                        mobileCartCountBadge.textContent = totalItems;
                        mobileCartCountBadge.classList.remove('hidden');
                    }
                } else {
                    if (cartCountBadge) cartCountBadge.classList.add('hidden');
                    if (mobileCartCountBadge) mobileCartCountBadge.classList.add('hidden');
                }
                
                if (document.getElementById('page-cart').classList.contains('active')) {
                    renderCartPage();
                }
            }

            function renderCartPage() {
                if (!cartItemsContainer || !cartEmptyMessage || !cartSummary) return;

                if (cart.length === 0) {
                    cartItemsContainer.innerHTML = '';
                    cartEmptyMessage.classList.remove('hidden');
                    cartSummary.classList.add('hidden');
                } else {
                    cartEmptyMessage.classList.add('hidden');
                    cartSummary.classList.remove('hidden');
                    
                    cartItemsContainer.innerHTML = cart.map(item => `
                        <div class="flex flex-col sm:flex-row items-center gap-4 p-4 border-b border-gray-200 dark:border-gray-700" data-cart-item-id="${item.cartItemId}">
                            <img src="${item.image}" alt="${item.name}" class="w-24 h-24 object-cover rounded-lg">
                            <div class="flex-grow text-center sm:text-left">
                                <h3 class="text-lg font-semibold">${item.name}</h3>
                                ${item.selectedColor ? `
                                    <div class="flex items-center justify-center sm:justify-start gap-2 mt-1 text-sm text-gray-600 dark:text-gray-400">
                                        <span class="inline-block w-4 h-4 rounded-full border border-gray-300" style="background-color: ${item.selectedColor.hex};"></span>
                                        <span>${item.selectedColor.name || 'Ù„ÙˆÙ† Ù…Ø®ØµØµ'}</span>
                                    </div>
                                ` : ''}
                            </div>
                            <div class="flex items-center gap-2 sm:gap-4">
                                <input type="number" value="${item.quantity}" min="1" class="cart-item-quantity w-16 px-3 py-2 rounded-lg bg-gray-100 dark:bg-[#3d474e] border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00]" data-cart-item-id="${item.cartItemId}">
                                <p class="text-lg font-bold w-28 text-right">${(parseFloat(item.price) * item.quantity).toFixed(2)} EGP</p>
                                <button class="remove-from-cart-btn text-red-500 hover:text-red-400" data-cart-item-id="${item.cartItemId}" title="Remove item">
                                    <i data-lucide="trash-2" class="w-5 h-5"></i>
                                </button>
                            </div>
                        </div>
                    `).join('');

                    const subtotal = cart.reduce((sum, item) => sum + (parseFloat(item.price) * item.quantity), 0);
                    cartSubtotalEl.textContent = `${subtotal.toFixed(2)} EGP`;
                    cartTotalEl.textContent = `${subtotal.toFixed(2)} EGP`; 

                    addCartItemListeners();
                }
                lucide.createIcons();
            }

            function addCartItemListeners() {
                document.querySelectorAll('.remove-from-cart-btn').forEach(btn => {
                    const newBtn = btn.cloneNode(true);
                    btn.parentNode.replaceChild(newBtn, btn);
                    newBtn.addEventListener('click', (e) => {
                        // --- MODIFIED to use cart-item-id ---
                        const cartItemId = e.currentTarget.dataset.cartItemId;
                        removeFromCart(cartItemId);
                    });
                });

                document.querySelectorAll('.cart-item-quantity').forEach(input => {
                    const newInput = input.cloneNode(true);
                    input.parentNode.replaceChild(newInput, input);
                    newInput.addEventListener('change', (e) => {
                        // --- MODIFIED to use cart-item-id ---
                        const cartItemId = e.currentTarget.dataset.cartItemId;
                        const newQuantity = parseInt(e.currentTarget.value, 10);
                        updateCartQuantity(cartItemId, newQuantity);
                    });
                });
            }

            function removeFromCart(cartItemId) {
                // --- MODIFIED to filter by cartItemId ---
                cart = cart.filter(item => item.cartItemId !== cartItemId);
                updateCartView();
                renderCartPage();
            }

            function updateCartQuantity(cartItemId, quantity) {
                if (quantity < 1) {
                    removeFromCart(cartItemId);
                    return;
                }
                // --- MODIFIED to find by cartItemId ---
                const product = cart.find(item => item.cartItemId === cartItemId);
                if (product) {
                    product.quantity = quantity;
                }
                updateCartView();
                renderCartPage();
            }

            // Updated generateWhatsAppInvoice to accept customer data
            function generateWhatsAppInvoice(customerData = null) {
                if (cart.length === 0) {
                    showToast("Ø³Ù„Ù‘ØªÙƒ ÙØ§Ø±ØºØ©.");
                    return;
                }

                const storePhone = "201146641942";
                const orderId = generateShortId(6).toUpperCase();
                const now = new Date();
                const dateStr = now.toLocaleDateString('ar-EG');
                const timeStr = now.toLocaleTimeString('ar-EG', { hour: '2-digit', minute: '2-digit' });

                let message = `ğŸ‘‹ Ù…Ø±Ø­Ø¨Ø§Ù‹ Ù…ØªØ¬Ø± Ù…ÙƒØ©ØŒ Ø£ÙˆØ¯ ØªØ£ÙƒÙŠØ¯ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯:\n\n`;
                
                if (customerData) {
                    message += `ğŸ‘¤ *Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„:*\n`;
                    message += `â–ª Ø§Ù„Ø§Ø³Ù…: ${customerData.name}\n`;
                    message += `â–ª Ø§Ù„Ù‡Ø§ØªÙ: ${customerData.phone}\n`;
                    message += `â–ª Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: ${customerData.address}\n`;
                    if (customerData.notes) {
                        message += `ğŸ“ Ù…Ù„Ø§Ø­Ø¸Ø§Øª: ${customerData.notes}\n`;
                    }
                    message += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n`;
                }

                message += `ğŸ§¾ *ÙØ§ØªÙˆØ±Ø© Ø·Ù„Ø¨ Ù…Ø¨Ø¯Ø¦ÙŠØ©*\n`;
                message += `ğŸ”– Ø±Ù‚Ù… Ø§Ù„Ù…Ø±Ø¬Ø¹: #${orderId}\n`;
                message += `ğŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ®: ${dateStr} - ${timeStr}\n`;
                message += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n`;
                
                message += `ğŸ“¦ *Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:*\n`;
                let subtotal = 0;
                cart.forEach((item, index) => {
                    const itemTotal = parseFloat(item.price) * item.quantity;
                    subtotal += itemTotal;
                    
                    // --- MODIFIED: Include color in invoice ---
                    const colorInfo = item.selectedColor ? ` (Ù„ÙˆÙ†: ${item.selectedColor.name || 'Ù…Ø®ØµØµ'})` : '';
                    message += `${index + 1}ï¸âƒ£ *${item.name}${colorInfo}*\n`;
                    // ------------------------------------------
                    message += `   â–ª Ø§Ù„ÙƒÙ…ÙŠØ©: ${item.quantity}\n`;
                    message += `   â–ª Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø©: ${parseFloat(item.price).toFixed(2)} EGP\n`;
                    message += `   â–ª Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: ${itemTotal.toFixed(2)} EGP\n`;
                    if (index < cart.length - 1) {
                        message += `   --------------------\n`;
                    }
                });

                message += `\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
                message += `ğŸ’° *Ù…Ù„Ø®Øµ Ø§Ù„Ø¯ÙØ¹:*\n`;
                message += `â–« Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ: ${subtotal.toFixed(2)} EGP\n`;
                message += `ğŸšš Ø§Ù„Ø´Ø­Ù†: ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯Ù‡ Ø¹Ù†Ø¯ Ø§Ù„ØªØ£ÙƒÙŠØ¯\n`;
                message += `ğŸ“¢ *Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: ${subtotal.toFixed(2)} EGP*\n`;
                message += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n`;
                message += `ğŸ“ *ÙŠØ±Ø¬Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø·Ù„Ø¨ ÙˆØªØ£ÙƒÙŠØ¯Ù‡.*\n`;
                message += `Ø´ÙƒØ±Ø§Ù‹ Ù„ÙƒÙ…!`;
                
                const encodedMessage = encodeURIComponent(message);
                const whatsappUrl = `https://api.whatsapp.com/send?phone=${storePhone}&text=${encodedMessage}`;

                window.open(whatsappUrl, '_blank');
            }

            
            function setupAddToCartButtons() {
                document.querySelectorAll('.add-to-cart-btn').forEach(btn => {
                    // FIX: Use strict comparison to avoid issues with 'false' string
                    if (btn.dataset.listenerAttached === 'true') return;
                    btn.dataset.listenerAttached = 'true';

                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        e.preventDefault();
                        
                        const card = e.currentTarget.closest('.product-card-wrapper');
                        if (!card) return;

                        const product = {
                            id: card.dataset.productId,
                            name: card.dataset.productName,
                            price: card.dataset.productPrice,
                            image: card.dataset.productImage
                        };

                        // --- NEW: If on details page, attach selected color ---
                        if (card.id === 'details-add-to-cart-wrapper' && currentSelectedColor) {
                            product.selectedColor = currentSelectedColor;
                        }
                        // -----------------------------------------------------
                        
                        // Check availability before adding to cart (redundant safety check)
                        const isUnavailable = btn.classList.contains('disabled');
                        if (isUnavailable) {
                             showToast("Ø¹Ø°Ø±Ø§Ù‹ØŒ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ ØºÙŠØ± Ù…ØªÙˆÙØ± Ø­Ø§Ù„ÙŠØ§Ù‹.");
                             return;
                        }

                        let quantityToAdd = 1;
                        const quantityInput = card.querySelector('#details-quantity-input');
                        if (quantityInput) {
                            quantityToAdd = parseInt(quantityInput.value, 10) || 1;
                            if (quantityToAdd < 1) quantityToAdd = 1;
                        }

                        
                        addToCart(product, quantityToAdd);
                    });
                });
            }
            


            
            const modal = document.getElementById('add-product-modal');
            const modalTitle = document.getElementById('modal-title'); 
            const modalSubmitBtn = document.getElementById('modal-submit-btn'); 
            
            const closeModalBtn = document.getElementById('close-add-product-modal-btn');
            const cancelModalBtn = document.getElementById('cancel-add-product-btn');
            const addProductForm = document.getElementById('add-product-form');
            const isOnSaleCheckbox = document.getElementById('isOnSale');
            const originalPriceContainer = document.getElementById('original-price-container');

            
            
            
            
            function resetModalToAddMode() {
                if(modalTitle) modalTitle.textContent = "Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯";
                if(modalSubmitBtn) modalSubmitBtn.textContent = "Ø­ÙØ¸ Ø§Ù„Ù…Ù†ØªØ¬";
                if(addProductForm) {
                    addProductForm.reset();
                    delete addProductForm.dataset.editingId; 
                }
                if(originalPriceContainer) originalPriceContainer.classList.add('hidden');
                // Ensure 'Available' is checked by default for new products
                const availCheck = document.getElementById('isAvailable');
                if(availCheck) availCheck.checked = true;
                
                // --- NEW: Clear color variants container ---
                const colorContainer = document.getElementById('color-variants-container');
                if (colorContainer) colorContainer.innerHTML = '';
                // -------------------------------------------
            }

            // FIX: Ensure close buttons also reset the inline style
            if(closeModalBtn) closeModalBtn.addEventListener('click', () => {
                resetModalToAddMode(); 
                modal.classList.add('hidden');
                modal.style.display = ''; // Clear inline style
            });
            if(cancelModalBtn) cancelModalBtn.addEventListener('click', () => {
                resetModalToAddMode(); 
                modal.classList.add('hidden');
                modal.style.display = ''; // Clear inline style
            });
            
            if(isOnSaleCheckbox) isOnSaleCheckbox.addEventListener('change', (e) => {
                if (e.target.checked) {
                    originalPriceContainer.classList.remove('hidden');
                } else {
                    originalPriceContainer.classList.add('hidden');
                }
            });
                if(addProductForm) addProductForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const editingId = addProductForm.dataset.editingId; 

                
                const imageUrlsString = document.getElementById('productImageUrls').value;
                const imageUrls = imageUrlsString.split(',')       
                                                .map(url => url.trim())   
                                                .filter(url => url && url.length > 0); 

                // --- NEW: Collect Color Variants Data ---
                const colorVariants = [];
                document.querySelectorAll('.color-variant-row').forEach(row => {
                    const color = row.querySelector('.color-input').value;
                    const name = row.querySelector('.color-name-input').value.trim();
                    const image = row.querySelector('.color-image-input').value.trim();
                    if (color) {
                        colorVariants.push({ hex: color, name: name, imageUrl: image });
                    }
                });
                // ----------------------------------------

                const productData = { 
                    name: document.getElementById('productName').value,
                    price: parseFloat(document.getElementById('productPrice').value),
                    
                    imageUrls: imageUrls, 
                    category: document.getElementById('productCategory').value,
                    description: document.getElementById('productDescription').value,
                    isOnSale: document.getElementById('isOnSale').checked,
                    isBestSeller: document.getElementById('isBestSeller').checked,
                    isAvailable: document.getElementById('isAvailable').checked, // <-- NEW FIELD
                    originalPrice: document.getElementById('isOnSale').checked ? parseFloat(document.getElementById('originalPrice').value) : 0,
                    createdAt: Timestamp.now(),
                    // NEW: Sale End Date
                    saleEndDate: document.getElementById('saleEndDate').value ? Timestamp.fromDate(new Date(document.getElementById('saleEndDate').value)) : null,

                    
                    company: document.getElementById('productCompany').value,
                    volts: document.getElementById('productVolts').value,
                    length: document.getElementById('productLength').value,
                    warranty: document.getElementById('productWarranty').value,
                    madeIn: document.getElementById('productMadeIn').value,
                    model: document.getElementById('productModel').value,
                    lumens: document.getElementById('productLumens').value,
                    lifespan: document.getElementById('productLifespan').value,
                    currentIntensity: document.getElementById('productCurrent').value,
                    watt: document.getElementById('productWatt').value,
                    sizes: document.getElementById('productSizes').value,
                    // NEW: Add weight and size
                    weight: document.getElementById('productWeight').value,
                    size: document.getElementById('productSize').value,
                    // Removed old 'colors' string field, replaced with 'colorOptions' array
                    colorOptions: colorVariants 
                };
                try {
                    if (editingId) {
                        
                        const productRef = doc(db, "products", editingId);
                        await updateDoc(productRef, productData);
                        showToast("ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­!");
                    } else {
                        
                        productData.createdAt = Timestamp.now(); 
                        productData.shortId = generateShortId(5); 
                        await addDoc(collection(db, "products"), productData);
                        showToast("ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­!");
                    }
                    
                    resetModalToAddMode(); 
                    modal.classList.add('hidden'); 
                    modal.style.display = ''; // Clear inline style after save
                    
                } catch (error) {
                    console.error("Error saving document: ", error);
                    showToast("Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ù…Ù†ØªØ¬. Ø±Ø§Ø¬Ø¹ Ø§Ù„ÙƒÙˆÙ†Ø³ÙˆÙ„.");
                }
            });


            const articleModal = document.getElementById('add-article-modal');
            const articleModalTitle = document.getElementById('article-modal-title');
            const articleModalSubmitBtn = document.getElementById('article-modal-submit-btn');
            const closeArticleModalBtn = document.getElementById('close-add-article-modal-btn');
            const cancelArticleModalBtn = document.getElementById('cancel-add-article-btn');
            const addArticleForm = document.getElementById('add-article-form');


            function escapeHTML(str) {
                if (typeof str !== 'string') return '';
                return str.replace(/[&<>"']/g, function(match) {
                    return {
                        '&': '&amp;',
                        '<': '&lt;',
                        '>': '&gt;',
                        '"': '&quot;',
                        "'": '&#39;'
                    }[match];
                });
            }


            function createParagraphBlock(title = '', body = '') {
                const container = document.getElementById('article-paragraphs-container');
                if (!container) return;

                const block = document.createElement('div');

                block.className = 'content-block paragraph-block bg-gray-50 dark:bg-[#3d474e] p-3 rounded-lg border border-gray-200 dark:border-gray-600 relative';
                block.dataset.type = 'paragraph'; 
                
                    block.innerHTML = `
                    <button type="button" class="remove-block-btn absolute -top-2 -right-2 p-1 bg-red-500 text-white rounded-full hover:bg-red-600 z-10" title="Remove block">
                        <i data-lucide="x" class="w-3 h-3"></i>
                    </button>
                    <div>
                        <label class="block text-xs font-medium mb-1 flex items-center gap-2">
                            <span class="paragraph-number text-base font-bold text-gray-500 dark:text-gray-400">1.</span>
                            <span>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙÙ‚Ø±Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</span>
                        </label>
                        <input type="text" class="paragraph-title w-full px-3 py-2 text-sm rounded-lg bg-white dark:bg-gray-800 border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00]" value="${escapeHTML(title)}">
                    </div>
                    <div class="mt-2">
                        <label class="block text-xs font-medium mb-1">Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ÙÙ‚Ø±Ø© (Ø§ÙƒØªØ¨ ÙƒÙ„ Ù†Ù‚Ø·Ø© ÙÙŠ Ø³Ø·Ø± Ù…Ø³ØªÙ‚Ù„)</label>
                        <textarea class="paragraph-body w-full px-3 py-2 text-sm rounded-lg bg-white dark:bg-gray-800 border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00]" rows="3">${escapeHTML(body)}</textarea>
                    </div>
                `;


                block.querySelector('.remove-block-btn').addEventListener('click', () => {
                    block.remove();
                    reNumberParagraphBlocks(); 
                });

                container.appendChild(block);
                lucide.createIcons();
            }


            function createGalleryBlock(images = []) {
                const container = document.getElementById('article-paragraphs-container');
                if (!container) return;

                const block = document.createElement('div');
                block.className = 'content-block gallery-block bg-gray-50 dark:bg-[#3d474e] p-3 rounded-lg border border-gray-200 dark:border-gray-600 relative';
                block.dataset.type = 'gallery'; 
                

                const imageUrls = images.join(', ');

                    block.innerHTML = `
                    <button type="button" class="remove-block-btn absolute -top-2 -right-2 p-1 bg-red-500 text-white rounded-full hover:bg-red-600 z-10" title="Remove block">
                        <i data-lucide="x" class="w-3 h-3"></i>
                    </button>
                    <div>
                        <label class="block text-sm font-medium mb-1 flex items-center gap-2">
                            <i data-lucide="image" class="w-4 h-4 text-gray-500 dark:text-gray-400"></i>
                            <span>Ù…Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±</span>
                        </label>
                        <textarea class="gallery-urls w-full px-3 py-2 text-sm rounded-lg bg-white dark:bg-gray-800 border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00]" rows="3" placeholder="Ø§Ù„ØµÙ‚ Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ØµÙˆØ±ØŒ Ù…ÙØµÙˆÙ„Ø© Ø¨ÙØ§ØµÙ„Ø©...">${escapeHTML(imageUrls)}</textarea>
                    </div>
                `;


                block.querySelector('.remove-block-btn').addEventListener('click', () => {
                    block.remove();

                });

                container.appendChild(block);
                lucide.createIcons();
            }


            const addParagraphBtn = document.getElementById('add-paragraph-btn');
            if (addParagraphBtn) {
                addParagraphBtn.addEventListener('click', () => {
                    createParagraphBlock(); 
                    reNumberParagraphBlocks();
                });
            }
            
            const addGalleryBtn = document.getElementById('add-gallery-btn');
            if (addGalleryBtn) {
                addGalleryBtn.addEventListener('click', () => {
                    createGalleryBlock(); 

                });
            }


            function reNumberParagraphBlocks() {
                const container = document.getElementById('article-paragraphs-container');
                if (!container) return;
                
                let paragraphCounter = 1;
                const blocks = container.querySelectorAll('.content-block');
                
                blocks.forEach((block) => {
                    
                    if (block.dataset.type === 'paragraph') {
                        const numSpan = block.querySelector('.paragraph-number');
                        if (numSpan) {
                            numSpan.textContent = `${paragraphCounter}.`;
                        }
                        paragraphCounter++;
                    }
                });
            }

            function resetArticleModalToAddMode() {
                if(articleModalTitle) articleModalTitle.textContent = "Ø¥Ø¶Ø§ÙØ© Ù…Ù‚Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©";
                if(articleModalSubmitBtn) articleModalSubmitBtn.textContent = "Ø­ÙØ¸ Ø§Ù„Ù…Ù‚Ø§Ù„Ø©";
                if(addArticleForm) {
                    addArticleForm.reset();
                    delete addArticleForm.dataset.editingId;
                }
                
                
                const container = document.getElementById('article-paragraphs-container');
                if (container) {
                    container.innerHTML = '';
                }
                createParagraphBlock();
                reNumberParagraphBlocks();
                
            }

            if(closeArticleModalBtn) closeArticleModalBtn.addEventListener('click', () => {
                resetArticleModalToAddMode();
                if(articleModal) articleModal.classList.add('hidden');
            });
            if(cancelArticleModalBtn) cancelArticleModalBtn.addEventListener('click', () => {
                resetArticleModalToAddMode();
                if(articleModal) articleModal.classList.add('hidden');
            });

            // Terms Modal JavaScript (REMOVED)

            const helpModal = document.getElementById('gemini-help-modal');
            const openHelpBtn = document.getElementById('open-help-modal-btn');
            const closeHelpBtn = document.getElementById('close-help-modal-btn');

            if (openHelpBtn && helpModal) {
                openHelpBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    helpModal.classList.remove('hidden');
                    // Use requestAnimationFrame to ensure the class removal is processed 
                    // before setting data-state, allowing the transition to work.
                    requestAnimationFrame(() => {
                        helpModal.dataset.state = 'open';
                    });
                });
            }

            if (closeHelpBtn && helpModal) {
                closeHelpBtn.addEventListener('click', () => {
                    helpModal.dataset.state = 'closed';
                    // Wait for the transition to finish before hiding
                    setTimeout(() => {
                        helpModal.classList.add('hidden');
                    }, 300);
                });
            }

            const helpForm = document.getElementById('help-form');
            if (helpForm) {
                helpForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const input = document.getElementById('help-input');
                    if (!input || !input.value.trim()) return;

                    const userText = input.value.trim();
                    input.value = ''; // Ù…Ø³Ø­ Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„
                    
                    const chatHistoryEl = document.getElementById('chat-history');
                    const loadingIndicator = document.getElementById('loading-indicator');
                    
                    // 1. Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                    const userMsg = document.createElement('div');
                    userMsg.className = 'user-message';
                    userMsg.textContent = userText;
                    chatHistoryEl.insertBefore(userMsg, loadingIndicator);
                    chatHistoryEl.scrollTop = chatHistoryEl.scrollHeight;

                    // 2. Ø¥Ø¸Ù‡Ø§Ø± Ù…Ø¤Ø´Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„
                    if (loadingIndicator) {
                        loadingIndicator.classList.remove('hidden');
                        loadingIndicator.classList.add('flex');
                    }
                    chatHistoryEl.scrollTop = chatHistoryEl.scrollHeight;

                    // 3. ØªØ¬Ù‡ÙŠØ² Ø³ÙŠØ§Ù‚ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù„Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
                    const productsContext = allProducts.map(p => 
                        `- ${p.name} (${p.price} EGP) [${p.isAvailable !== false ? 'Ù…ØªÙˆÙØ±' : 'ØºÙŠØ± Ù…ØªÙˆÙØ±'}]`
                    ).join('\n');

                    const systemPrompt = `Ø£Ù†Øª Ù…Ø³Ø§Ø¹Ø¯ Ù…Ø¨ÙŠØ¹Ø§Øª Ø®Ø¨ÙŠØ± Ù„Ù€ "Ù…ØªØ¬Ø± Ù…ÙƒØ© Ù„Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©".
Ù‡Ø¯ÙÙ†Ø§ Ù…Ø³Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ÙÙŠ Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© Ù…Ù† Ù‚Ø§Ø¦Ù…ØªÙ†Ø§ Ø§Ù„Ø­Ø§Ù„ÙŠØ© ÙÙ‚Ø·:
${productsContext}

Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø±Ø¯:
- ØªØ­Ø¯Ø« Ø¨Ù„Ù‡Ø¬Ø© ÙˆØ¯ÙˆØ¯Ø© ÙˆÙ…Ø­ØªØ±ÙØ© (Ù…ØµØ±ÙŠØ© Ø£Ùˆ ÙØµØ­Ù‰ Ø¨Ø³ÙŠØ·Ø©).
- Ù„Ø§ ØªÙ‚ØªØ±Ø­ Ø£Ø¨Ø¯Ø§Ù‹ Ù…Ù†ØªØ¬Ø§Øª ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø£Ø¹Ù„Ø§Ù‡.
- Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ù†ØªØ¬ "ØºÙŠØ± Ù…ØªÙˆÙØ±"ØŒ Ø£Ø®Ø¨Ø± Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¨Ø°Ù„Ùƒ ÙˆØ§Ù‚ØªØ±Ø­ Ø¨Ø¯ÙŠÙ„Ø§Ù‹ Ù…Ø´Ø§Ø¨Ù‡Ø§Ù‹ "Ù…ØªÙˆÙØ±" Ø¥Ù† ÙˆØ¬Ø¯.
- Ø§Ø¬Ø¹Ù„ Ø±Ø¯ÙˆØ¯Ùƒ Ù‚ØµÙŠØ±Ø©ØŒ Ù…Ø¨Ø§Ø´Ø±Ø©ØŒ ÙˆÙ…ÙÙŠØ¯Ø©. Ø´Ø¬Ø¹ Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±Ø§Ø¡ Ø¨Ù„Ø·Ù.`;

                    // Ø¥Ø¶Ø§ÙØ© Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ù„Ø³Ø¬Ù„
                    aiChatHistory.push({ role: "user", parts: [{ text: userText }] });

                    // 4. Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ Gemini API
                    try {
                        // ØªÙ†Ø¨ÙŠÙ‡ Ù‡Ø§Ù…: Ø¥Ø°Ø§ ÙƒÙ†Øª ØªØ³ØªØ®Ø¯Ù… Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ Ø®Ø§Ø±Ø¬ Ø¨ÙŠØ¦Ø© Ø§Ù„ØªØ·ÙˆÙŠØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ©ØŒ ÙŠØ¬Ø¨ Ø¹Ù„ÙŠÙƒ ÙˆØ¶Ø¹ Ù…ÙØªØ§Ø­ API Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ù‡Ù†Ø§.
                        // ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„ÙŠÙ‡ Ù…Ù†: https://aistudio.google.com/app/apikey
                        const apiKey = "AIzaSyBPE9qC_o61aeUXq11youK0EH73fhMEmfI"; 
                        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
                        
                        const payload = {
                            contents: aiChatHistory,
                            systemInstruction: { parts: [{ text: systemPrompt }] }
                        };

                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });

                        if (!response.ok) {
                            const errorData = await response.text();
                            console.error("AI API Error Details:", response.status, errorData);
                            throw new Error(`HTTP Error: ${response.status} - Check Console for details`);
                        }

                        const data = await response.json();
                        const aiResponseText = data.candidates?.[0]?.content?.parts?.[0]?.text;

                        if (aiResponseText) {
                            // 5. Ø¹Ø±Ø¶ Ø±Ø¯ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯
                            const aiMsg = document.createElement('div');
                            aiMsg.className = 'model-message';
                            // ØªØ­ÙˆÙŠÙ„ ØªÙ†Ø³ÙŠÙ‚ markdown Ø§Ù„Ø¨Ø³ÙŠØ· (ØªØºÙ…ÙŠÙ‚ Ø§Ù„Ù†Øµ) Ø¥Ù„Ù‰ HTML
                            aiMsg.innerHTML = aiResponseText.replace(/\*\*(.*?)\*\*/g, '<b>$1</b>').replace(/\n/g, '<br>');
                            chatHistoryEl.insertBefore(aiMsg, loadingIndicator);
                            
                            // Ø¥Ø¶Ø§ÙØ© Ø±Ø¯ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ù„Ù„Ø³Ø¬Ù„ Ù„Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©
                            aiChatHistory.push({ role: "model", parts: [{ text: aiResponseText }] });
                        }

                    } catch (error) {
                        console.error("Full AI Chat Error:", error);
                        const errorMsg = document.createElement('div');
                        errorMsg.className = 'model-message bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400';
                        errorMsg.textContent = "Ø¹Ø°Ø±Ø§Ù‹ØŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙ†ÙŠ. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ØªØµØ§Ù„Ùƒ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª ÙˆØ§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ù‚Ø±ÙŠØ¨Ø§Ù‹.";
                        chatHistoryEl.insertBefore(errorMsg, loadingIndicator);
                        aiChatHistory.pop(); // Ø¥Ø²Ø§Ù„Ø© Ø¢Ø®Ø± Ø±Ø³Ø§Ù„Ø© Ù…Ø³ØªØ®Ø¯Ù… Ù„ØªØ¬Ù†Ø¨ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„Ù…ØªØ±Ø§ÙƒÙ…Ø©
                    } finally {
                        // 6. Ø¥Ø®ÙØ§Ø¡ Ù…Ø¤Ø´Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„
                        if (loadingIndicator) {
                            loadingIndicator.classList.add('hidden');
                            loadingIndicator.classList.remove('flex');
                        }
                        chatHistoryEl.scrollTop = chatHistoryEl.scrollHeight;
                    }
                });
            }

            // ØªÙØ¹ÙŠÙ„ Ø²Ø± "Ù…Ø­Ø§Ø¯Ø«Ø© Ø¬Ø¯ÙŠØ¯Ø©" Ù„Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„
            const clearChatBtn = document.getElementById('clear-chat-btn');
            if (clearChatBtn) {
                clearChatBtn.addEventListener('click', () => {
                    aiChatHistory = [];
                    const chatHistoryEl = document.getElementById('chat-history');
                    const loadingIndicator = document.getElementById('loading-indicator');
                    if (chatHistoryEl && loadingIndicator) {
                        chatHistoryEl.innerHTML = `
                            <div class="model-message self-start">
                                Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ Ù…Ø¬Ø¯Ø¯Ø§Ù‹ ÙÙŠ Ù…ØªØ¬Ø± Ù…ÙƒØ©! ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù†ØªØ¬Ø§ØªÙƒ Ø§Ù„ÙŠÙˆÙ…ØŸ
                            </div>
                        `;
                        chatHistoryEl.appendChild(loadingIndicator);
                    }
                });
            }

            if(addArticleForm) addArticleForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const editingId = addArticleForm.dataset.editingId;

                
                const contentArray = [];
                document.querySelectorAll('#article-paragraphs-container .content-block').forEach(block => {
                    const type = block.dataset.type;
                    
                    if (type === 'paragraph') {
                        const title = block.querySelector('.paragraph-title').value.trim();
                        const body = block.querySelector('.paragraph-body').value.trim();
                        
                        if (title || body) {
                            contentArray.push({ type: 'paragraph', title: title, body: body });
                        }
                    } else if (type === 'gallery') {
                        const urlsText = block.querySelector('.gallery-urls').value;
                        const images = urlsText.split(',')
                                            .map(url => url.trim())
                                            .filter(url => url.length > 0);
                        
                        if (images.length > 0) {
                            contentArray.push({ type: 'gallery', images: images });
                        }
                    }
                });
                

                const articleData = {
                    title: document.getElementById('articleTitle').value,
                    imageUrl: document.getElementById('articleImageUrl').value,
                    
                    content: contentArray,
                };

                try {
                    if (editingId) {
                        
                        const articleRef = doc(db, "articles", editingId);
                        await updateDoc(articleRef, articleData);
                        showToast("ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù‚Ø§Ù„Ø© Ø¨Ù†Ø¬Ø§Ø­!");
                    } else {
                        
                        articleData.createdAt = Timestamp.now();
                        articleData.shortId = generateShortId(5); 
                        await addDoc(collection(db, "articles"), articleData);
                        showToast("ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù‚Ø§Ù„Ø© Ø¨Ù†Ø¬Ø§Ø­!");
                    }
                    resetArticleModalToAddMode();
                    if(articleModal) articleModal.classList.add('hidden');
                } catch (error) {
                    console.error("Error saving article: ", error);
                    showToast("Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ù…Ù‚Ø§Ù„Ø©. Ø±Ø§Ø¬Ø¹ Ø§Ù„ÙƒÙˆÙ†Ø³ÙˆÙ„.");
                }
            });
            


            function renderProductCard(product) {
                
                
                const mainImg = (product.imageUrls && product.imageUrls[0]) ? product.imageUrls[0] : (product.imageUrl || 'https://placehold.co/400x400/eeeeee/777777?text=Image+Error');

                // MODIFIED: Use isOfferActive helper
                const offerActive = isOfferActive(product);

                const priceHTML = offerActive
                    ? `<div class="flex items-baseline gap-1.5">
                           <span class="text-lg font-bold text-[#ffcd00]">${product.price.toFixed(2)} EGP</span>
                           <span class="text-sm text-gray-500 dark:text-gray-400 line-through">${product.originalPrice.toFixed(2)} EGP</span>
                       </div>`
                    : `<div class="flex items-baseline gap-1.5">
                           <span class="text-lg font-bold text-gray-900 dark:text-white">${product.price.toFixed(2)} EGP</span>
                        </div>`;

                let saleBadge = '';
                let countdownBadge = ''; // NEW

                // MODIFIED: Check offerActive instead of just isOnSale
                if (product.isAvailable !== false && offerActive) {
                    if (product.originalPrice && product.originalPrice > product.price) {
                        const discountPercent = Math.round(((product.originalPrice - product.price) / product.originalPrice) * 100);
                        if (discountPercent > 0) {
                            saleBadge = `<div class="sale-badge"><span>Ø®ØµÙ… ${discountPercent}%</span></div>`;
                        } else {
                            saleBadge = `<div class="sale-badge"><span>Ø¹Ø±Ø¶ Ù…Ù…ÙŠØ²</span></div>`;
                        }
                    } else {
                        saleBadge = `<div class="sale-badge"><span>Ø¹Ø±Ø¶</span></div>`;
                    }

                    // NEW: Add Countdown if end date exists
                    const remaining = getRemainingTime(product);
                    if (remaining) {
                        countdownBadge = `
                            <div class="absolute bottom-2 right-2 z-20 px-2 py-1 bg-black/70 text-white text-[10px] font-medium rounded-md backdrop-blur-sm flex items-center gap-1">
                                <i data-lucide="timer" class="w-3 h-3 text-[#ffcd00]"></i>
                                <span>Ù…ØªØ¨Ù‚ÙŠ ${remaining}</span>
                            </div>`;
                    }
                }

                // --- NEW STATUS BADGE (FOR UNAVAILABLE ITEMS) ---
                let statusBadge = '';
                let imageClass = 'w-full h-36 sm:h-48 lg:h-56 object-cover';
                let addToCartBtnState = '';
                let addToCartBtnTitle = 'Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©';

                if (product.isAvailable === false) {
                    statusBadge = `<div class="absolute top-3 left-3 z-30 px-3 py-1.5 bg-gray-900/90 text-white text-xs font-bold rounded-full backdrop-blur-sm shadow-sm border border-white/10">ØºÙŠØ± Ù…ØªÙˆÙØ±</div>`;
                    imageClass += ' grayscale opacity-80'; // Make unavailable items look different
                    addToCartBtnState = 'disabled opacity-50 cursor-not-allowed bg-gray-300 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-600 shadow-none transform-none';
                    addToCartBtnTitle = 'ØºÙŠØ± Ù…ØªÙˆÙØ± Ø­Ø§Ù„ÙŠØ§Ù‹';
                } else {
                     addToCartBtnState = 'bg-[#ffcd00] hover:bg-[#ffda33] shadow-lg hover:shadow-xl hover:-translate-y-0.5';
                }
                // ------------------------------------------------


                // --- NEW SPECIAL BADGE (CROWN ICON WITH TEXT) LOGIC ---
                let crownIcon = '';
                if (product.isBestSeller) {
                    crownIcon = `
                        <div class="special-crown-badge" title="Ù…Ù† Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø£ÙƒØ«Ø± Ù…Ø¨ÙŠØ¹Ø§Ù‹">
                            <i data-lucide="crown"></i>
                            <span>Ù…Ù…ÙŠØ²</span>
                        </div>`;
                }
                // ------------------------------------------------------
                
                let descriptionSnippet = '';
                if (product.description && product.description.trim() !== '') {
                    const words = product.description.split(' ');
                    // ... (existing description snippet logic if any, though it seems unused in card)
                }
                
                const deleteButtonHTML = currentIsAdmin
                    ? `<button class="delete-product-btn p-1.5 bg-red-600 text-white rounded-full hover:bg-red-700" title="Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬" data-product-id="${product.id}">
                           <i data-lucide="trash-2" class="w-4 h-4"></i>
                       </button>`
                    : '';
                
                const editButtonHTML = currentIsAdmin
                    ? `<button class="edit-product-btn p-1.5 bg-blue-600 text-white rounded-full hover:bg-blue-700" title="ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬" data-product-id="${product.id}">
                           <i data-lucide="edit-3" class="w-4 h-4"></i>
                       </button>`
                    : '';
                
                const adminButtonsHTML = currentIsAdmin
                    ? `<div class="absolute top-3 right-3 z-30 flex flex-col gap-1.5">
                            ${editButtonHTML}
                            ${deleteButtonHTML}
                       </div>`
                    : '';

                return `
                <div class="product-card-wrapper bg-white dark:bg-[#2c2f38] rounded-2xl overflow-hidden shadow-md border border-gray-200 dark:border-gray-700 flex flex-col transition-all duration-300 hover:shadow-xl hover:border-[#ffcd00]/50"
                     data-product-id="${product.id}"
                     data-product-name="${product.name}"
                     data-product-price="${product.price}"
                     data-product-image="${mainImg}">
                    
                    <div class="relative overflow-hidden">
                        ${saleBadge}
                        ${statusBadge}
                        ${countdownBadge} <!-- Inserted Countdown Badge -->
                        <a href="#product/${product.shortId || product.id}" class="product-details-link" data-product-id="${product.id}">
                            <img class="${imageClass}" 
                                 src="${mainImg}" 
                                 onerror="this.src='https://placehold.co/400x400/eeeeee/777777?text=Image+Error'"
                                 alt="${product.name}">
                        </a>
                        ${adminButtonsHTML}
                    </div>

                    <div class="p-4 flex-grow flex flex-col">
                        
                        <!-- MODIFIED: Company Name -->
                        ${product.company ? `
                        <span class="flex items-center gap-1.5 text-xs font-medium text-amber-700 dark:text-amber-500 mb-1 truncate" title="${product.company}">
                            <i data-lucide="tag" class="w-3 h-3 flex-shrink-0"></i>
                            <span class="truncate">${product.company}</span>
                        </span>
                        ` : ''}
                        <!-- END MODIFIED -->
                        
                        <div class="flex justify-between items-start gap-2 mb-2">
                            <a href="#product/${product.shortId || product.id}" class="product-details-link flex-grow truncate" data-product-id="${product.id}" title="${product.name}">
                                <h3 class="text-base font-semibold text-gray-800 dark:text-white product-name">${product.name}</h3>
                            </a>
                        </div>
                        
                        <div class="flex items-center mb-2">
                            <div class="star-rating text-sm">
                                ${generateStarRating()}
                            </div>
                            ${crownIcon} <!-- Inserted Crown Icon Here -->
                        </div>

                        <div class="mt-auto pt-2 space-y-3">
                            <div class="flex items-center justify-between gap-4">
                                ${priceHTML}
                            </div>
                            
                            
                            <div class="flex items-center gap-2">
                                <a href="#product/${product.shortId || product.id}" class="product-details-link flex-1 text-center px-4 py-2 bg-transparent border border-[#ffcd00] text-[#ffcd00] text-sm font-semibold rounded-lg hover:bg-[#ffcd00] hover:text-gray-900 dark:hover:text-gray-900 transition-colors" data-product-id="${product.id}">
                                    Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„
                                </a>
                                <button class="add-to-cart-btn flex-shrink-0 p-2 text-gray-900 rounded-lg transition-all duration-300 ${addToCartBtnState}" title="${addToCartBtnTitle}">
                                    <i data-lucide="shopping-cart" class="w-5 h-5"></i>
                                 </button>
                            </div>
                            
                        </div>
                    </div>
                </div>`;
            }

            
            function generateStarRating() {
                
                const rating = Math.floor(Math.random() * 3) + 3;
                let starsHTML = '';
                for (let i = 1; i <= 5; i++) {
                    if (i <= rating) {
                        starsHTML += '<span>â˜…</span>';
                    } else {
                        starsHTML += '<span class="text-gray-300 dark:text-gray-600">â˜†</span>';
                    }
                }
                return starsHTML;
            }
            

            function renderAllProductViews() {
                // ... (existing code)
                // We might want to call renderOffersPage here too if data changes, 
                // but showPage handles it on navigation.
                if (document.getElementById('page-offers').classList.contains('active')) {
                    renderOffersPage();
                }

                const searchTerm = document.getElementById('product-search-input').value.toLowerCase();
                const category = document.getElementById('product-category-filter').value;
                const brand = document.getElementById('product-brand-filter').value; // NEW
                const sort = document.getElementById('product-sort-filter').value;

                
                let filteredProducts = allProducts;

                
                if (preFilterType === 'sale') {
                    filteredProducts = allProducts.filter(p => p.isOnSale);
                } else if (preFilterType === 'bestseller') {
                    filteredProducts = allProducts.filter(p => p.isBestSeller);
                }
                

                
                // MODIFIED: Search in name AND company
                filteredProducts = filteredProducts.filter(p => 
                    p.name.toLowerCase().includes(searchTerm) ||
                    (p.company && p.company.toLowerCase().includes(searchTerm)) // NEW
                );

                if (category !== 'all') {
                    filteredProducts = filteredProducts.filter(p => p.category === category);
                }

                // NEW: Filter by brand
                if (brand !== 'all') {
                    filteredProducts = filteredProducts.filter(p => p.company === brand);
                }

                
                if (sort === 'price-asc') {
                    filteredProducts.sort((a, b) => a.price - b.price);
                } else if (sort === 'price-desc') {
                    filteredProducts.sort((a, b) => b.price - a.price);
                }

                const offersGrid = document.getElementById('home-offers-grid');
                const bestsellersGrid = document.getElementById('home-bestsellers-grid');
                const productsGrid = document.getElementById('products-grid');
                const noProductsMessage = document.getElementById('no-products-message');
                // NEW: Get the top offers grid element
                const topOffersSection = document.getElementById('current-offers-section');
                const topOffersGrid = document.getElementById('top-offers-grid');

                if (!offersGrid || !bestsellersGrid || !productsGrid) return;

                
                offersGrid.innerHTML = '';
                bestsellersGrid.innerHTML = '';
                productsGrid.innerHTML = '';
                if (topOffersGrid) topOffersGrid.innerHTML = ''; // Clear top offers grid

                // Filter out unavailable products from Offers/Bestsellers on Home Page? 
                // Maybe keep them but they will show as unavailable. Let's keep them for now so people see them even if out of stock.
                const offers = allProducts.filter(p => isOfferActive(p)); // MODIFIED: Use isOfferActive
                const bestsellers = allProducts.filter(p => p.isBestSeller).slice(0, 6); 

                // NEW: Populate Top Offers Section
                if (topOffersSection && topOffersGrid) {
                    if (offers.length > 0) {
                        offers.forEach(p => topOffersGrid.innerHTML += renderProductCard(p));
                        // Only show this section on 'home' page
                        if (document.getElementById('page-home').classList.contains('active')) {
                             topOffersSection.classList.remove('hidden');
                        } else {
                             topOffersSection.classList.add('hidden');
                        }
                    } else {
                        topOffersSection.classList.add('hidden');
                    }
                }

                offers.slice(0, 6).forEach(p => offersGrid.innerHTML += renderProductCard(p)); // Keep original offers section limited
                bestsellers.forEach(p => bestsellersGrid.innerHTML += renderProductCard(p));
                
                if (filteredProducts.length === 0) {
                    productsGrid.innerHTML = ''; 
                    productsGrid.classList.add('hidden'); 
                    noProductsMessage.classList.remove('hidden');
                } else {
                    noProductsMessage.classList.add('hidden');
                    productsGrid.classList.remove('hidden'); 
                    productsGrid.innerHTML = ''; 
                    filteredProducts.forEach(p => productsGrid.innerHTML += renderProductCard(p));
                }

                
                setupAddToCartButtons();
                setupDeleteProductButtons(); 
                setupEditProductButtons(); 
                // setupProductDetailsLinks(); // No longer needed, router handles this
                lucide.createIcons();
            }

            // NEW: Function to render dedicated offers page
            function renderOffersPage() {
                const grid = document.getElementById('offers-page-grid');
                const noOffersMsg = document.getElementById('no-offers-message');
                const avgTimerEl = document.getElementById('average-offer-timer');
                const avgDisplayEl = document.getElementById('average-timer-display');

                if (!grid || !noOffersMsg) return;

                grid.innerHTML = '';
                // Filter ONLY available products that are ON ACTIVE SALE
                const offers = allProducts.filter(p => isOfferActive(p) && p.isAvailable !== false);

                // --- NEW: Calculate Average End Date ---
                if (avgTimerEl && avgDisplayEl) {
                    const offersWithEndDate = offers.filter(p => p.saleEndDate);
                    if (offersWithEndDate.length > 0) {
                        const totalMs = offersWithEndDate.reduce((sum, p) => {
                             const endDate = p.saleEndDate.toDate ? p.saleEndDate.toDate() : new Date(p.saleEndDate);
                             return sum + endDate.getTime();
                        }, 0);
                        const avgMs = totalMs / offersWithEndDate.length;
                        const now = new Date().getTime();
                        const diff = avgMs - now;

                        if (diff > 0) {
                            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                            
                            // Format numbers to always have at least 2 digits
                            const d = String(days).padStart(2, '0');
                            const h = String(hours).padStart(2, '0');
                            const m = String(minutes).padStart(2, '0');

                            avgDisplayEl.textContent = `${d}d : ${h}h : ${m}m`;
                            avgTimerEl.classList.remove('hidden');
                        } else {
                             avgTimerEl.classList.add('hidden');
                        }
                    } else {
                        avgTimerEl.classList.add('hidden');
                    }
                }
                // ---------------------------------------

                if (offers.length === 0) {
                    grid.classList.add('hidden');
                    noOffersMsg.classList.remove('hidden');
                } else {
                    noOffersMsg.classList.add('hidden');
                    grid.classList.remove('hidden');
                    offers.forEach(p => {
                        grid.innerHTML += renderProductCard(p);
                    });
                }
                setupAddToCartButtons();
                setupDeleteProductButtons();
                setupEditProductButtons();
                lucide.createIcons();
            }

            function setupDeleteProductButtons() {
                document.querySelectorAll('.delete-product-btn').forEach(btn => {
                    
                    if (btn.dataset.listenerAttached) return;
                    btn.dataset.listenerAttached = 'true';
                    
                    btn.addEventListener('click', async (e) => {
                        e.stopPropagation();
                        e.preventDefault();
                        
                        const productId = e.currentTarget.dataset.productId;
                        if (!productId) return;

                        
                        
                        console.log("Attempting to delete product:", productId);
                        await deleteProduct(productId);
                    });
                });
            }

            function setupEditProductButtons() {
                document.querySelectorAll('.edit-product-btn').forEach(btn => {
                    
                    if (btn.dataset.listenerAttached) return;
                    btn.dataset.listenerAttached = 'true';
                    
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        e.preventDefault();
                        
                        const productId = e.currentTarget.dataset.productId;
                        if (!productId) return;

                        const product = allProducts.find(p => p.id === productId);
                        if (product) {
                            openEditModal(product);
                        } else {
                            console.error("Product not found for editing:", productId);
                        }
                    });
                });
            }

            
            function openEditModal(product) {
                // FIX: Re-fetch elements here to ensure they are found
                const modalEl = document.getElementById('add-product-modal');
                // ... (rest of elements)
                const formEl = document.getElementById('add-product-form');
                const titleEl = document.getElementById('modal-title');
                const submitBtnEl = document.getElementById('modal-submit-btn');

                if (!modalEl || !formEl || !titleEl || !submitBtnEl) {
                    console.error("Cannot open edit modal: Missing elements.");
                    return;
                }

                
                titleEl.textContent = "ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬";
                submitBtnEl.textContent = "ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù†ØªØ¬";
                formEl.dataset.editingId = product.id; 

                // Helper to safely set value
                const setVal = (id, val) => {
                    const el = document.getElementById(id);
                    if (el) el.value = val;
                    else console.warn(`Element #${id} not found when trying to set value.`);
                };
                
                setVal('productName', product.name || '');
                setVal('productPrice', product.price || 0);
                
                
                setVal('productImageUrls', (product.imageUrls || []).join(', '));
                setVal('productCategory', product.category || 'Other');
                setVal('productDescription', product.description || '');
                
                
                const saleCheck = document.getElementById('isOnSale');
                const bestsellerCheck = document.getElementById('isBestSeller');
                const availableCheck = document.getElementById('isAvailable'); // NEW

                if (saleCheck) saleCheck.checked = product.isOnSale || false;
                if (bestsellerCheck) bestsellerCheck.checked = product.isBestSeller || false;
                if (availableCheck) availableCheck.checked = product.isAvailable !== false; 

                
                if (product.isOnSale) {
                    originalPriceContainer.classList.remove('hidden');
                    // Removed invalid classList additions from previous bad fix
                    setVal('originalPrice', product.originalPrice || 0);
                    
                    // NEW: Populate Sale End Date
                    if (product.saleEndDate) {
                        const date = product.saleEndDate.toDate();
                        // Format for datetime-local input: YYYY-MM-DDTHH:mm
                        const formattedDate = new Date(date.getTime() - (date.getTimezoneOffset() * 60000)).toISOString().slice(0, 16);
                         setVal('saleEndDate', formattedDate);
                    } else {
                         setVal('saleEndDate', '');
                    }

                } else {
                    originalPriceContainer.classList.add('hidden');
                     setVal('originalPrice', '');
                     setVal('saleEndDate', '');
                }

                
                setVal('productCompany', product.company || '');
                setVal('productVolts', product.volts || '');
                setVal('productLength', product.length || '');
                setVal('productWarranty', product.warranty || '');
                setVal('productMadeIn', product.madeIn || '');
                setVal('productModel', product.model || '');
                setVal('productLumens', product.lumens || '');
                setVal('productLifespan', product.lifespan || '');
                setVal('productCurrent', product.currentIntensity || '');
                setVal('productWatt', product.watt || '');
                setVal('productSizes', product.sizes || '');
                // NEW: Populate weight and size in edit modal
                setVal('productWeight', product.weight || '');
                setVal('productSize', product.size || '');
                // Removed old productColors population
                
                // --- NEW: Populate Color Variants ---
                const colorContainer = document.getElementById('color-variants-container');
                if (colorContainer) {
                    colorContainer.innerHTML = ''; // Clear existing
                    if (product.colorOptions && Array.isArray(product.colorOptions)) {
                        product.colorOptions.forEach(opt => {
                            addColorVariantRow(opt.hex, opt.name, opt.imageUrl);
                        });
                    }
                }
                // ------------------------------------
                
                modalEl.classList.remove('hidden');
                modalEl.style.display = 'flex'; // Force display for edit as well
            }


            
            function renderArticleCard(article) {
                const deleteButtonHTML = currentIsAdmin
                    ? `<button class="delete-article-btn p-1.5 sm:p-2 bg-red-600 text-white rounded-lg hover:bg-red-700" title="Ø­Ø°Ù Ø§Ù„Ù…Ù‚Ø§Ù„Ø©" data-article-id="${article.id}">
                           <i data-lucide="trash-2" class="w-4 h-4"></i>
                       </button>`
                    : '';
                
                const editButtonHTML = currentIsAdmin
                    ? `<button class="edit-article-btn p-1.5 sm:p-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700" title="ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù‚Ø§Ù„Ø©" data-article-id="${article.id}">
                           <i data-lucide="edit-3" class="w-4 h-4"></i>
                       </button>`
                    : '';
                
                
                let previewText = 'Ø§Ø¶ØºØ· Ù„Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ø²ÙŠØ¯...';
                if (Array.isArray(article.content) && article.content.length > 0) {
                    
                    const firstBlock = article.content.find(b => b.body);
                    if (firstBlock) {
                        previewText = firstBlock.body.substring(0, 100) + '...';
                    } else if (article.content[0].title) {
                        
                        previewText = article.content[0].title;
                    }
                } else if (typeof article.content === 'string' && article.content) {
                    
                    previewText = (article.content.replace(/<[^>]+>/g, '').substring(0, 100) || 'Ø§Ø¶ØºØ· Ù„Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ø²ÙŠØ¯') + '...';
                }
                

                return `
                <div class="card-hover bg-white dark:bg-[#2c2f38] rounded-xl shadow-lg overflow-hidden flex flex-col">
                    <img class="w-full h-40 object-cover" src="${article.imageUrl}" onerror="this.src='https://placehold.co/400x250/eeeeee/777777?text=Image+Not+Found'" alt="${article.title}">
                    <div class="p-4 flex-grow flex flex-col">
                        <h2 class="text-lg font-semibold mb-2">${article.title}</h2>
                        <p class="text-gray-600 dark:text-gray-300 text-sm mb-4 flex-grow">
                            ${previewText}
                        </p>
                        <div class="flex items-center justify-between">
                            <a href="#blog/${article.shortId || article.id}" class="article-details-link font-medium text-[#ffcd00] hover:text-[#ffda33]" data-article-id="${article.id}">Ø§Ù‚Ø±Ø£ Ø§Ù„Ù…Ø²ÙŠØ¯ &larr;</a>
                            <div class="flex gap-2">
                                ${editButtonHTML}
                                ${deleteButtonHTML}
                            </div>
                        </div>
                    </div>
                </div>
                `;
            }

            function renderArticles() {
                const blogGrid = document.getElementById('blog-grid');
                if (!blogGrid) return;

                if (allArticles.length === 0) {
                    blogGrid.innerHTML = '<p class="text-gray-500 dark:text-gray-400 col-span-1 md:col-span-2 lg:col-span-3 text-center">Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ù‚Ø§Ù„Ø§Øª. ØªØ­Ù‚Ù‚ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ù„Ø§Ø­Ù‚Ø§Ù‹!</p>';
                    return;
                }

                blogGrid.innerHTML = '';
                allArticles.forEach(article => {
                    blogGrid.innerHTML += renderArticleCard(article);
                });


                setupDeleteArticleButtons();
                setupEditArticleButtons();
                lucide.createIcons();
            }

            function setupArticleDetailsLinks() {
                document.querySelectorAll('.article-details-link').forEach(link => {
                    if (link.dataset.listenerAttached) return;
                    link.dataset.listenerAttached = 'true';
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        const articleId = e.currentTarget.dataset.articleId;
                        showPage('blog-post', articleId);
                    });
                });
            }

            function setupDeleteArticleButtons() {
                document.querySelectorAll('.delete-article-btn').forEach(btn => {
                    if (btn.dataset.listenerAttached) return;
                    btn.dataset.listenerAttached = 'true';
                    btn.addEventListener('click', async (e) => {
                        e.stopPropagation();
                        e.preventDefault();
                        const articleId = e.currentTarget.dataset.articleId;
                        if (!articleId) return;
                        
                        await deleteArticle(articleId);
                    });
                });
            }

            async function deleteArticle(id) {
                try {
                    const articleRef = doc(db, "articles", id);
                    await deleteDoc(articleRef);
                    showToast("ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù‚Ø§Ù„Ø© Ø¨Ù†Ø¬Ø§Ø­.");
                } catch (error) {
                    console.error("Error deleting article: ", error);
                    showToast("Ø®Ø·Ø£: Ù„Ù… Ù†ØªÙ…ÙƒÙ† Ù…Ù† Ø­Ø°Ù Ø§Ù„Ù…Ù‚Ø§Ù„Ø©.");
                }
            }

            function setupEditArticleButtons() {
                document.querySelectorAll('.edit-article-btn').forEach(btn => {
                    if (btn.dataset.listenerAttached) return;
                    btn.dataset.listenerAttached = 'true';
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        e.preventDefault();
                        const articleId = e.currentTarget.dataset.articleId;
                        if (!articleId) return;
                        const article = allArticles.find(a => a.id === articleId);
                        if (article) {
                            openEditArticleModal(article);
                        }
                    });
                });
            }

            function openEditArticleModal(article) {
                if (!articleModal || !addArticleForm || !articleModalTitle || !articleModalSubmitBtn) return;

                articleModalTitle.textContent = "ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù‚Ø§Ù„Ø©";
                articleModalSubmitBtn.textContent = "ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù‚Ø§Ù„Ø©";
                addArticleForm.dataset.editingId = article.id;

                document.getElementById('articleTitle').value = article.title || '';
                document.getElementById('articleImageUrl').value = article.imageUrl || '';
                
                
                const container = document.getElementById('article-paragraphs-container');
                if (container) {
                    container.innerHTML = '';
                }
                
                
                if (Array.isArray(article.content) && article.content.length > 0) {
                    article.content.forEach(block => {
                        const type = block.type || 'paragraph';
                        if (type === 'paragraph') {
                            createParagraphBlock(block.title, block.body);
                        } else if (type === 'gallery') {
                            createGalleryBlock(block.images);
                        }
                    });
                } else if (typeof article.content === 'string' && article.content) {
                    
                    
                    createParagraphBlock('', article.content);
                } else {
                    
                    createParagraphBlock();
                }
                reNumberParagraphBlocks();
                
                
                

                articleModal.classList.remove('hidden');
            }

            function renderArticleDetails(articleId) {
                const article = allArticles.find(a => a.shortId === articleId || a.id === articleId);
                if (!article) {
                    showPage('blog');
                    return;
                }

                const titleEl = document.getElementById('blog-post-title');
                const imageEl = document.getElementById('blog-post-image');
                const contentEl = document.getElementById('blog-post-content-wrapper');

                if (titleEl) titleEl.textContent = article.title;
                if (imageEl) {
                    imageEl.src = article.imageUrl;
                    imageEl.alt = article.title;
                }
                
                
                if (contentEl) {
                    let finalHtml = '';
                    let paragraphCounter = 1;
                    
                    
                    if (Array.isArray(article.content)) {
                        article.content.forEach((block) => {
                            const type = block.type || 'paragraph';

                            if (type === 'paragraph') {
                                if (block.title) {
                                    const safeTitle = escapeHTML(block.title);
                                    
                                    finalHtml += `<h2>${paragraphCounter}. ${safeTitle}</h2>\n`;
                                }
                                
                                if (block.body) {
                                    const lines = block.body.split('\n')
                                                        .map(line => line.trim())
                                                        .filter(line => line.length > 0);
                                    
                                    if (lines.length > 0) {
                                        finalHtml += '<ul>\n';
                                        lines.forEach(line => {
                                            finalHtml += `<li>${escapeHTML(line)}</li>\n`;
                                        });
                                        finalHtml += '</ul>\n';
                                    }
                                }
                                paragraphCounter++;
                            
                            } else if (type === 'gallery' && block.images && block.images.length > 0) {
                                
                                
                                finalHtml += '<div class="not-prose grid grid-cols-2 md:grid-cols-3 gap-2 my-4">\n';
                                block.images.forEach(url => {
                                    finalHtml += `
                                        <div>
                                            <img src="${escapeHTML(url)}" 
                                                 class="w-full h-auto object-cover rounded-md shadow-md aspect-square" 
                                                 onerror="this.src='https://placehold.co/400x400/eeeeee/777777?text=Image+Error'" 
                                                 alt="Gallery Image">
                                        </div>\n`;
                                });
                                finalHtml += '</div>\n';
                                
                            }
                        });
                    } else if (typeof article.content === 'string') {
                        
                        
                        finalHtml = article.content;
                    }
                    
                    contentEl.innerHTML = finalHtml || '<p>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø­ØªÙˆÙ‰ Ù…ØªØ§Ø­.</p>';
                }
                
            }

            

            
            function setupProductDetailsLinks() {
                document.querySelectorAll('.product-details-link').forEach(btn => {
                    
                    if (btn.dataset.listenerAttached) return;
                    btn.dataset.listenerAttached = 'true';
                    
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        e.preventDefault();
                        
                        const productId = e.currentTarget.dataset.productId;
                        
                        console.log('Details link clicked, Product ID:', productId); 
                        if (!productId) {
                            console.error("Product ID is missing from the button!");
                            return;
                        }
                        
                        showPage('details', productId);
                    });
                });
            }


            
            async function deleteProduct(id) {
                try {
                    const productRef = doc(db, "products", id);
                    await deleteDoc(productRef);
                    showToast("ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­.");
                } catch (error) {
                    console.error("Error deleting product: ", error);
                    showToast("Ø®Ø·Ø£: Ù„Ù… Ù†ØªÙ…ÙƒÙ† Ù…Ù† Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬.");
                }
            }

            
            function renderProductDetails(productId) {
                
                console.log('renderProductDetails called for:', productId); 
                const product = allProducts.find(p => p.shortId === productId || p.id === productId);
                
                if (!product) {
                    console.error("Product not found in allProducts array:", productId);
                    showPage('products'); 
                    return;
                }

                
                console.log('Product found:', product); 

                
                const placeholder = 'https://placehold.co/150x150/eeeeee/777777?text=...';
                const mainImgEl = document.getElementById('main-product-image');
                const thumbnailContainer = document.getElementById('details-thumbnail-container');

                
                thumbnailContainer.innerHTML = '';

                
                const imageUrls = (product.imageUrls && product.imageUrls.length > 0) 
                                    ? product.imageUrls 
                                    : [product.imageUrl || placeholder];
                
                
                currentGalleryImages = imageUrls;
                currentGalleryIndex = 0;
                
                // --- NEW: Reset selected color when loading new product ---
                currentSelectedColor = null;
                // ----------------------------------------------------------

                mainImgEl.src = imageUrls[0];

                
                imageUrls.forEach((url, index) => {
                    const img = document.createElement('img');
                    img.src = url;
                    img.alt = `Thumbnail ${index + 1}`;
                    img.onerror = function() { this.src = placeholder; };
                    img.className = "cursor-pointer rounded-md border-2 hover:border-[#ffcd00] transition-all duration-200 object-cover w-20 h-20 md:w-full md:h-auto md:aspect-square";
                    
                    
                    if (index === 0) {
                        img.classList.add('border-[#ffcd00]');
                        img.classList.remove('border-transparent');
                    } else {
                        img.classList.add('border-transparent');
                    }

                    
                    img.addEventListener('click', () => {
                        
                        updateGalleryView(index);
                    });
                    
                    thumbnailContainer.appendChild(img);
                });

                
                const prevBtn = document.getElementById('gallery-prev-btn');
                const nextBtn = document.getElementById('gallery-next-btn');
                
                
                const newPrevBtn = prevBtn.cloneNode(true);
                prevBtn.parentNode.replaceChild(newPrevBtn, prevBtn);
                
                const newNextBtn = nextBtn.cloneNode(true);
                nextBtn.parentNode.replaceChild(newNextBtn, nextBtn);

                newPrevBtn.addEventListener('click', () => {
                    updateGalleryView(currentGalleryIndex - 1);
                });
                
                newNextBtn.addEventListener('click', () => {
                    updateGalleryView(currentGalleryIndex + 1);
                });
                
                // NEW: Handle Category Badge
                const categoryTranslations = {
                    'Lighting': 'Ø¥Ø¶Ø§Ø¡Ø©',
                    'Cables': 'ÙƒØ§Ø¨Ù„Ø§Øª',
                    'Switches': 'Ù…ÙØ§ØªÙŠØ­',
                    'Paints': 'Ø¯Ù‡Ø§Ù†Ø§Øª',
                    'Parts': 'Ù‚Ø·Ø¹ ØºÙŠØ§Ø±',
                    'Ironmongery': 'Ø­Ø¯Ø§ÙŠØ¯',
                    'Other': 'Ø£Ø®Ø±Ù‰'
                };
                const categoryEl = document.getElementById('details-product-category');
                if (categoryEl && product.category) {
                    categoryEl.textContent = categoryTranslations[product.category] || product.category;
                    categoryEl.classList.remove('hidden');
                } else if (categoryEl) {
                    categoryEl.classList.add('hidden');
                }

                const companyEl = document.getElementById('details-product-company');
                if (companyEl) {
                    if (product.company && product.company.trim() !== '') {
                        // Added a separator prefix if category is also shown
                        const prefix = (categoryEl && !categoryEl.classList.contains('hidden')) ? '| ' : '';
                        companyEl.textContent = `${prefix}${product.company}`;
                        companyEl.classList.remove('hidden');
                    } else {
                        companyEl.textContent = '';
                        companyEl.classList.add('hidden');
                    }
                }

                document.getElementById('details-product-name').textContent = product.name;
                
                const detailsRatingEl = document.getElementById('details-star-rating');
                if (detailsRatingEl) {
                    detailsRatingEl.innerHTML = generateStarRating();
                }

                document.getElementById('details-product-description').textContent = product.description || "Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØµÙ Ù…ØªØ§Ø­ Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬.";

                
                const priceEl = document.getElementById('details-product-price');
                priceEl.classList.add('bg-gray-100', 'dark:bg-gray-700', 'p-4', 'rounded-lg', 'border', 'border-gray-200', 'dark:border-gray-600');

                // MODIFIED: Use isOfferActive helper
                if (isOfferActive(product) && product.originalPrice && product.originalPrice > product.price) {
                    const discountAmount = product.originalPrice - product.price;
                    const discountPercent = Math.round((discountAmount / product.originalPrice) * 100);
                    
                    // NEW: Add countdown to details page if active
                    let timerHtml = '';
                    const remaining = getRemainingTime(product);
                    if (remaining) {
                        timerHtml = `
                            <div class="inline-flex items-center gap-1.5 px-3 py-1.5 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400 rounded-lg text-sm font-medium mt-3">
                                <i data-lucide="timer" class="w-4 h-4"></i>
                                <span>ÙŠÙ†ØªÙ‡ÙŠ Ø§Ù„Ø¹Ø±Ø¶ Ø®Ù„Ø§Ù„ ${remaining}</span>
                            </div>`;
                    }

                    priceEl.innerHTML = `
                        <div class="flex items-baseline gap-3">
                            <span class="text-3xl lg:text-4xl font-bold text-[#ffcd00]">${product.price.toFixed(2)} EGP</span>
                            <span class="text-lg lg:text-xl text-gray-500 line-through">${product.originalPrice.toFixed(2)} EGP</span>
                        </div>
                        <div class="text-sm font-semibold text-red-500 mt-2">
                            !ÙˆÙØ± ${discountAmount.toFixed(2)} EGP (Ø®ØµÙ… ${discountPercent}%)
                        </div>
                        ${timerHtml}
                    `;
                } else {
                    priceEl.innerHTML = `
                        <div class="flex items-baseline gap-3">
                            <span class="text-3xl lg:text-4xl font-bold text-gray-900 dark:text-white">${product.price.toFixed(2)} EGP</span>
                        </div>
                    `;
                }

                // --- NEW: Render Color Swatches ---
                const colorOptionsContainer = document.getElementById('details-color-options');
                const swatchesContainer = document.getElementById('color-swatches-container');
                
                if (colorOptionsContainer && swatchesContainer) {
                    if (product.colorOptions && Array.isArray(product.colorOptions) && product.colorOptions.length > 0) {
                        swatchesContainer.innerHTML = '';
                        product.colorOptions.forEach(opt => {
                            const swatch = document.createElement('button');
                            // Show color name on hover if available
                            swatch.title = opt.name || opt.hex;
                            swatch.className = 'w-10 h-10 rounded-full border-2 border-gray-300 dark:border-gray-600 hover:scale-110 transition-all shadow-sm focus:outline-none focus:ring-2 focus:ring-[#ffcd00] relative overflow-hidden';
                            swatch.style.backgroundColor = opt.hex;
                            
                            swatch.addEventListener('click', () => {
                                // --- NEW: Update selected color state ---
                                currentSelectedColor = opt;
                                // ----------------------------------------

                                // If this color has a linked image, update the main image
                                if (opt.imageUrl && opt.imageUrl.trim() !== '') {
                                    const mainImgEl = document.getElementById('main-product-image');
                                    if (mainImgEl) {
                                        mainImgEl.src = opt.imageUrl;
                                        // Optionally highlight this swatch as active
                                        document.querySelectorAll('#color-swatches-container button').forEach(btn => btn.classList.remove('ring-2', 'ring-[#ffcd00]', 'scale-110'));
                                        swatch.classList.add('ring-2', 'ring-[#ffcd00]', 'scale-110');
                                    }
                                }
                            });

                            swatchesContainer.appendChild(swatch);
                        });
                        colorOptionsContainer.classList.remove('hidden');
                    } else {
                        colorOptionsContainer.classList.add('hidden');
                    }
                }
                // ----------------------------------

                
                const whatsappLink = document.getElementById('details-whatsapp-link');
                if (whatsappLink) {
                    const storePhone = "201146641942";
                    const productName = product.name;
                    
                    const message = `Ù…Ø±Ø­Ø¨Ø§Ù‹ Ù…ØªØ¬Ø± Ù…ÙƒØ©ØŒ\n\nØ£ÙˆØ¯ Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø±/Ø§Ù„Ø·Ù„Ø¨ Ø¨Ø®ØµÙˆØµ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬:\n*${productName}*\n\nÙ‡Ù„ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø¹Ø±ÙØ© Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø£Ùˆ Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨ØŸ\nØ´ÙƒØ±Ø§Ù‹ Ù„ÙƒÙ….`;
                    const encodedMessage = encodeURIComponent(message);
                    whatsappLink.href = `https://wa.me/${storePhone}?text=${encodedMessage}`;
                }
                

                
                const cartWrapper = document.getElementById('details-add-to-cart-wrapper');
                cartWrapper.dataset.productId = product.id;
                cartWrapper.dataset.productName = product.name;
                cartWrapper.dataset.productPrice = product.price;
                cartWrapper.dataset.productImage = imageUrls[0]; 
                
                // --- HANDLE UNAVAILABLE PRODUCT IN DETAILS PAGE ---
                if (product.isAvailable === false) {
                    // If product is unavailable, hide add-to-cart and show message
                    cartWrapper.innerHTML = `
                        <div class="w-full py-4 bg-gray-200 dark:bg-gray-700 text-gray-500 dark:text-gray-400 text-center rounded-xl font-bold flex items-center justify-center gap-2 border-2 border-dashed border-gray-300 dark:border-gray-600">
                            <i data-lucide="alert-circle" class="w-6 h-6"></i>
                            <span>Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ ØºÙŠØ± Ù…ØªÙˆÙØ± Ø­Ø§Ù„ÙŠØ§Ù‹</span>
                        </div>
                        <a id="details-whatsapp-link-unavailable" href="https://wa.me/201146641942" target="_blank" class="w-full flex items-center justify-center gap-3 px-6 py-3 bg-transparent border border-gray-400 text-gray-500 font-bold text-lg rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-all duration-300 mt-4">
                            <i data-lucide="message-circle" class="w-6 h-6"></i>
                            <span>Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø± Ø¹Ù† Ø§Ù„ØªÙˆÙØ±</span>
                        </a>
                    `;
                    // Update the whatsapp link for unavailable product
                    const waLinkUnavailable = document.getElementById('details-whatsapp-link-unavailable');
                    if (waLinkUnavailable) {
                         const message = `Ù…Ø±Ø­Ø¨Ø§Ù‹ Ù…ØªØ¬Ø± Ù…ÙƒØ©ØŒ\n\nØ£ÙˆØ¯ Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø± Ø¹Ù† ØªÙˆÙØ± Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ Ù…Ø³ØªÙ‚Ø¨Ù„Ø§Ù‹:\n*${product.name}*\n\nØ´ÙƒØ±Ø§Ù‹ Ù„ÙƒÙ….`;
                         waLinkUnavailable.href = `https://wa.me/201146641942?text=${encodeURIComponent(message)}`;
                    }

                } else {
                    // Reset to original Add to Cart structure if it was previously replaced
                    // This handles going from an unavailable product to an available one without full page reload if handled by router
                    cartWrapper.innerHTML = `
                        <div class="flex items-end gap-3">
                            <div>
                                <label for="details-quantity-input" class="block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300">Ø§Ù„ÙƒÙ…ÙŠØ©</label>
                                <input type="number" id="details-quantity-input" value="1" min="1" 
                                       class="w-24 px-4 py-3 rounded-lg bg-gray-100 dark:bg-[#3d474e] border-transparent focus:border-[#ffcd00] focus:ring-[#ffcd00] text-lg font-bold text-center">
                            </div>
                            
                            <button class="add-to-cart-btn flex-1 flex items-center justify-center gap-3 px-6 py-3 bg-[#ffcd00] text-gray-900 font-bold text-lg rounded-lg shadow-lg hover:bg-[#ffda33] transform transition-all duration-300 hover:-translate-y-0.5">
                                <i data-lucide="shopping-cart" class="w-6 h-6"></i>
                                <span>Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©</span>
                            </button>
                        </div>
                        <a id="details-whatsapp-link" href="https://wa.me/201146641942" target="_blank" class="w-full flex items-center justify-center gap-3 px-6 py-3 bg-transparent border border-green-500 text-green-500 font-bold text-lg rounded-lg shadow-lg hover:bg-green-500 hover:text-white transform transition-all duration-300">
                            <i data-lucide="message-circle" class="w-6 h-6"></i>
                            <span>ØªÙˆØ§ØµÙ„ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</span>
                        </a>
                    `;
                    // Re-attach listeners and update WA link
                    // FIX: Removed manual setting of dataset.listenerAttached = 'false' as it's a fresh element
                    setupAddToCartButtons(); 
                    
                    const whatsappLink = document.getElementById('details-whatsapp-link');
                     if (whatsappLink) {
                        const message = `Ù…Ø±Ø­Ø¨Ø§Ù‹ Ù…ØªØ¬Ø± Ù…ÙƒØ©ØŒ\n\nØ£ÙˆØ¯ Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø±/Ø§Ù„Ø·Ù„Ø¨ Ø¨Ø®ØµÙˆØµ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬:\n*${product.name}*\n\nÙ‡Ù„ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø¹Ø±ÙØ© Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø£Ùˆ Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨ØŸ\nØ´ÙƒØ±Ø§Ù‹ Ù„ÙƒÙ….`;
                        whatsappLink.href = `https://wa.me/201146641942?text=${encodeURIComponent(message)}`;
                    }
                }
                // ---------------------------------------------

                
                
                const quantityInput = document.getElementById('details-quantity-input');
                if (quantityInput) {
                    quantityInput.value = '1';
                }
                
                
                
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    const isSpecs = btn.dataset.tab === 'specs';
                    btn.classList.toggle('active-tab', isSpecs);
                    btn.classList.toggle('text-[#ffcd00]', isSpecs);
                    btn.classList.toggle('border-[#ffcd00]', isSpecs);
                    btn.classList.toggle('text-gray-500', !isSpecs);
                });
                document.querySelectorAll('.tab-content').forEach(content => {
                    const isSpecs = content.id === 'tab-content-specs';
                    content.classList.toggle('hidden', !isSpecs);
                });
                
                

                const specsContainer = document.getElementById('specs-list-container');
                if (specsContainer) {
                    specsContainer.innerHTML = ''; 

                 
                    const specs = [
                        { label: 'Ø§Ù„Ø´Ø±ÙƒØ©', value: product.company },
                        { label: 'Ø§Ù„Ø¬Ù‡Ø¯', value: product.volts },
                        { label: 'Ø§Ù„Ø·ÙˆÙ„', value: product.length ? `${product.length} meters` : undefined },
                        { label: 'Ø§Ù„Ø¶Ù…Ø§Ù†', value: product.warranty },
                        { label: 'ØµÙ†Ø¹ ÙÙŠ', value: product.madeIn },
                        { label: 'Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„', value: product.model },
                        { label: 'Ø§Ù„Ù„ÙˆÙ…Ù†', value: product.lumens },
                        { label: 'Ø§Ù„Ø¹Ù…Ø± Ø§Ù„Ø¥ÙØªØ±Ø§Ø¶ÙŠ', value: product.lifespan },
                        { label: 'Ø´Ø¯Ø© Ø§Ù„Ø³Ø­Ø¨', value: product.currentIntensity },
                        { label: 'Ø§Ù„ÙˆØ§Ø·', value: product.watt },
                        { label: 'Ø§Ù„Ù…Ù‚Ø§Ø³Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©', value: product.sizes },
                        // NEW: Add weight and size to details display
                        { label: 'Ø§Ù„ÙˆØ²Ù†', value: product.weight },
                        { label: 'Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯', value: product.size },
                        // Removed old colors from specs list as it now has its own section
                    ];

                    let specsAdded = 0;

                    
                    specs.forEach(spec => {
                       
                        if (spec.value && String(spec.value).trim() !== '') {
                            const li = document.createElement('li');
                            li.className = "grid grid-cols-1 sm:grid-cols-2 sm:gap-4 pb-2 border-b border-gray-200 dark:border-gray-700";
                            li.innerHTML = `
                                <span class="font-medium text-gray-800 dark:text-gray-100">${spec.label}:</span>
                                <span class="sm:text-left">${spec.value}</span>
                            `;
                            specsContainer.appendChild(li);
                            specsAdded++;
                        }
                    });

                   
                    if (specsAdded === 0) {
                        specsContainer.innerHTML = '<p class="text-gray-500">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ§ØµÙØ§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ù…ØªØ§Ø­Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬.</p>';
                    } else {
                       
                        if (specsContainer.lastChild) {
                            specsContainer.lastChild.classList.remove('border-b', 'pb-2');
                        }
                    }
                }


            }


            async function fetchAiSuggestions(productId) {
                const loadingElDesktop = document.getElementById('ai-suggestions-loading-desktop');
                const gridElDesktop = document.getElementById('ai-suggestions-grid-desktop');
                const loadingElMobile = document.getElementById('ai-suggestions-loading-mobile');
                const gridElMobile = document.getElementById('ai-suggestions-grid-mobile');
                
              
                if (loadingElDesktop) loadingElDesktop.classList.remove('hidden');
                if (gridElDesktop) gridElDesktop.innerHTML = ''; 
                if (loadingElMobile) loadingElMobile.classList.remove('hidden');
                if (gridElMobile) gridElMobile.innerHTML = ''; 

                try {
                    const currentProduct = allProducts.find(p => p.shortId === productId || p.id === productId);
                    if (!currentProduct) {
                   
                        throw new Error("Current product not found for suggestions.");
                    }

                    const currentCategory = currentProduct.category;
                    const maxSuggestions = 3;
                    let suggestions = [];

        
                    // Filter products: same category, NOT the current product, AND AVAILABLE
                    const categoryProducts = allProducts.filter(p => 
                        p.category === currentCategory && 
                        (p.shortId !== productId && p.id !== productId) &&
                        p.isAvailable !== false // Suggest only available products
                    );

                  
                    let shuffledCategory = [...categoryProducts];
                    for (let i = shuffledCategory.length - 1; i > 0; i--) {
                        const j = Math.floor(Math.random() * (i + 1));
                        [shuffledCategory[i], shuffledCategory[j]] = [shuffledCategory[j], shuffledCategory[i]];
                    }
                    
                    suggestions = shuffledCategory.slice(0, maxSuggestions);

       
                    if (suggestions.length < maxSuggestions) {
                        const otherProducts = allProducts.filter(p => 
                            p.category !== currentCategory && 
                            (p.shortId !== productId && p.id !== productId) &&
                            p.isAvailable !== false // Suggest only available products
                        );

         
                        let shuffledOthers = [...otherProducts];
                        for (let i = shuffledOthers.length - 1; i > 0; i--) {
                            const j = Math.floor(Math.random() * (i + 1));
                            [shuffledOthers[i], shuffledOthers[j]] = [shuffledOthers[j], shuffledOthers[i]];
                        }
                        
                        const needed = maxSuggestions - suggestions.length;
                        suggestions = suggestions.concat(shuffledOthers.slice(0, needed));
                    }
                    
                    
                    let suggestionsHtml = ''; 
                    if (suggestions.length === 0) {
                        
                        suggestionsHtml = `<p class="text-gray-500 dark:text-gray-400 col-span-2 sm:col-span-3 text-center">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª Ø£Ø®Ø±Ù‰ Ù„Ø§Ù‚ØªØ±Ø§Ø­Ù‡Ø§.</p>`;
                    } else {
                        
                        suggestions.forEach(product => {
                            if (product) {
                                
                                suggestionsHtml += renderProductCard(product);
                            }
                        });
                    }
                    
                  
                    if (gridElDesktop) gridElDesktop.innerHTML = suggestionsHtml;
                    if (gridElMobile) gridElMobile.innerHTML = suggestionsHtml;
                    
                    
            

                } catch (error) {
                    console.error("Error fetching suggestions:", error);
                 
                    const otherProducts = allProducts.filter(p => p.shortId !== productId && p.id !== productId && p.isAvailable !== false);
                    let shuffled = [...otherProducts];
                    for (let i = shuffled.length - 1; i > 0; i--) {
                        const j = Math.floor(Math.random() * (i + 1));
                        [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
                    }
                    const randomSuggestions = shuffled.slice(0, 3);
                    
                    let fallbackHtml = '';
                    if (randomSuggestions.length > 0) {
                         randomSuggestions.forEach(product => {
                            if (product) {
                              
                                fallbackHtml += renderProductCard(product);
                            }
                        });
                     
                    } else {
                        fallbackHtml = `<p class="text-red-500 col-span-2 sm:col-span-3 text-center">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹.</p>`;
                    }
                    
                    if (gridElDesktop) gridElDesktop.innerHTML = fallbackHtml;
                    if (gridElMobile) gridElMobile.innerHTML = fallbackHtml;

                } finally {
                   
                    if (loadingElDesktop) loadingElDesktop.classList.add('hidden');
                    if (loadingElMobile) loadingElMobile.classList.add('hidden');
                    
                   
                    setupAddToCartButtons();
                    setupDeleteProductButtons();
                    setupEditProductButtons();
             
                    lucide.createIcons();
                }
            }

            function loadProducts() {
                const productsRef = collection(db, "products");
                const q = query(productsRef);

                onSnapshot(q, (querySnapshot) => {
                 
                    allProducts = []; 
                    querySnapshot.forEach((doc) => {
                        allProducts.push({ id: doc.id, ...doc.data() });
                    });
                    console.log("Products loaded from Firestore:", allProducts.length);
                    
                    populateBrandFilter(); // NEW
                    renderAllProductViews();
                }, (error) => {
                    console.error("Error fetching products: ", error);
                    showToast("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª.");
                });
            }
            
            // NEW FUNCTION
            function populateBrandFilter() {
                const brandFilter = document.getElementById('product-brand-filter');
                if (!brandFilter) return;

                // 1. Get unique brands
                const brands = [...new Set(
                    allProducts
                        .map(p => p.company)
                        .filter(company => company && company.trim() !== '')
                )];
                brands.sort(); // Sort alphabetically

                // 2. Clear existing options (keep the first default "all")
                while (brandFilter.options.length > 1) {
                    brandFilter.remove(1);
                }

                // 3. Add new options
                brands.forEach(brand => {
                    const option = document.createElement('option');
                    option.value = brand;
                    option.textContent = brand;
                    brandFilter.appendChild(option);
                });
            }
            // END NEW FUNCTION
            
            document.getElementById('product-search-input').addEventListener('input', () => {
                preFilterType = 'all';
                renderAllProductViews();
            });

            const categoryFilterForPlaceholder = document.getElementById('product-category-filter');
            const brandFilterForPlaceholder = document.getElementById('product-brand-filter'); // NEW
            const searchInputForPlaceholder = document.getElementById('product-search-input');

            function updateSearchPlaceholder() {
                if (!categoryFilterForPlaceholder || !searchInputForPlaceholder || !brandFilterForPlaceholder) return; // NEW check
                
                const selectedCategoryOption = categoryFilterForPlaceholder.options[categoryFilterForPlaceholder.selectedIndex];
                const selectedCategoryText = selectedCategoryOption.value === 'all' ? 'Ø§Ù„Ø£Ù‚Ø³Ø§Ù…' : selectedCategoryOption.text;
                
                const selectedBrandOption = brandFilterForPlaceholder.options[brandFilterForPlaceholder.selectedIndex]; // NEW
                const selectedBrandText = selectedBrandOption.value === 'all' ? 'Ø§Ù„Ù…Ø§Ø±ÙƒØ§Øª' : selectedBrandOption.text; // NEW
                
                let placeholder = "Ø§Ø¨Ø­Ø« ÙÙŠ ";
                
                if (selectedCategoryOption.value !== 'all' && selectedBrandOption.value !== 'all') {
                    placeholder += `${selectedCategoryText} (Ù…Ø§Ø±ÙƒØ© ${selectedBrandText})...`;
                } else if (selectedCategoryOption.value !== 'all') {
                    placeholder += `${selectedCategoryText}...`;
                } else if (selectedBrandOption.value !== 'all') {
                    placeholder += `Ù…Ø§Ø±ÙƒØ© ${selectedBrandText}...`;
                } else {
                    placeholder = "Ø§Ø¨Ø­Ø« ÙÙŠ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ÙˆØ§Ù„Ù…Ø§Ø±ÙƒØ§Øª...";
                }
                
                searchInputForPlaceholder.placeholder = placeholder; // MODIFIED
            }

            if (categoryFilterForPlaceholder) {
                categoryFilterForPlaceholder.addEventListener('change', () => {
                    preFilterType = 'all';
                    updateSearchPlaceholder();
                    renderAllProductViews();
                });
            }
            
            // NEW: Event listener for brand filter
            if (brandFilterForPlaceholder) {
                brandFilterForPlaceholder.addEventListener('change', () => {
                    preFilterType = 'all';
                    updateSearchPlaceholder();
                    renderAllProductViews();
                });
            }
            // END NEW

            document.getElementById('product-sort-filter').addEventListener('change', () => {
                preFilterType = 'all';
                renderAllProductViews();
            });

            function loadArticles() {
                const articlesRef = collection(db, "articles");
                const q = query(articlesRef);

                onSnapshot(q, (querySnapshot) => {
                    allArticles = [];
                    querySnapshot.forEach((doc) => {
                        allArticles.push({ id: doc.id, ...doc.data() });
                    });
                    console.log("Articles loaded from Firestore:", allArticles.length);
                    renderArticles();
                }, (error) => {
                    console.error("Error fetching articles: ", error);
                    showToast("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª.");
                });
            }

           
            function loadSiteConfig() {
               
                const bannerConfigRef = doc(db, "config", "main_banners");
                
                onSnapshot(bannerConfigRef, (docSnap) => {
                    const lightBanner = document.getElementById('special-offer-banner-light');
                    const darkBanner = document.getElementById('special-offer-banner-dark');
                    const lightBannerImg = lightBanner?.querySelector('img');
                    const darkBannerImg = darkBanner?.querySelector('img');
                    const adminLightUrlInput = document.getElementById('admin-light-banner-url');
                    const adminDarkUrlInput = document.getElementById('admin-dark-banner-url');

                    if (docSnap.exists()) {
                        const data = docSnap.data();
                        const isDarkMode = document.documentElement.classList.contains('dark');

                        // Handle Light Banner
                        if (lightBanner && lightBannerImg) {
                            if (data.lightUrl && data.lightUrl.trim() !== '') {
                                lightBannerImg.src = data.lightUrl;
                                lightBannerImg.style.display = 'block';
                                
                                if (!isDarkMode) {
                                     lightBanner.classList.remove('hidden');
                                } else {
                                     lightBanner.classList.add('hidden');
                                }
                            } else {
                                lightBanner.classList.add('hidden');
                            }
                        }

                        // Handle Dark Banner
                        if (darkBanner && darkBannerImg) {
                             if (data.darkUrl && data.darkUrl.trim() !== '') {
                                darkBannerImg.src = data.darkUrl;
                                darkBannerImg.style.display = 'block';
                                
                                if (isDarkMode) {
                                     darkBanner.classList.remove('hidden');
                                } else {
                                     darkBanner.classList.add('hidden');
                                }
                            } else {
                                darkBanner.classList.add('hidden');
                            }
                        }
                        
                        // Update Admin Inputs
                        if (adminLightUrlInput) adminLightUrlInput.value = data.lightUrl || '';
                        if (adminDarkUrlInput) adminDarkUrlInput.value = data.darkUrl || '';
                        
                    } else {
                        // Hide banners if config doesn't exist
                        if (lightBanner) lightBanner.classList.add('hidden');
                        if (darkBanner) darkBanner.classList.add('hidden');
                    }
                }, (error) => {
                    console.error("Error fetching banner config: ", error);
                    // Optionally hide banners on error to avoid broken UI
                     if (lightBanner) lightBanner.classList.add('hidden');
                     if (darkBanner) darkBanner.classList.add('hidden');
                });

               
                // --- ØªØ¹Ø¯ÙŠÙ„ Ø¯Ø§Ù„Ø© ØªØ­Ù…ÙŠÙ„ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ---
                const homepageConfigRef = doc(db, "config", "homepage");
                onSnapshot(homepageConfigRef, (docSnap) => {
                    // Ø¬Ù„Ø¨ ÙƒÙ„ Ø§Ù„Ø¹Ù†Ø§ØµØ±
                    const videoEl = document.getElementById('hero-video');
                    const videoSourceEl = document.getElementById('hero-video-source');
                    const imageEl = document.getElementById('hero-image');

                    // Ø¬Ù„Ø¨ ÙƒÙ„ Ø¹Ù†Ø§ØµØ± Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
                    const adminHeroTypeSelect = document.getElementById('admin-hero-type');
                    const adminVideoUrlInput = document.getElementById('admin-video-url');
                    const adminImageUrlInput = document.getElementById('admin-image-url');

                    // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø£ÙˆÙ„Ø§Ù‹
                    if (videoEl) videoEl.classList.add('hidden');
                    if (imageEl) imageEl.classList.add('hidden');

                    if (docSnap.exists()) {
                        const data = docSnap.data();
                        const heroType = data.heroType || 'video'; // Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ù‡Ùˆ ÙÙŠØ¯ÙŠÙˆ
                        const videoUrl = data.videoUrl;
                        const imageUrl = data.imageUrl;

                        // --- 1. ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¹Ø±Ø¶ (Ø§Ù„Ù‡ÙŠØ±Ùˆ) ---
                        if (heroType === 'video' && videoUrl) {
                            if (videoSourceEl) videoSourceEl.src = videoUrl;
                            if (videoEl) {
                                videoEl.load();
                                videoEl.classList.remove('hidden');
                            }
                        } else if (heroType === 'image' && imageUrl) {
                            if (imageEl) {
                                imageEl.src = imageUrl;
                                imageEl.classList.remove('hidden');
                            }
                        } else {
                            // ÙÙŠ Ø­Ø§Ù„Ø© Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø¥Ø¹Ø¯Ø§Ø¯Ø§ØªØŒ Ø¹Ø±Ø¶ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
                            if (videoEl) {
                                videoEl.load(); // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ØµØ¯Ø± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„Ù€ HTML
                                videoEl.classList.remove('hidden');
                            }
                        }

                        // --- 2. ØªØ­Ø¯ÙŠØ« Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… ---
                        if (adminHeroTypeSelect) {
                            adminHeroTypeSelect.value = heroType;
                            // ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø­Ø¯Ø« ÙŠØ¯ÙˆÙŠØ§Ù‹ Ù„Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„ØµØ­ÙŠØ­Ø©
                            adminHeroTypeSelect.dispatchEvent(new Event('change'));
                        }
                        if (adminVideoUrlInput) {
                            adminVideoUrlInput.value = videoUrl || '';
                        }
                        if (adminImageUrlInput) {
                            adminImageUrlInput.value = imageUrl || '';
                        }
                        
                    } else {
                        // Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù„Ù Ø¥Ø¹Ø¯Ø§Ø¯Ø§ØªØŒ Ø§Ø¹Ø±Ø¶ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
                        console.log("No homepage config document found! Showing default video.");
                        if (videoEl) videoEl.classList.remove('hidden');
                    }
                }, (error) => {
                    console.error("Error fetching homepage config: ", error);
                    showToast("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ÙÙŠØ¯ÙŠÙˆ.");
                    // Ø¹Ø±Ø¶ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ø¹Ù†Ø¯ Ø­Ø¯ÙˆØ« Ø®Ø·Ø£
                    if (videoEl) videoEl.classList.remove('hidden');
                });
            }
      


            const closeMobileMenu = () => {
                const mobileMenu = document.getElementById('mobile-menu');
                const openIcon = document.getElementById('mobile-menu-open-icon');
                const closeIcon = document.getElementById('mobile-menu-close-icon');
                const mobileMenuButton = document.getElementById('mobile-menu-button');

                if (mobileMenu && openIcon && closeIcon && mobileMenuButton) {
                    mobileMenu.classList.add('hidden');
                    openIcon.classList.remove('hidden');
                    closeIcon.classList.add('hidden');
                    mobileMenuButton.setAttribute('aria-expanded', 'false');
                }
            };

            const showPage = (pageId, itemId = null) => {
                
                console.log('showPage called with pageId:', pageId, 'and itemId:', itemId); 
                
                
                const allPages = document.querySelectorAll('.page-section');
                allPages.forEach(page => {
                    page.classList.remove('active');
                });
                
                const targetPage = document.getElementById(`page-${pageId}`);
                if (targetPage) {
                    targetPage.classList.add('active');
                    if (pageId === 'cart') {
                        renderCartPage();
                    } else if (pageId === 'details' && itemId) {
                        renderProductDetails(itemId);
                        fetchAiSuggestions(itemId); 
                    } else if (pageId === 'blog-post' && itemId) {
                        renderArticleDetails(itemId);
                    } else if (pageId === 'offers') { // NEW: Handle offers page
                        renderOffersPage();
                    }
                } else {
                    const homePage = document.getElementById('page-home');
                    if (homePage) {
                        homePage.classList.add('active');
                    }
                }

                // NEW: Handle visibility of the top offers section based on page
                const topOffersSection = document.getElementById('current-offers-section');
                if (topOffersSection) {
                    if (pageId === 'home') {
                         // It will be shown by renderAllProductViews if there are offers
                         renderAllProductViews(); 
                    } else {
                        topOffersSection.classList.add('hidden');
                    }
                }
                
                const lightBanner = document.getElementById('special-offer-banner-light');
                const darkBanner = document.getElementById('special-offer-banner-dark');
                
                if (lightBanner && darkBanner) {
                 

                    if (pageId === 'home') {
                        
                        lightBanner.style.transform = 'translateY(0)';
                        darkBanner.style.transform = 'translateY(0)';
                    } else {
                        
                        lightBanner.style.transform = 'translateY(-100%)';
                        darkBanner.style.transform = 'translateY(-100%)';
                    }
                }
           

                window.scrollTo(0, 0);
                closeMobileMenu();
                
                lucide.createIcons();
            };

            try {
                const mobileMenuButton = document.getElementById('mobile-menu-button');
                const mobileMenu = document.getElementById('mobile-menu');
                const openIcon = document.getElementById('mobile-menu-open-icon');
                const closeIcon = document.getElementById('mobile-menu-close-icon');

                if (mobileMenuButton) {
                    mobileMenuButton.addEventListener('click', () => {
                        const isOpen = mobileMenu.classList.toggle('hidden');
                        openIcon.classList.toggle('hidden', !isOpen);
                        closeIcon.classList.toggle('hidden', isOpen);
                        mobileMenuButton.setAttribute('aria-expanded', !isOpen);
                    });
                }
               
                
                
                const allPages = document.querySelectorAll('.page-section');
                const allNavLinks = document.querySelectorAll('.nav-link, .logo-link');
                const allMobileNavLinks = document.querySelectorAll('.mobile-nav-link');

                allNavLinks.forEach(link => {
                    
                    if (link.dataset.navListenerAttached) return; 
                    link.dataset.navListenerAttached = 'true';

                   
                    const categoryFilter = link.dataset.categoryFilter;
                    // NEW: Support for filter-type in nav links
                    const filterType = link.dataset.filterType;

                    if (categoryFilter || filterType) {
                        link.addEventListener('click', (e) => {
                            e.preventDefault(); 
                            const pageId = e.currentTarget.dataset.page;
                            
                            if (categoryFilter) {
                                const categoryDropdown = document.getElementById('product-category-filter');
                                if (categoryDropdown) categoryDropdown.value = categoryFilter;
                                preFilterType = 'all';
                            }
                            
                            if (filterType) {
                                preFilterType = filterType;
                                const categoryDropdown = document.getElementById('product-category-filter');
                                if (categoryDropdown) categoryDropdown.value = 'all';
                            }

                            document.getElementById('product-search-input').value = '';
                            document.getElementById('product-sort-filter').value = 'default';
                            updateSearchPlaceholder(); 
                            renderAllProductViews(); 

                            window.location.hash = `#${pageId}`; 
                        });
                    }
                    
                });
                
                allMobileNavLinks.forEach(link => {
         
                    if (link.dataset.navListenerAttached) return;
                    link.dataset.navListenerAttached = 'true';

                  
                });

                const lightBanner = document.getElementById('special-offer-banner-light');
                const darkBanner = document.getElementById('special-offer-banner-dark');
                
                if (lightBanner && darkBanner) {
                  
                    let pageIsSettling = true; 
                    
                  
                    const checkBannerState = () => {
               
                
                        const isHomePage = document.getElementById('page-home').classList.contains('active');
                        if (!isHomePage) {
                       
                            return; 
                        }
                   

                        const currentScrollY = window.scrollY;

                        if (currentScrollY < 10) { 
                            
                            lightBanner.style.transform = 'translateY(0)';
                            darkBanner.style.transform = 'translateY(0)';
                        } else {
                            
                            if (!pageIsSettling) {
                                lightBanner.style.transform = 'translateY(-100%)';
                                darkBanner.style.transform = 'translateY(-100%)';
                            }
                        }
                    };
                    
                
                    window.addEventListener('scroll', checkBannerState, { passive: true });

              
                    lightBanner.style.transform = 'translateY(0)';
                    darkBanner.style.transform = 'translateY(0)';
                    
                  
                    setTimeout(() => {
                        pageIsSettling = false;
                      
                        checkBannerState();
                    }, 500); 
                }
             
                const adminForm = document.getElementById('admin-settings-form');
                if (adminForm) {
                    adminForm.addEventListener('submit', async (e) => {
                        e.preventDefault();
                        
                      
                        if (!currentIsAdmin) {
                            showToast("Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ©.");
                            return;
                        }

                        const saveBtn = document.getElementById('save-admin-settings-btn');
                        const originalBtnText = saveBtn.innerHTML;
                        saveBtn.disabled = true;
                        saveBtn.innerHTML = '...Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸';

                        try {
                          
                            const lightUrl = document.getElementById('admin-light-banner-url').value;
                            const darkUrl = document.getElementById('admin-dark-banner-url').value;
                            const bannerConfigRef = doc(db, "config", "main_banners");
                            await setDoc(bannerConfigRef, { lightUrl, darkUrl }, { merge: true });

                        
                            // --- ØªØ¹Ø¯ÙŠÙ„ Ù…Ù†Ø·Ù‚ Ø§Ù„Ø­ÙØ¸ ---
                            const heroType = document.getElementById('admin-hero-type').value;
                            const videoUrl = document.getElementById('admin-video-url').value;
                            const imageUrl = document.getElementById('admin-image-url').value;
                            
                            const homepageConfigRef = doc(db, "config", "homepage");
                            // Ø­ÙØ¸ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
                            await setDoc(homepageConfigRef, { heroType, videoUrl, imageUrl }, { merge: true });

                            showToast("ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!");
                        } catch (error) {
                            console.error("Error saving config: ", error);
                            showToast("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª.");
                        } finally {
                            saveBtn.disabled = false;
                            saveBtn.innerHTML = originalBtnText;
                        }
                    });
                }
               
                
                
                document.querySelectorAll('.see-all-link').forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        preFilterType = e.currentTarget.dataset.filterType;
                        
                        
                        document.getElementById('product-search-input').value = '';
                        document.getElementById('product-category-filter').value = 'all';
                        document.getElementById('product-sort-filter').value = 'default';
                        
                        renderAllProductViews(); // Trigger immediate re-render with new filter
                    
                        window.location.hash = '#products';
                    });
                });

                // --- Order Modal Logic ---
                const orderModal = document.getElementById('order-details-modal');
                const closeOrderModalBtn = document.getElementById('close-order-modal-btn');
                const cancelOrderBtn = document.getElementById('cancel-order-btn');
                const orderForm = document.getElementById('order-details-form');
                const checkoutBtn = document.getElementById('whatsapp-checkout-btn');

                if (checkoutBtn && orderModal) {
                    checkoutBtn.addEventListener('click', () => {
                        if (cart.length === 0) {
                            showToast("Ø³Ù„Ù‘ØªÙƒ ÙØ§Ø±ØºØ©.");
                            return;
                        }
                        // Try to pre-fill name if user is logged in
                        const currentUser = auth.currentUser;
                        if (currentUser && currentUser.displayName) {
                            const nameInput = document.getElementById('order-customer-name');
                            if (nameInput && !nameInput.value) {
                                nameInput.value = currentUser.displayName;
                            }
                        }
                        orderModal.classList.remove('hidden');
                    });
                }

                const closeOrderModal = () => {
                     if (orderModal) orderModal.classList.add('hidden');
                };

                if (closeOrderModalBtn) closeOrderModalBtn.addEventListener('click', closeOrderModal);
                if (cancelOrderBtn) cancelOrderBtn.addEventListener('click', closeOrderModal);
                if (orderModal) {
                    orderModal.addEventListener('click', (e) => {
                        if (e.target === orderModal) closeOrderModal();
                    });
                }

                if (orderForm) {
                    orderForm.addEventListener('submit', (e) => {
                        e.preventDefault();
                        const customerData = {
                            name: document.getElementById('order-customer-name').value.trim(),
                            phone: document.getElementById('order-customer-phone').value.trim(),
                            address: document.getElementById('order-customer-address').value.trim(),
                            notes: document.getElementById('order-notes').value.trim()
                        };
                        
                        closeOrderModal();
                        generateWhatsAppInvoice(customerData);
                    });
                }
                // -------------------------

                const contactForm = document.getElementById('contact-form');
                const successMessage = document.getElementById('form-success-message');
                if(contactForm) {
                    contactForm.addEventListener('submit', (e) => {
                        e.preventDefault();
                        if(successMessage) successMessage.classList.remove('hidden');
                        contactForm.reset();
                        setTimeout(() => {
                            if(successMessage) successMessage.classList.add('hidden');
                        }, 3000);
                    });
                }
                
                // Removed direct checkoutBtn listener here, moved to Order Modal Logic above
                
                // lucide.createIcons(); // <-- Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„Ø³Ø·Ø± Ø§Ù„Ø°ÙŠ ÙŠØ¬Ø¨ Ø­Ø°ÙÙ‡

                
                const tabButtons = document.querySelectorAll('.tab-btn');
                const tabContents = document.querySelectorAll('.tab-content');

                tabButtons.forEach(button => {
                    button.addEventListener('click', () => {
                        const tabId = button.dataset.tab;

                        
                        tabButtons.forEach(btn => {
                            btn.classList.remove('active-tab', 'text-[#ffcd00]', 'border-b-2', 'border-[#ffcd00]');
                            btn.classList.add('text-gray-500');
                        });
                        button.classList.add('active-tab', 'text-[#ffcd00]', 'border-b-2', 'border-[#ffcd00]');
                        button.classList.remove('text-gray-500');

                        
                        tabContents.forEach(content => {
                            if (content.id === `tab-content-${tabId}`) {
                                content.classList.remove('hidden');
                            } else {
                                content.classList.add('hidden');
                            }
                        });
                    });
                });

                
                // --- Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ø·Ù‚ Ù„Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ø­Ù‚ÙˆÙ„ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… ---
                const adminHeroTypeSelect = document.getElementById('admin-hero-type');
                const adminVideoContainer = document.getElementById('admin-video-url-container');
                const adminImageContainer = document.getElementById('admin-image-url-container');

                if (adminHeroTypeSelect && adminVideoContainer && adminImageContainer) {
                    adminHeroTypeSelect.addEventListener('change', () => {
                        if (adminHeroTypeSelect.value === 'video') {
                            adminVideoContainer.classList.remove('hidden');
                            adminImageContainer.classList.add('hidden');
                        } else {
                            adminVideoContainer.classList.add('hidden');
                            adminImageContainer.classList.remove('hidden');
                        }
                    });
                }
                // --- Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø¥Ø¶Ø§ÙØ© ---


                function handleRouting() {
                    const hash = window.location.hash || '#home';
                    console.log("Routing to:", hash);

                    const allNavLinks = document.querySelectorAll('.nav-link, .logo-link');
                    const allMobileNavLinks = document.querySelectorAll('.mobile-nav-link');

                    let targetPageId = 'home'; // default
                    let targetItemId = null;
                    // MODIFIED: Added 'offers' and 'terms' to simplePages
                    const simplePages = ['home', 'products', 'blog', 'contact', 'cart', 'admin', 'about', 'offers', 'terms'];

                    if (hash.startsWith('#product/')) {
                        targetPageId = 'details';
                        targetItemId = hash.substring('#product/'.length);
                    } else if (hash.startsWith('#blog/')) {
                        targetPageId = 'blog-post';
                        targetItemId = hash.substring('#blog/'.length);
                    } else {
                        const pageName = hash.substring(1);
                        if (simplePages.includes(pageName)) {
                            targetPageId = pageName;
                        } else {
                            targetPageId = 'home'; 
                        }
                    }
                    

                    showPage(targetPageId, targetItemId);

                    allNavLinks.forEach(link => {
                        link.classList.toggle('active', link.dataset.page === targetPageId);
                    });
                    
                    allMobileNavLinks.forEach(link => {
                        link.classList.toggle('active', link.dataset.page === targetPageId);
                    });
                }


                window.addEventListener('hashchange', handleRouting);


                handleRouting();

                // --- Scroll to Top Logic ---
                const scrollToTopBtn = document.getElementById('scroll-to-top-btn');
                if (scrollToTopBtn) {
                    window.addEventListener('scroll', () => {
                        // Show button after scrolling down 300px
                        if (window.scrollY > 300) {
                            scrollToTopBtn.classList.remove('opacity-0', 'translate-y-10', 'pointer-events-none');
                            scrollToTopBtn.classList.add('opacity-100', 'translate-y-0', 'pointer-events-auto');
                        } else {
                            scrollToTopBtn.classList.add('opacity-0', 'translate-y-10', 'pointer-events-none');
                            scrollToTopBtn.classList.remove('opacity-100', 'translate-y-0', 'pointer-events-auto');
                        }
                    }, { passive: true });

                    scrollToTopBtn.addEventListener('click', () => {
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                    });
                }
                // ---------------------------

                // --- Visitor Counter Logic ---
                const initVisitorCounter = async () => {
                    const visitorRef = doc(db, "site_stats", "visitor_counter");
                    const countEl = document.getElementById('visitor-count-number');

                    // 1. Listen for real-time updates
                    onSnapshot(visitorRef, (docSnap) => {
                        if (docSnap.exists()) {
                            const count = docSnap.data().count || 0;
                            if (countEl) countEl.textContent = count.toLocaleString('en-US');
                        }
                    });

                    // 2. Increment count only if it's a new unique visitor
                    try {
                        // Check if the user has been flagged as visited in localStorage
                        if (!localStorage.getItem('maccaStoreVisited_v1')) {
                            // New visitor: Increment count in Firestore
                            await setDoc(visitorRef, { count: increment(1) }, { merge: true });
                            
                            // Set a flag in localStorage to mark this device as visited
                            // Using '_v1' allows us to reset this later if needed by changing the key
                            localStorage.setItem('maccaStoreVisited_v1', 'true');
                            console.log("New visitor counted and flagged.");
                        } else {
                            // Returning visitor (flag exists)
                            console.log("Returning visitor. Count not incremented.");
                        }
                    } catch (error) {
                        console.error("Error incrementing visitor count:", error);
                    }
                };
                initVisitorCounter();
                // -----------------------------


            } catch (error) {
                console.error('Error initializing app:', error);
                document.querySelector('main').innerHTML = '<p class="text-center text-red-500">Error loading website content.</p>';
            }
        

    </script>

</body>
</html>